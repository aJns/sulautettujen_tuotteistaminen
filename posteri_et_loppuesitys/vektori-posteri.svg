<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.2" viewBox="0 0 84110 118910" preserveAspectRatio="xMidYMid" fill-rule="evenodd" stroke-width="28.222" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg" xmlns:ooo="http://xml.openoffice.org/svg/export" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:presentation="http://sun.com/xmlns/staroffice/presentation" xmlns:smil="http://www.w3.org/2001/SMIL20/" xmlns:anim="urn:oasis:names:tc:opendocument:xmlns:animation:1.0" xml:space="preserve">
 <defs class="ClipPathGroup">
  <clipPath id="presentation_clip_path" clipPathUnits="userSpaceOnUse">
   <rect x="0" y="0" width="84110" height="118910"/>
  </clipPath>
  <clipPath id="presentation_clip_path_shrink" clipPathUnits="userSpaceOnUse">
   <rect x="84" y="118" width="83942" height="118673"/>
  </clipPath>
 </defs>
 <defs>
  <g id="ooo:meta_slides" ooo:number-of-slides="1" ooo:start-slide-number="0">
   <g id="ooo:meta_dummy_slide" ooo:slide="dummy-slide" ooo:master="dummy-master-page" ooo:background-visibility="hidden" ooo:master-objects-visibility="hidden" ooo:has-transition="false"/>
   <g id="ooo:meta_slide_0" ooo:slide="id1" ooo:master="id2" ooo:date-time-visibility="hidden" ooo:footer-visibility="hidden" ooo:has-transition="true"/>
  </g>
 </defs>
 <defs id="presentation-animations"/>
 <defs>
  <font id="EmbeddedFont_1" horiz-adv-x="2048">
   <font-face font-family="Arial embedded" units-per-em="2048" font-weight="normal" font-style="normal" ascent="1852" descent="423"/>
   <missing-glyph horiz-adv-x="2048" d="M 0,0 L 2047,0 2047,2047 0,2047 0,0 Z"/>
   <glyph unicode="Ã¤" horiz-adv-x="1060" d="M 414,-20 C 305,-20 224,9 169,66 114,123 87,202 87,302 87,414 124,500 198,560 271,620 390,652 554,656 L 797,660 797,719 C 797,807 778,870 741,908 704,946 645,965 565,965 484,965 426,951 389,924 352,897 330,853 323,793 L 135,810 C 166,1005 310,1102 569,1102 705,1102 807,1071 876,1009 945,946 979,856 979,738 L 979,272 C 979,219 986,179 1000,152 1014,125 1041,111 1080,111 1097,111 1117,113 1139,118 L 1139,6 C 1094,-5 1047,-10 1000,-10 933,-10 885,8 855,43 824,78 807,132 803,207 L 797,207 C 751,124 698,66 637,32 576,-3 501,-20 414,-20 Z M 455,115 C 521,115 580,130 631,160 682,190 723,231 753,284 782,336 797,390 797,445 L 797,534 600,530 C 515,529 451,520 408,504 364,488 330,463 307,430 284,397 272,353 272,299 272,240 288,195 320,163 351,131 396,115 455,115 Z M 674,1219 L 674,1403 837,1403 837,1219 674,1219 Z M 280,1219 L 280,1403 445,1403 445,1219 280,1219 Z"/>
   <glyph unicode="y" horiz-adv-x="1033" d="M 191,-425 C 142,-425 100,-421 67,-414 L 67,-279 C 92,-283 120,-285 151,-285 263,-285 352,-203 417,-38 L 434,5 5,1082 197,1082 425,484 C 428,475 432,464 437,451 442,438 457,394 482,320 507,246 521,205 523,196 L 593,393 830,1082 1020,1082 604,0 C 559,-115 518,-201 479,-258 440,-314 398,-356 351,-384 304,-411 250,-425 191,-425 Z"/>
   <glyph unicode="t" horiz-adv-x="531" d="M 554,8 C 495,-8 434,-16 372,-16 228,-16 156,66 156,229 L 156,951 31,951 31,1082 163,1082 216,1324 336,1324 336,1082 536,1082 536,951 336,951 336,268 C 336,216 345,180 362,159 379,138 408,127 450,127 474,127 509,132 554,141 L 554,8 Z"/>
   <glyph unicode="s" horiz-adv-x="901" d="M 950,299 C 950,197 912,118 835,63 758,8 650,-20 511,-20 376,-20 273,2 200,47 127,91 79,160 57,254 L 216,285 C 231,227 263,185 311,158 359,131 426,117 511,117 602,117 669,131 712,159 754,187 775,229 775,285 775,328 760,362 731,389 702,416 654,438 589,455 L 460,489 C 357,516 283,542 240,568 196,593 162,624 137,661 112,698 100,743 100,796 100,895 135,970 206,1022 276,1073 378,1099 513,1099 632,1099 727,1078 798,1036 868,994 912,927 931,834 L 769,814 C 759,862 732,899 689,925 645,950 586,963 513,963 432,963 372,951 333,926 294,901 275,864 275,814 275,783 283,758 299,738 315,718 339,701 370,687 401,673 467,654 568,629 663,605 732,583 774,563 816,542 849,520 874,495 898,470 917,442 930,410 943,377 950,340 950,299 Z"/>
   <glyph unicode="r" horiz-adv-x="530" d="M 142,0 L 142,830 C 142,906 140,990 136,1082 L 306,1082 C 311,959 314,886 314,861 L 318,861 C 347,954 380,1017 417,1051 454,1085 507,1102 575,1102 599,1102 623,1099 648,1092 L 648,927 C 624,934 592,937 552,937 477,937 420,905 381,841 342,776 322,684 322,564 L 322,0 142,0 Z"/>
   <glyph unicode="p" horiz-adv-x="953" d="M 1053,546 C 1053,169 920,-20 655,-20 488,-20 376,43 319,168 L 314,168 C 317,163 318,106 318,-2 L 318,-425 138,-425 138,861 C 138,972 136,1046 132,1082 L 306,1082 C 307,1079 308,1070 309,1054 310,1037 312,1012 314,978 315,944 316,921 316,908 L 320,908 C 352,975 394,1024 447,1055 500,1086 569,1101 655,1101 788,1101 888,1056 954,967 1020,878 1053,737 1053,546 Z M 864,542 C 864,693 844,800 803,865 762,930 698,962 609,962 538,962 482,947 442,917 401,887 371,840 350,777 329,713 318,630 318,528 318,386 341,281 386,214 431,147 505,113 607,113 696,113 762,146 803,212 844,277 864,387 864,542 Z"/>
   <glyph unicode="l" horiz-adv-x="187" d="M 138,0 L 138,1484 318,1484 318,0 138,0 Z"/>
   <glyph unicode="k" horiz-adv-x="901" d="M 816,0 L 450,494 318,385 318,0 138,0 138,1484 318,1484 318,557 793,1082 1004,1082 565,617 1027,0 816,0 Z"/>
   <glyph unicode="i" horiz-adv-x="187" d="M 137,1312 L 137,1484 317,1484 317,1312 137,1312 Z M 137,0 L 137,1082 317,1082 317,0 137,0 Z"/>
   <glyph unicode="e" horiz-adv-x="980" d="M 276,503 C 276,379 302,283 353,216 404,149 479,115 578,115 656,115 719,131 766,162 813,193 844,233 861,281 L 1019,236 C 954,65 807,-20 578,-20 418,-20 296,28 213,123 129,218 87,360 87,548 87,727 129,864 213,959 296,1054 416,1102 571,1102 889,1102 1048,910 1048,527 L 1048,503 276,503 Z M 862,641 C 852,755 823,838 775,891 727,943 658,969 568,969 481,969 412,940 361,882 310,823 282,743 278,641 L 862,641 Z"/>
   <glyph unicode="d" horiz-adv-x="927" d="M 821,174 C 788,105 744,55 689,25 634,-5 565,-20 484,-20 347,-20 247,26 183,118 118,210 86,349 86,536 86,913 219,1102 484,1102 566,1102 634,1087 689,1057 744,1027 788,979 821,914 L 823,914 821,1035 821,1484 1001,1484 1001,223 C 1001,110 1003,36 1007,0 L 835,0 C 833,11 831,35 829,74 826,113 825,146 825,174 L 821,174 Z M 275,542 C 275,391 295,282 335,217 375,152 440,119 530,119 632,119 706,154 752,225 798,296 821,405 821,554 821,697 798,802 752,869 706,936 633,969 532,969 441,969 376,936 336,869 295,802 275,693 275,542 Z"/>
   <glyph unicode="a" horiz-adv-x="1060" d="M 414,-20 C 305,-20 224,9 169,66 114,123 87,202 87,302 87,414 124,500 198,560 271,620 390,652 554,656 L 797,660 797,719 C 797,807 778,870 741,908 704,946 645,965 565,965 484,965 426,951 389,924 352,897 330,853 323,793 L 135,810 C 166,1005 310,1102 569,1102 705,1102 807,1071 876,1009 945,946 979,856 979,738 L 979,272 C 979,219 986,179 1000,152 1014,125 1041,111 1080,111 1097,111 1117,113 1139,118 L 1139,6 C 1094,-5 1047,-10 1000,-10 933,-10 885,8 855,43 824,78 807,132 803,207 L 797,207 C 751,124 698,66 637,32 576,-3 501,-20 414,-20 Z M 455,115 C 521,115 580,130 631,160 682,190 723,231 753,284 782,336 797,390 797,445 L 797,534 600,530 C 515,529 451,520 408,504 364,488 330,463 307,430 284,397 272,353 272,299 272,240 288,195 320,163 351,131 396,115 455,115 Z"/>
   <glyph unicode="M" horiz-adv-x="1377" d="M 1366,0 L 1366,940 C 1366,1044 1369,1144 1375,1240 1342,1121 1313,1027 1287,960 L 923,0 789,0 420,960 364,1130 331,1240 334,1129 338,940 338,0 168,0 168,1409 419,1409 794,432 C 807,393 820,351 833,306 845,261 853,228 857,208 862,235 874,275 891,330 908,384 919,418 925,432 L 1293,1409 1538,1409 1538,0 1366,0 Z"/>
   <glyph unicode="L" horiz-adv-x="927" d="M 168,0 L 168,1409 359,1409 359,156 1071,156 1071,0 168,0 Z"/>
   <glyph unicode="A" horiz-adv-x="1377" d="M 1167,0 L 1006,412 364,412 202,0 4,0 579,1409 796,1409 1362,0 1167,0 Z M 685,1265 L 676,1237 C 659,1182 635,1111 602,1024 L 422,561 949,561 768,1026 C 749,1072 731,1124 712,1182 L 685,1265 Z"/>
   <glyph unicode="6" horiz-adv-x="980" d="M 1049,461 C 1049,312 1009,195 928,109 847,23 736,-20 594,-20 435,-20 314,39 230,157 146,275 104,447 104,672 104,916 148,1103 235,1234 322,1365 447,1430 608,1430 821,1430 955,1334 1010,1143 L 838,1112 C 803,1227 725,1284 606,1284 503,1284 424,1236 368,1141 311,1045 283,906 283,725 316,786 362,832 421,864 480,895 548,911 625,911 755,911 858,870 935,789 1011,708 1049,598 1049,461 Z M 866,453 C 866,555 841,634 791,689 741,744 671,772 582,772 498,772 430,748 379,699 327,650 301,582 301,496 301,387 328,298 382,229 435,160 504,125 588,125 675,125 743,154 792,213 841,271 866,351 866,453 Z"/>
   <glyph unicode="3" horiz-adv-x="1006" d="M 1049,389 C 1049,259 1008,158 925,87 842,16 724,-20 571,-20 428,-20 315,12 230,77 145,141 94,236 78,362 L 264,379 C 288,212 390,129 571,129 662,129 733,151 785,196 836,241 862,307 862,395 862,472 833,532 774,575 715,618 629,639 518,639 L 416,639 416,795 514,795 C 613,795 689,817 744,860 798,903 825,962 825,1038 825,1113 803,1173 759,1217 714,1260 648,1282 561,1282 482,1282 418,1262 369,1221 320,1180 291,1123 283,1049 L 102,1063 C 115,1178 163,1268 246,1333 328,1398 434,1430 563,1430 704,1430 814,1397 893,1332 971,1266 1010,1174 1010,1057 1010,967 985,894 935,838 884,781 811,743 715,723 L 715,719 C 820,708 902,672 961,613 1020,554 1049,479 1049,389 Z"/>
   <glyph unicode="/" horiz-adv-x="583" d="M 0,-20 L 411,1484 569,1484 162,-20 0,-20 Z"/>
   <glyph unicode=" " horiz-adv-x="556"/>
  </font>
 </defs>
 <defs>
  <font id="EmbeddedFont_2" horiz-adv-x="2048">
   <font-face font-family="Arial embedded" units-per-em="2048" font-weight="bold" font-style="normal" ascent="1852" descent="423"/>
   <missing-glyph horiz-adv-x="2048" d="M 0,0 L 2047,0 2047,2047 0,2047 0,0 Z"/>
   <glyph unicode="y" horiz-adv-x="1139" d="M 283,-425 C 216,-425 157,-421 106,-412 L 106,-212 C 141,-217 174,-220 203,-220 243,-220 276,-214 303,-201 329,-188 353,-167 374,-138 395,-109 418,-59 444,11 L 16,1082 313,1082 483,575 C 510,502 543,391 584,241 L 609,336 674,571 834,1082 1128,1082 700,-57 C 643,-196 583,-292 522,-345 460,-398 380,-425 283,-425 Z"/>
   <glyph unicode="t" horiz-adv-x="662" d="M 420,-18 C 337,-18 274,5 229,50 184,95 162,163 162,254 L 162,892 25,892 25,1082 176,1082 264,1336 440,1336 440,1082 645,1082 645,892 440,892 440,330 C 440,277 450,239 470,214 490,189 521,176 563,176 585,176 616,181 657,190 L 657,16 C 588,-7 509,-18 420,-18 Z"/>
   <glyph unicode="s" horiz-adv-x="1006" d="M 1055,316 C 1055,211 1012,129 927,70 841,10 722,-20 571,-20 422,-20 309,4 230,51 151,98 98,171 72,270 L 319,307 C 333,256 357,219 392,198 426,177 486,166 571,166 650,166 707,176 743,196 779,216 797,247 797,290 797,325 783,352 754,373 725,393 675,410 606,424 447,455 340,485 285,512 230,539 188,574 159,617 130,660 115,712 115,775 115,878 155,959 235,1017 314,1074 427,1103 573,1103 702,1103 805,1078 884,1028 962,978 1011,906 1030,811 L 781,785 C 773,829 753,862 722,884 691,905 641,916 573,916 506,916 456,908 423,891 390,874 373,845 373,805 373,774 386,749 412,731 437,712 480,697 541,685 626,668 701,650 767,632 832,613 885,591 925,566 964,541 996,508 1020,469 1043,429 1055,378 1055,316 Z"/>
   <glyph unicode="r" horiz-adv-x="636" d="M 143,0 L 143,828 C 143,887 142,937 141,977 139,1016 137,1051 135,1082 L 403,1082 C 405,1070 408,1034 411,973 414,912 416,871 416,851 L 420,851 C 447,927 472,981 493,1012 514,1043 540,1066 569,1081 598,1096 635,1103 679,1103 715,1103 744,1098 766,1088 L 766,853 C 721,863 681,868 646,868 576,868 522,840 483,783 444,726 424,642 424,531 L 424,0 143,0 Z"/>
   <glyph unicode="p" horiz-adv-x="1033" d="M 1167,546 C 1167,365 1131,226 1059,128 986,29 884,-20 752,-20 676,-20 610,-3 554,30 497,63 454,110 424,172 L 418,172 C 422,152 424,91 424,-10 L 424,-425 143,-425 143,833 C 143,935 140,1018 135,1082 L 408,1082 C 411,1070 414,1046 417,1011 419,976 420,941 420,906 L 424,906 C 487,1039 603,1105 770,1105 896,1105 994,1057 1063,960 1132,863 1167,725 1167,546 Z M 874,546 C 874,789 800,910 651,910 576,910 519,877 480,812 440,747 420,655 420,538 420,421 440,331 480,268 519,204 576,172 649,172 799,172 874,297 874,546 Z"/>
   <glyph unicode="o" horiz-adv-x="1113" d="M 1171,542 C 1171,367 1122,229 1025,130 928,30 793,-20 621,-20 452,-20 320,30 224,130 128,230 80,367 80,542 80,716 128,853 224,953 320,1052 454,1102 627,1102 804,1102 939,1054 1032,958 1125,861 1171,723 1171,542 Z M 877,542 C 877,671 856,764 814,822 772,880 711,909 631,909 460,909 375,787 375,542 375,421 396,330 438,267 479,204 539,172 618,172 791,172 877,295 877,542 Z"/>
   <glyph unicode="l" horiz-adv-x="292" d="M 143,0 L 143,1484 424,1484 424,0 143,0 Z"/>
   <glyph unicode="k" horiz-adv-x="1007" d="M 834,0 L 545,490 424,406 424,0 143,0 143,1484 424,1484 424,634 810,1082 1112,1082 732,660 1141,0 834,0 Z"/>
   <glyph unicode="i" horiz-adv-x="292" d="M 143,1277 L 143,1484 424,1484 424,1277 143,1277 Z M 143,0 L 143,1082 424,1082 424,0 143,0 Z"/>
   <glyph unicode="d" horiz-adv-x="1033" d="M 844,0 C 841,10 838,35 835,76 831,116 829,149 829,176 L 825,176 C 764,45 649,-20 479,-20 353,-20 256,29 187,128 118,226 84,363 84,540 84,719 120,858 193,956 265,1053 367,1102 500,1102 577,1102 643,1086 699,1054 754,1022 797,974 827,911 L 829,911 827,1089 827,1484 1108,1484 1108,236 C 1108,169 1111,91 1116,0 L 844,0 Z M 831,547 C 831,664 812,754 773,817 734,880 676,911 600,911 525,911 469,881 432,820 395,759 377,665 377,540 377,295 451,172 598,172 672,172 729,205 770,270 811,335 831,427 831,547 Z"/>
   <glyph unicode="a" horiz-adv-x="1112" d="M 393,-20 C 288,-20 207,9 148,66 89,123 60,203 60,306 60,418 97,503 170,562 243,621 348,651 487,652 L 720,656 720,711 C 720,782 708,834 683,869 658,903 618,920 562,920 510,920 472,908 448,885 423,861 408,822 402,767 L 109,781 C 127,886 175,966 254,1021 332,1075 439,1102 574,1102 711,1102 816,1068 890,1001 964,934 1001,838 1001,714 L 1001,320 C 1001,259 1008,218 1022,195 1035,172 1058,160 1090,160 1111,160 1132,162 1152,166 L 1152,14 C 1135,10 1120,6 1107,3 1094,0 1080,-3 1067,-5 1054,-7 1040,-9 1025,-10 1010,-11 992,-12 972,-12 901,-12 849,5 816,40 782,75 762,126 755,193 L 749,193 C 670,51 552,-20 393,-20 Z M 720,501 L 576,499 C 511,496 464,489 437,478 410,466 389,448 375,424 360,400 353,368 353,328 353,277 365,239 389,214 412,189 444,176 483,176 527,176 567,188 604,212 640,236 668,269 689,312 710,354 720,399 720,446 L 720,501 Z"/>
   <glyph unicode="O" horiz-adv-x="1430" d="M 1507,711 C 1507,564 1478,435 1420,324 1362,213 1279,128 1171,69 1063,10 937,-20 793,-20 572,-20 398,45 273,176 147,306 84,484 84,711 84,937 147,1113 272,1240 397,1367 572,1430 795,1430 1018,1430 1193,1366 1319,1238 1444,1110 1507,934 1507,711 Z M 1206,711 C 1206,863 1170,982 1098,1069 1026,1155 925,1198 795,1198 663,1198 561,1155 489,1070 417,984 381,864 381,711 381,556 418,435 492,346 565,257 666,212 793,212 925,212 1027,255 1099,342 1170,429 1206,552 1206,711 Z"/>
   <glyph unicode="M" horiz-adv-x="1430" d="M 1307,0 L 1307,854 C 1307,873 1307,893 1308,912 1308,931 1311,1014 1317,1161 1270,982 1235,857 1212,786 L 958,0 748,0 494,786 387,1161 C 395,1006 399,904 399,854 L 399,0 137,0 137,1409 532,1409 784,621 806,545 854,356 917,582 1176,1409 1569,1409 1569,0 1307,0 Z"/>
   <glyph unicode="A" horiz-adv-x="1404" d="M 1133,0 L 1008,360 471,360 346,0 51,0 565,1409 913,1409 1425,0 1133,0 Z M 739,1192 L 733,1170 C 726,1146 718,1119 709,1088 700,1057 642,889 537,582 L 942,582 803,987 760,1123 739,1192 Z"/>
   <glyph unicode="6" horiz-adv-x="1033" d="M 1065,461 C 1065,311 1023,193 939,108 855,23 739,-20 591,-20 425,-20 298,38 209,155 120,271 75,443 75,672 75,923 120,1113 211,1240 301,1367 430,1430 598,1430 717,1430 812,1404 881,1351 950,1298 998,1217 1027,1106 L 762,1069 C 737,1162 680,1208 592,1208 517,1208 458,1170 415,1095 372,1020 350,905 350,752 380,802 422,840 475,867 528,894 589,907 656,907 782,907 882,867 955,787 1028,707 1065,598 1065,461 Z M 783,453 C 783,533 765,594 728,637 691,679 640,700 575,700 513,700 463,680 426,641 389,601 370,548 370,483 370,401 390,333 429,280 468,226 519,199 582,199 645,199 695,222 730,267 765,312 783,374 783,453 Z"/>
   <glyph unicode="3" horiz-adv-x="1060" d="M 1065,391 C 1065,259 1022,157 935,85 848,13 725,-23 565,-23 414,-23 293,12 204,82 115,151 62,252 47,383 L 333,408 C 351,273 428,205 564,205 631,205 684,222 721,255 758,288 777,339 777,408 777,471 754,519 709,552 664,585 596,602 507,602 L 409,602 409,829 501,829 C 582,829 642,846 683,879 724,912 744,959 744,1020 744,1078 728,1124 696,1157 663,1190 616,1206 554,1206 496,1206 449,1190 414,1158 378,1126 357,1081 352,1022 L 71,1042 C 86,1163 136,1258 222,1327 308,1396 420,1430 559,1430 706,1430 822,1397 905,1331 988,1264 1029,1172 1029,1055 1029,967 1003,895 952,838 900,781 825,744 728,725 L 728,721 C 836,708 919,673 978,615 1036,556 1065,482 1065,391 Z"/>
   <glyph unicode="/" horiz-adv-x="557" d="M 20,-41 L 311,1484 549,1484 263,-41 20,-41 Z"/>
   <glyph unicode=" " horiz-adv-x="556"/>
  </font>
 </defs>
 <defs class="TextShapeIndex">
  <g ooo:slide="id1" ooo:id-list="id3 id4"/>
 </defs>
 <defs class="EmbeddedBulletChars">
  <g id="bullet-char-template(57356)" transform="scale(0.00048828125,-0.00048828125)">
   <path d="M 580,1141 L 1163,571 580,0 -4,571 580,1141 Z"/>
  </g>
  <g id="bullet-char-template(57354)" transform="scale(0.00048828125,-0.00048828125)">
   <path d="M 8,1128 L 1137,1128 1137,0 8,0 8,1128 Z"/>
  </g>
  <g id="bullet-char-template(10146)" transform="scale(0.00048828125,-0.00048828125)">
   <path d="M 174,0 L 602,739 174,1481 1456,739 174,0 Z M 1358,739 L 309,1346 659,739 1358,739 Z"/>
  </g>
  <g id="bullet-char-template(10132)" transform="scale(0.00048828125,-0.00048828125)">
   <path d="M 2015,739 L 1276,0 717,0 1260,543 174,543 174,936 1260,936 717,1481 1274,1481 2015,739 Z"/>
  </g>
  <g id="bullet-char-template(10007)" transform="scale(0.00048828125,-0.00048828125)">
   <path d="M 0,-2 C -7,14 -16,27 -25,37 L 356,567 C 262,823 215,952 215,954 215,979 228,992 255,992 264,992 276,990 289,987 310,991 331,999 354,1012 L 381,999 492,748 772,1049 836,1024 860,1049 C 881,1039 901,1025 922,1006 886,937 835,863 770,784 769,783 710,716 594,584 L 774,223 C 774,196 753,168 711,139 L 727,119 C 717,90 699,76 672,76 641,76 570,178 457,381 L 164,-76 C 142,-110 111,-127 72,-127 30,-127 9,-110 8,-76 1,-67 -2,-52 -2,-32 -2,-23 -1,-13 0,-2 Z"/>
  </g>
  <g id="bullet-char-template(10004)" transform="scale(0.00048828125,-0.00048828125)">
   <path d="M 285,-33 C 182,-33 111,30 74,156 52,228 41,333 41,471 41,549 55,616 82,672 116,743 169,778 240,778 293,778 328,747 346,684 L 369,508 C 377,444 397,411 428,410 L 1163,1116 C 1174,1127 1196,1133 1229,1133 1271,1133 1292,1118 1292,1087 L 1292,965 C 1292,929 1282,901 1262,881 L 442,47 C 390,-6 338,-33 285,-33 Z"/>
  </g>
  <g id="bullet-char-template(9679)" transform="scale(0.00048828125,-0.00048828125)">
   <path d="M 813,0 C 632,0 489,54 383,161 276,268 223,411 223,592 223,773 276,916 383,1023 489,1130 632,1184 813,1184 992,1184 1136,1130 1245,1023 1353,916 1407,772 1407,592 1407,412 1353,268 1245,161 1136,54 992,0 813,0 Z"/>
  </g>
  <g id="bullet-char-template(8226)" transform="scale(0.00048828125,-0.00048828125)">
   <path d="M 346,457 C 273,457 209,483 155,535 101,586 74,649 74,723 74,796 101,859 155,911 209,963 273,989 346,989 419,989 480,963 531,910 582,859 608,796 608,723 608,648 583,586 532,535 482,483 420,457 346,457 Z"/>
  </g>
  <g id="bullet-char-template(8211)" transform="scale(0.00048828125,-0.00048828125)">
   <path d="M -4,459 L 1135,459 1135,606 -4,606 -4,459 Z"/>
  </g>
  <g id="bullet-char-template(61548)" transform="scale(0.00048828125,-0.00048828125)">
   <path d="M 173,740 C 173,903 231,1043 346,1159 462,1274 601,1332 765,1332 928,1332 1067,1274 1183,1159 1299,1043 1357,903 1357,740 1357,577 1299,437 1183,322 1067,206 928,148 765,148 601,148 462,206 346,322 231,437 173,577 173,740 Z"/>
  </g>
 </defs>
 <defs class="TextEmbeddedBitmaps"/>
 <defs>
  <g id="dummy-master-page" ooo:name="dummy-master-page" class="Master_Slide">
   <g id="bg-dummy-master-page" class="Background" visibility="hidden"/>
   <g id="bo-dummy-master-page" class="BackgroundObjects" visibility="hidden"/>
  </g>
  <g id="id2" ooo:name="Title2" class="Master_Slide">
   <g id="bg-id2" class="Background">
    <path fill="rgb(255,255,255)" stroke="none" d="M 42055,118909 L 0,118909 0,0 84109,0 84109,118909 42055,118909 Z"/>
   </g>
   <g id="bo-id2" class="BackgroundObjects">
    <g class="Graphic">
     <g>
      <rect class="BoundingBox" stroke="none" fill="none" x="0" y="0" width="84721" height="119513"/>
      <image x="0" y="0" width="84721" height="119513" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAADIIAABGlCAIAAADUe7eZAAAACXBIWXMAAA7DAAAOxAGILj6jAAFItUlEQVR4nOzdv28jW343aAFzMZjxe8WeCS7wAqLW3g3JwM5MdjKOxJ7E14GoGy62xf4DROUryrkoYNJL9WKdDanIUbMzJ5dy6IBawIlhi4INDGCjqXlfG8YM3j0tejS8VSWKYhV/6nnAEXTZZNWpqlOnqqc+/T1f/K//9b+2AAAAAAAAAAAAmNUXy24AAAAAAAAAAADAehPDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAg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AAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAAAAgFTEsAAAAAAAAAAAAFIRwwIAAAAAAAAAAEhFDAsAAAAAAAAAACAVMSwAAAAAAAAAAIBUxLAAAAAAAAAAAABSEcMCAAAAAAAAAABIRQwLAAAAAAAAAAAgFTEsAAAAAAAAAACAVMSwAAAAAAAAAAAAUhHDAgAAAAAAAAAASEUMCwAAAAAAAAAAIBUxLAAAAAAAAACA/59dOxYAAAAAGORvPYi9xRHAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhAQAAAAAAAAAALBoWAAAAAAAAAADAomEBAAAAAAAAAAAsGhYAAAAAAAAAAMCiYQEAAAAAAAAAACwaFgAAAAAAAAAAwKJhARC7diwAAAAAMMjfehB7iyMAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAAAAAAAGDRsAAAAAAAAAAAABYNCwAAAAAAAAAAYNGwAAAAAAAAAAAAFg0LAAAAAAAAAABg0bAAAAAAAAAAAAAWDQsAAAAgdu1YAAAAAGCQv/Ug9hZHAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAAAAAi4YFAAAAAAAAAACwaFgAAAAAAAAAAACLhgUAAAAAAAAAALBoWAAAAAAAAAAAAIuGBQAAAAAAAAAAsGhYAAAAAAAAQOzdXXIb55mGYX9Ag0AoEhRU9oFqKlU6muPsIEvIErKDyVJmS9YOrB04Gwhl8QdAGzAGAhJG0dCipIfi1w1cV6FcTceOHpuUj+56GwCAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAiwwIAAAAAAAAAAIjIsAAAAAAAAAAAACIyLAAAAAAAAAAAgIgMCwAAAAAAAAAAICLDAgAAAAAAAAAAiMiwAAAAAAAAAAAAIjIsAAAAAAAAAACAiAwLAAAAAAAAAAAgIsMCAAAAAAAAAACIyLAAAAAAAAAAAAAiMiwAAAAAAAAAAICIDAsAAAAAAAAAACAi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"/>
     </g>
    </g>
   </g>
  </g>
 </defs>
 <g class="DummySlide">
  <g>
   <g id="dummy-slide" class="Slide" clip-path="url(#presentation_clip_path)">
    <g ooo:name="dummy-page" class="Page"/>
   </g>
  </g>
 </g>
 <g class="SlideGroup">
  <g visibility="hidden">
   <g id="container-id1">
    <g id="id1" class="Slide" clip-path="url(#presentation_clip_path)">
     <g ooo:name="page1" class="Page">
      <g class="com.sun.star.drawing.CustomShape">
       <g id="id3">
        <rect class="BoundingBox" stroke="none" fill="none" x="8471" y="23977" width="9870" height="2709"/>
        <text class="TextShape"><tspan class="TextParagraph" font-family="Arial, sans-serif" font-size="1270px" font-weight="400"><tspan class="TextPosition" x="8469" y="24898"><tspan fill="rgb(0,0,0)" stroke="none">LeipÃ¤teksti</tspan></tspan></tspan><tspan class="TextParagraph" font-family="Arial, sans-serif" font-size="1270px" font-weight="400"><tspan class="TextPosition" x="8469" y="26422"><tspan fill="rgb(0,0,0)" stroke="none">Arial/Myriad 36 pt</tspan></tspan></tspan></text>
       </g>
      </g>
      <g class="com.sun.star.drawing.CustomShape">
       <g id="id4">
        <rect class="BoundingBox" stroke="none" fill="none" x="8530" y="16044" width="30460" height="5265"/>
        <text class="TextShape"><tspan class="TextParagraph" font-family="Arial, sans-serif" font-size="2469px" font-weight="700"><tspan class="TextPosition" x="8469" y="17834"><tspan fill="rgb(0,0,0)" stroke="none">Otsikko</tspan></tspan></tspan><tspan class="TextParagraph" font-family="Arial, sans-serif" font-size="2469px" font-weight="700"><tspan class="TextPosition" x="8469" y="20796"><tspan fill="rgb(0,0,0)" stroke="none">Arial/Myriad 36 pt   </tspan><tspan font-size="1270px" fill="rgb(0,0,0)" stroke="none">aasdasdassd</tspan><tspan fill="rgb(0,0,0)" stroke="none">  </tspan></tspan></tspan></text>
       </g>
      </g>
     </g>
    </g>
   </g>
  </g>
 </g>
 <script type="text/ecmascript"><![CDATA[


/*****
* @licstart
*
* The following is the license notice for the part of JavaScript code of this
* page included between the '@jessyinkstart' and the '@jessyinkend' notes.
*/

/*****  ******************************************************************
*
* Copyright 2008-2013 Hannes Hochreiner
*
* The JavaScript code included between the start note '@jessyinkstart'
* and the end note '@jessyinkend' is subject to the terms of the Mozilla
* Public License, v. 2.0. If a copy of the MPL was not distributed with
* this file, You can obtain one at http://mozilla.org/MPL/2.0/.
*
* Alternatively, you can redistribute and/or that part of this file
* under the terms of the GNU General Public License as published by
* the Free Software Foundation, either version 3 of the License, or
* (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
*
* You should have received a copy of the GNU General Public License
* along with this program.  If not, see http://www.gnu.org/licenses/.
*/

/*****
*  You can find the complete source code of the JessyInk project at:
*  @source http://code.google.com/p/jessyink/
*/

/*****
* @licend
*
* The above is the license notice for the part of JavaScript code of this
* page included between the '@jessyinkstart' and the '@jessyinkend' notes.
*/


/*****
* @jessyinkstart
*
*  The following code is a derivative work of some parts of the JessyInk
*  project.
*  @source http://code.google.com/p/jessyink/
*/

function getElementsByProperty( node, name )
{
var elements = [];

if( node.getAttribute( name ) )
elements.push( node );

for( var counter = 0; counter < node.childNodes.length; ++counter )
{
if( node.childNodes[counter].nodeType == 1 )
{
var subElements = getElementsByProperty( node.childNodes[counter], name );
elements = elements.concat( subElements );
}
}
return elements;
}

function onKeyDown( aEvt )
{
if ( !aEvt )
aEvt = window.event;

var code = aEvt.keyCode || aEvt.charCode;

if( !processingEffect && keyCodeDictionary[currentMode] && keyCodeDictionary[currentMode][code] )
{
return keyCodeDictionary[currentMode][code]();
}
else
{
document.onkeypress = onKeyPress;
return null;
}
}
document.onkeydown = onKeyDown;

function onKeyPress( aEvt )
{
document.onkeypress = null;

if ( !aEvt )
aEvt = window.event;

var str = String.fromCharCode( aEvt.keyCode || aEvt.charCode );

if ( !processingEffect && charCodeDictionary[currentMode] && charCodeDictionary[currentMode][str] )
return charCodeDictionary[currentMode][str]();

return null;
}

function getDefaultKeyCodeDictionary()
{
var keyCodeDict = {};

keyCodeDict[SLIDE_MODE] = {};
keyCodeDict[INDEX_MODE] = {};

keyCodeDict[SLIDE_MODE][LEFT_KEY]
= function() { return aSlideShow.rewindEffect(); };
keyCodeDict[SLIDE_MODE][RIGHT_KEY]
= function() { return dispatchEffects(1); };
keyCodeDict[SLIDE_MODE][UP_KEY]
= function() { return aSlideShow.rewindEffect(); };
keyCodeDict[SLIDE_MODE][DOWN_KEY]
= function() { return skipEffects(1); };
keyCodeDict[SLIDE_MODE][PAGE_UP_KEY]
= function() { return aSlideShow.rewindAllEffects(); };
keyCodeDict[SLIDE_MODE][PAGE_DOWN_KEY]
= function() { return skipAllEffects(); };
keyCodeDict[SLIDE_MODE][HOME_KEY]
= function() { return aSlideShow.displaySlide( 0, true ); };
keyCodeDict[SLIDE_MODE][END_KEY]
= function() { return aSlideShow.displaySlide( theMetaDoc.nNumberOfSlides - 1, true ); };
keyCodeDict[SLIDE_MODE][SPACE_KEY]
= function() { return dispatchEffects(1); };

keyCodeDict[INDEX_MODE][LEFT_KEY]
= function() { return indexSetPageSlide( theSlideIndexPage.selectedSlideIndex - 1 ); };
keyCodeDict[INDEX_MODE][RIGHT_KEY]
= function() { return indexSetPageSlide( theSlideIndexPage.selectedSlideIndex + 1 ); };
keyCodeDict[INDEX_MODE][UP_KEY]
= function() { return indexSetPageSlide( theSlideIndexPage.selectedSlideIndex - theSlideIndexPage.indexColumns ); };
keyCodeDict[INDEX_MODE][DOWN_KEY]
= function() { return indexSetPageSlide( theSlideIndexPage.selectedSlideIndex + theSlideIndexPage.indexColumns ); };
keyCodeDict[INDEX_MODE][PAGE_UP_KEY]
= function() { return indexSetPageSlide( theSlideIndexPage.selectedSlideIndex - theSlideIndexPage.getTotalThumbnails() ); };
keyCodeDict[INDEX_MODE][PAGE_DOWN_KEY]
= function() { return indexSetPageSlide( theSlideIndexPage.selectedSlideIndex + theSlideIndexPage.getTotalThumbnails() ); };
keyCodeDict[INDEX_MODE][HOME_KEY]
= function() { return indexSetPageSlide( 0 ); };
keyCodeDict[INDEX_MODE][END_KEY]
= function() { return indexSetPageSlide( theMetaDoc.nNumberOfSlides - 1 ); };
keyCodeDict[INDEX_MODE][ENTER_KEY]
= function() { return toggleSlideIndex(); };
keyCodeDict[INDEX_MODE][SPACE_KEY]
= function() { return toggleSlideIndex(); };
keyCodeDict[INDEX_MODE][ESCAPE_KEY]
= function() { return abandonIndexMode(); };

return keyCodeDict;
}

function getDefaultCharCodeDictionary()
{
var charCodeDict = {};

charCodeDict[SLIDE_MODE] = {};
charCodeDict[INDEX_MODE] = {};

charCodeDict[SLIDE_MODE]['i']
= function () { return toggleSlideIndex(); };

charCodeDict[INDEX_MODE]['i']
= function () { return toggleSlideIndex(); };
charCodeDict[INDEX_MODE]['-']
= function () { return theSlideIndexPage.decreaseNumberOfColumns(); };
charCodeDict[INDEX_MODE]['=']
= function () { return theSlideIndexPage.increaseNumberOfColumns(); };
charCodeDict[INDEX_MODE]['+']
= function () { return theSlideIndexPage.increaseNumberOfColumns(); };
charCodeDict[INDEX_MODE]['0']
= function () { return theSlideIndexPage.resetNumberOfColumns(); };

return charCodeDict;
}


function slideOnMouseUp( aEvt )
{
if (!aEvt)
aEvt = window.event;

var nOffset = 0;

if( aEvt.button == 0 )
nOffset = 1;
else if( aEvt.button == 2 )
nOffset = -1;

if( 0 != nOffset )
dispatchEffects( nOffset );
return true; // the click has been handled
}

document.handleClick = slideOnMouseUp;


function slideOnMouseWheel(aEvt)
{
var delta = 0;

if (!aEvt)
aEvt = window.event;

if (aEvt.wheelDelta)
{ // IE Opera
delta = aEvt.wheelDelta/120;
}
else if (aEvt.detail)
{ // MOZ
delta = -aEvt.detail/3;
}

if (delta > 0)
skipEffects(-1);
else if (delta < 0)
skipEffects(1);

if (aEvt.preventDefault)
aEvt.preventDefault();

aEvt.returnValue = false;
}

if( window.addEventListener )
{
window.addEventListener( 'DOMMouseScroll', function( aEvt ) { return mouseHandlerDispatch( aEvt, MOUSE_WHEEL ); }, false );
}

window.onmousewheel
= function( aEvt ) { return mouseHandlerDispatch( aEvt, MOUSE_WHEEL ); };

function mouseHandlerDispatch( aEvt, anAction )
{
if( !aEvt )
aEvt = window.event;

var retVal = true;

if ( mouseHandlerDictionary[currentMode] && mouseHandlerDictionary[currentMode][anAction] )
{
var subRetVal = mouseHandlerDictionary[currentMode][anAction]( aEvt );

if( subRetVal != null && subRetVal != undefined )
retVal = subRetVal;
}

if( aEvt.preventDefault && !retVal )
aEvt.preventDefault();

aEvt.returnValue = retVal;

return retVal;
}

document.onmouseup = function( aEvt ) { return mouseHandlerDispatch( aEvt, MOUSE_UP ); };


function mouseClickHelper( aEvt )
{
if( !Detect.isMozilla )
{
var aWindowObject = document.defaultView;
if( aWindowObject )
{
var aTextSelection = aWindowObject.getSelection();
var sSelectedText =  aTextSelection.toString();
if( sSelectedText )
{
DBGLOG( 'text selection: ' + sSelectedText );
if( sLastSelectedText !== sSelectedText )
{
bTextHasBeenSelected = true;
sLastSelectedText = sSelectedText;
}
else
{
bTextHasBeenSelected = false;
}
return null;
}
else if( bTextHasBeenSelected )
{
bTextHasBeenSelected = false;
sLastSelectedText = '';
return null;
}
}
else
{
log( 'error: HyperlinkElement.handleClick: invalid window object.' );
}
}

var aSlideAnimationsHandler = theMetaDoc.aMetaSlideSet[nCurSlide].aSlideAnimationsHandler;
if( aSlideAnimationsHandler )
{
var aCurrentEventMultiplexer = aSlideAnimationsHandler.aEventMultiplexer;
if( aCurrentEventMultiplexer )
{
if( aCurrentEventMultiplexer.hasRegisteredMouseClickHandlers() )
{
return aCurrentEventMultiplexer.notifyMouseClick( aEvt );
}
}
}
return slideOnMouseUp( aEvt );
}


function getDefaultMouseHandlerDictionary()
{
var mouseHandlerDict = {};

mouseHandlerDict[SLIDE_MODE] = {};
mouseHandlerDict[INDEX_MODE] = {};

mouseHandlerDict[SLIDE_MODE][MOUSE_UP]
= mouseClickHelper;

mouseHandlerDict[SLIDE_MODE][MOUSE_WHEEL]
= function( aEvt ) { return slideOnMouseWheel( aEvt ); };

mouseHandlerDict[INDEX_MODE][MOUSE_UP]
= function( aEvt ) { return toggleSlideIndex(); };

return mouseHandlerDict;
}

function indexSetPageSlide( nIndex )
{
var aMetaSlideSet = theMetaDoc.aMetaSlideSet;
nIndex = getSafeIndex( nIndex, 0, aMetaSlideSet.length - 1 );

var nSelectedThumbnailIndex = nIndex % theSlideIndexPage.getTotalThumbnails();
var offset = nIndex - nSelectedThumbnailIndex;

if( offset < 0 )
offset = 0;

if( offset != INDEX_OFFSET )
{
INDEX_OFFSET = offset;
displayIndex( INDEX_OFFSET );
}

theSlideIndexPage.setSelection( nSelectedThumbnailIndex );
}


/*****
* @jessyinkend
*
*  The above code is a derivative work of some parts of the JessyInk project.
*  @source http://code.google.com/p/jessyink/
*/


/*****
* @licstart
*
* The following is the license notice for the part of JavaScript code of this
* page included between the '@dojostart' and the '@dojoend' notes.
*/

/*****  **********************************************************************
*
*  The 'New' BSD License:
*  **********************
*  Copyright (c) 2005-2012, The Dojo Foundation
*  All rights reserved.
*
*  Redistribution and use in source and binary forms, with or without
*  modification, are permitted provided that the following conditions are met:
*
*    * Redistributions of source code must retain the above copyright notice,
*      this list of conditions and the following disclaimer.
*    * Redistributions in binary form must reproduce the above copyright notice,
*      this list of conditions and the following disclaimer in the documentation
*      and/or other materials provided with the distribution.
*    * Neither the name of the Dojo Foundation nor the names of its contributors
*      may be used to endorse or promote products derived from this software
*      without specific prior written permission.
*
*  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS' AND
*  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
*  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
*  DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
*  FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
*  DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
*  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
*  CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
*  OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
*  OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*
****************************************************************************/


/*****
* @licend
*
* The above is the license notice for the part of JavaScript code of this
* page included between the '@dojostart' and the '@dojoend' notes.
*/


/*****
* @dojostart
*
*  The following code is a derivative work of some part of the dojox.gfx library.
*  @source http://svn.dojotoolkit.org/src/dojox/trunk/_base/sniff.js
*/

function has( name )
{
return has.cache[name];
}

has.cache = {};

has.add = function( name, test )
{
has.cache[name] = test;
};

function configureDetectionTools()
{
if( !navigator )
{
log( 'error: configureDetectionTools: configuration failed' );
return null;
}

var n = navigator,
dua = n.userAgent,
dav = n.appVersion,
tv = parseFloat(dav);

has.add('air', dua.indexOf('AdobeAIR') >= 0);
has.add('khtml', dav.indexOf('Konqueror') >= 0 ? tv : undefined);
has.add('webkit', parseFloat(dua.split('WebKit/')[1]) || undefined);
has.add('chrome', parseFloat(dua.split('Chrome/')[1]) || undefined);
has.add('safari', dav.indexOf('Safari')>=0 && !has('chrome') ? parseFloat(dav.split('Version/')[1]) : undefined);
has.add('mac', dav.indexOf('Macintosh') >= 0);
has.add('quirks', document.compatMode == 'BackCompat');
has.add('ios', /iPhone|iPod|iPad/.test(dua));
has.add('android', parseFloat(dua.split('Android ')[1]) || undefined);

if(!has('webkit')){
if(dua.indexOf('Opera') >= 0){
has.add('opera', tv >= 9.8 ? parseFloat(dua.split('Version/')[1]) || tv : tv);
}

if(dua.indexOf('Gecko') >= 0 && !has('khtml') && !has('webkit')){
has.add('mozilla', tv);
}
if(has('mozilla')){
has.add('ff', parseFloat(dua.split('Firefox/')[1] || dua.split('Minefield/')[1]) || undefined);
}

if(document.all && !has('opera')){
var isIE = parseFloat(dav.split('MSIE ')[1]) || undefined;

var mode = document.documentMode;
if(mode && mode != 5 && Math.floor(isIE) != mode){
isIE = mode;
}

has.add('ie', isIE);
}

has.add('wii', typeof opera != 'undefined' && opera.wiiremote);
}

var detect =
{
isFF: has('ff'),

isIE: has('ie'),

isKhtml: has('khtml'),

isWebKit: has('webkit'),

isMozilla: has('mozilla'),
isMoz: has('mozilla'),

isOpera: has('opera'),

isSafari: has('safari'),

isChrome: has('chrome'),

isMac: has('mac'),

isIos: has('ios'),

isAndroid: has('android'),

isWii: has('wii'),

isQuirks: has('quirks'),

isAir: has('air')
};
return detect;
}

/*****
* @dojoend
*
*  The above code is a derivative work of some part of the dojox.gfx library.
*  @source http://svn.dojotoolkit.org/src/dojox/trunk/_base/sniff.js
*/


/*****
* @licstart
*
* The following is the license notice for the part of JavaScript code  of
* this page included between the '@libreofficestart' and the '@libreofficeend'
* notes.
*/

/*****  ******************************************************************
*
* This file is part of the LibreOffice project.
*
* This Source Code Form is subject to the terms of the Mozilla Public
* License, v. 2.0. If a copy of the MPL was not distributed with this
* file, You can obtain one at http://mozilla.org/MPL/2.0/.
*
* This file incorporates work covered by the following license notice:
*
*   Licensed to the Apache Software Foundation (ASF) under one or more
*   contributor license agreements. See the NOTICE file distributed
*   with this work for additional information regarding copyright
*   ownership. The ASF licenses this file to you under the Apache
*   License, Version 2.0 (the 'License'); you may not use this file
*   except in compliance with the License. You may obtain a copy of
*   the License at http://www.apache.org/licenses/LICENSE-2.0 .
*
************************************************************************/

/*****
* @licend
*
* The above is the license notice for the part of JavaScript code  of
* this page included between the '@libreofficestart' and the '@libreofficeend'
* notes.
*/


/*****
* @libreofficestart
*
* Several parts of the following code are the result of the porting,
* started on August 2011, of the C++ code included in the source
* files placed under the folder '/slideshow/source' and
* sub-folders. This got later rebased onto the AL2-licensed versions
* of those files in early 2013.
* @source http://cgit.freedesktop.org/libreoffice/core/tree/slideshow/source
*
*/


window.onload = init;


var aOOOElemMetaSlides = 'ooo:meta_slides';
var aOOOElemMetaSlide = 'ooo:meta_slide';
var aOOOElemTextField = 'ooo:text_field';
var aPresentationClipPathId = 'presentation_clip_path';
var aPresentationClipPathShrinkId = 'presentation_clip_path_shrink';

var aOOOAttrNumberOfSlides = 'number-of-slides';
var aOOOAttrStartSlideNumber= 'start-slide-number';
var aOOOAttrNumberingType = 'page-numbering-type';
var aOOOAttrListItemNumberingType= 'numbering-type';
var aOOOAttrUsePositionedChars = 'use-positioned-chars';

var aOOOAttrSlide = 'slide';
var aOOOAttrMaster = 'master';
var aOOOAttrHasTransition = 'has-transition';
var aOOOAttrBackgroundVisibility = 'background-visibility';
var aOOOAttrMasterObjectsVisibility = 'master-objects-visibility';
var aOOOAttrPageNumberVisibility = 'page-number-visibility';
var aOOOAttrDateTimeVisibility = 'date-time-visibility';
var aOOOAttrFooterVisibility = 'footer-visibility';
var aOOOAttrHeaderVisibility = 'header-visibility';
var aOOOAttrDateTimeField = 'date-time-field';
var aOOOAttrFooterField = 'footer-field';
var aOOOAttrHeaderField = 'header-field';

var aOOOAttrDateTimeFormat = 'date-time-format';

var aOOOAttrTextAdjust = 'text-adjust';

var aClipPathGroupClassName = 'ClipPathGroup';
var aPageClassName = 'Page';
var aSlideNumberClassName = 'Slide_Number';
var aDateTimeClassName = 'Date/Time';
var aFooterClassName = 'Footer';
var aHeaderClassName = 'Header';

var NSS = {};
NSS['svg']='http://www.w3.org/2000/svg';
NSS['rdf']='http://www.w3.org/1999/02/22-rdf-syntax-ns#';
NSS['xlink']='http://www.w3.org/1999/xlink';
NSS['xml']='http://www.w3.org/XML/1998/namespace';
NSS['ooo'] = 'http://xml.openoffice.org/svg/export';
NSS['presentation'] = 'http://sun.com/xmlns/staroffice/presentation';
NSS['smil'] = 'http://www.w3.org/2001/SMIL20/';
NSS['anim'] = 'urn:oasis:names:tc:opendocument:xmlns:animation:1.0';

var SLIDE_MODE = 1;
var INDEX_MODE = 2;

var MOUSE_UP = 1;
var MOUSE_DOWN = 2;
var MOUSE_MOVE = 3;
var MOUSE_WHEEL = 4;

var LEFT_KEY = 37;          // cursor left keycode
var UP_KEY = 38;            // cursor up keycode
var RIGHT_KEY = 39;         // cursor right keycode
var DOWN_KEY = 40;          // cursor down keycode
var PAGE_UP_KEY = 33;       // page up keycode
var PAGE_DOWN_KEY = 34;     // page down keycode
var HOME_KEY = 36;          // home keycode
var END_KEY = 35;           // end keycode
var ENTER_KEY = 13;
var SPACE_KEY = 32;
var ESCAPE_KEY = 27;

var HIDDEN = 0;
var VISIBLE = 1;
var INHERIT = 2;
var aVisibilityAttributeValue = [ 'hidden', 'visible', 'inherit' ];
var aVisibilityValue = { 'hidden' : HIDDEN, 'visible' : VISIBLE, 'inherit' : INHERIT };

var ROOT_NODE = document.getElementsByTagNameNS( NSS['svg'], 'svg' )[0];
var WIDTH = 0;
var HEIGHT = 0;
var INDEX_COLUMNS_DEFAULT = 3;
var INDEX_OFFSET = 0;

var Detect = configureDetectionTools();
var theMetaDoc;
var theSlideIndexPage;
var currentMode = SLIDE_MODE;
var processingEffect = false;
var nCurSlide = undefined;
var bTextHasBeenSelected = false;
var sLastSelectedText = '';


var charCodeDictionary = getDefaultCharCodeDictionary();
var keyCodeDictionary = getDefaultKeyCodeDictionary();

var mouseHandlerDictionary = getDefaultMouseHandlerDictionary();


function object( aObject )
{
var F = function() {};
F.prototype = aObject;
return new F();
}


function extend( aSubType, aSuperType )
{
if (!aSuperType || !aSubType)
{
alert('extend failed, verify dependencies');
}
var OP = Object.prototype;
var sp = aSuperType.prototype;
var rp = object( sp );
aSubType.prototype = rp;

rp.constructor = aSubType;
aSubType.superclass = sp;

if (aSuperType != Object && sp.constructor == OP.constructor)
{
sp.constructor = aSuperType;
}

return aSubType;
}


function instantiate( TemplateClass, BaseType )
{
if( !TemplateClass.instanceSet )
TemplateClass.instanceSet = [];

var nSize = TemplateClass.instanceSet.length;

for( var i = 0; i < nSize; ++i )
{
if( TemplateClass.instanceSet[i].base === BaseType )
return TemplateClass.instanceSet[i].instance;
}

TemplateClass.instanceSet[ nSize ] = {};
TemplateClass.instanceSet[ nSize ].base = BaseType;
TemplateClass.instanceSet[ nSize ].instance = TemplateClass( BaseType );

return TemplateClass.instanceSet[ nSize ].instance;
}


function Rectangle( aSVGRectElem )
{
var x = parseInt( aSVGRectElem.getAttribute( 'x' ) );
var y = parseInt( aSVGRectElem.getAttribute( 'y' ) );
var width = parseInt( aSVGRectElem.getAttribute( 'width' ) );
var height = parseInt( aSVGRectElem.getAttribute( 'height' ) );

this.left = x;
this.right = x + width;
this.top = y;
this.bottom = y + height;
}

function log( message )
{
if( typeof console == 'object' )
{
console.log( message );
}
else if( typeof opera == 'object' )
{
opera.postError( message );
}
else if( typeof java == 'object' && typeof java.lang == 'object' )
{
java.lang.System.out.println( message );
}
}

function warning( bCondition, sMessage )
{
if( bCondition )
log( sMessage );
return bCondition;
}

function getNSAttribute( sNSPrefix, aElem, sAttrName )
{
if( !aElem ) return null;
if( 'getAttributeNS' in aElem )
{
return aElem.getAttributeNS( NSS[sNSPrefix], sAttrName );
}
else
{
return aElem.getAttribute( sNSPrefix + ':' + sAttrName );
}
}

function getOOOAttribute( aElem, sAttrName )
{
return getNSAttribute( 'ooo', aElem, sAttrName );
}

function setNSAttribute( sNSPrefix, aElem, sAttrName, aValue )
{
if( !aElem ) return false;
if( 'setAttributeNS' in aElem )
{
aElem.setAttributeNS( NSS[sNSPrefix], sAttrName, aValue );
return true;
}
else
{
aElem.setAttribute(sNSPrefix + ':' + sAttrName, aValue );
return true;
}
}

function setOOOAttribute( aElem, sAttrName, aValue )
{
return setNSAttribute( 'ooo', aElem, sAttrName, aValue );
}

function checkElemAndSetAttribute( aElem, sAttrName, aValue )
{
if( aElem )
aElem.setAttribute( sAttrName, aValue );
}

function getElementsByClassName( aElem, sClassName )
{

var aElementSet = [];
if( 'getElementsByClassName' in aElem )
{
aElementSet = aElem.getElementsByClassName( sClassName );
}
else
{
var aElementSetByClassProperty = getElementsByProperty( aElem, 'class' );
for( var i = 0; i < aElementSetByClassProperty.length; ++i )
{
var sAttrClassName = aElementSetByClassProperty[i].getAttribute( 'class' );
if( sAttrClassName == sClassName )
{
aElementSet.push( aElementSetByClassProperty[i] );
}
}
}
return aElementSet;
}

function getElementByClassName( aElem, sClassName /*, sTagName */)
{
var aElementSet = getElementsByClassName( aElem, sClassName );
if ( aElementSet.length == 1 )
return aElementSet[0];
else
return null;
}

function getClassAttribute(  aElem )
{
if( aElem )
return aElem.getAttribute( 'class' );
return '';
}

function createElementGroup( aParentElement, aElementList, nFrom, nCount, sGroupClass, sGroupId )
{
var nTo = nFrom + nCount;
if( nCount < 1 || aElementList.length < nTo )
{
log( 'createElementGroup: not enough elements available.' );
return;
}
var firstElement = aElementList[nFrom];
if( !firstElement )
{
log( 'createElementGroup: element not found.' );
return;
}
var aGroupElement = document.createElementNS( NSS['svg'], 'g' );
if( sGroupId )
aGroupElement.setAttribute( 'id', sGroupId );
if( sGroupClass )
aGroupElement.setAttribute( 'class', sGroupClass );
aParentElement.insertBefore( aGroupElement, firstElement );
var i = nFrom;
for( ; i < nTo; ++i )
{
aParentElement.removeChild( aElementList[i] );
aGroupElement.appendChild( aElementList[i] );
}
}

function initVisibilityProperty( aElement )
{
var nVisibility = VISIBLE;
var sVisibility = aElement.getAttribute( 'visibility' );
if( sVisibility ) nVisibility = aVisibilityValue[ sVisibility ];
return nVisibility;
}

function setElementVisibility( aElement, nCurrentVisibility, nNewVisibility )
{
if( nCurrentVisibility !=  nNewVisibility )
{
checkElemAndSetAttribute( aElement, 'visibility', aVisibilityAttributeValue[nNewVisibility] );
return nNewVisibility;
}
return nCurrentVisibility;
}

function getSafeIndex( nIndex, nMin, nMax )
{
if( nIndex < nMin )
return nMin;
else if( nIndex > nMax )
return nMax;
else
return nIndex;
}

function getRandomInt( nMax )
{
return Math.floor( Math.random() * nMax );
}

function isTextFieldElement( aElement )
{
var sClassName = aElement.getAttribute( 'class' );
return ( sClassName === aSlideNumberClassName ) ||
( sClassName === aFooterClassName ) ||
( sClassName === aHeaderClassName ) ||
( sClassName === aDateTimeClassName );
}


function DebugPrinter()
{
this.bEnabled = false;
}


DebugPrinter.prototype.on = function()
{
this.bEnabled = true;
};

DebugPrinter.prototype.off = function()
{
this.bEnabled = false;
};

DebugPrinter.prototype.isEnabled = function()
{
return this.bEnabled;
};

DebugPrinter.prototype.print = function( sMessage, nTime )
{
if( this.isEnabled() )
{
var sInfo = 'DBG: ' + sMessage;
if( nTime )
sInfo += ' (at: ' + String( nTime / 1000 ) + 's)';
log( sInfo );
}
};


var aGenericDebugPrinter = new DebugPrinter();
aGenericDebugPrinter.off();
var DBGLOG = bind2( DebugPrinter.prototype.print, aGenericDebugPrinter );

var NAVDBG = new DebugPrinter();
NAVDBG.off();

var ANIMDBG = new DebugPrinter();
ANIMDBG.off();

var aRegisterEventDebugPrinter = new DebugPrinter();
aRegisterEventDebugPrinter.off();

var aTimerEventQueueDebugPrinter = new DebugPrinter();
aTimerEventQueueDebugPrinter.off();

var aEventMultiplexerDebugPrinter = new DebugPrinter();
aEventMultiplexerDebugPrinter.off();

var aNextEffectEventArrayDebugPrinter = new DebugPrinter();
aNextEffectEventArrayDebugPrinter.off();

var aActivityQueueDebugPrinter = new DebugPrinter();
aActivityQueueDebugPrinter.off();

var aAnimatedElementDebugPrinter = new DebugPrinter();
aAnimatedElementDebugPrinter.off();


function MetaDocument()
{
var aMetaDocElem = document.getElementById( aOOOElemMetaSlides );
assert( aMetaDocElem, 'MetaDocument: the svg element with id:' + aOOOElemMetaSlides + 'is not valid.');

this.nNumberOfSlides = parseInt( aMetaDocElem.getAttributeNS( NSS['ooo'], aOOOAttrNumberOfSlides ) );
assert( typeof this.nNumberOfSlides == 'number' && this.nNumberOfSlides > 0,
'MetaDocument: number of slides is zero or undefined.' );
this.nStartSlideNumber = parseInt( aMetaDocElem.getAttributeNS( NSS['ooo'], aOOOAttrStartSlideNumber ) ) || 0;
this.sPageNumberingType = aMetaDocElem.getAttributeNS( NSS['ooo'], aOOOAttrNumberingType ) || 'arabic';
this.bIsUsePositionedChars = ( aMetaDocElem.getAttributeNS( NSS['ooo'], aOOOAttrUsePositionedChars ) === 'true' );

this.aClipPathGroup = getElementByClassName( ROOT_NODE, aClipPathGroupClassName );
assert( this.aClipPathGroup, 'MetaDocument: the clip path group element is not valid.');

this.aPresentationClipPath = document.getElementById( aPresentationClipPathId );
assert( this.aPresentationClipPath,
'MetaDocument: the presentation clip path element element is not valid.');

this.aMetaSlideSet = [];
this.aMasterPageSet = {};
this.aTextFieldHandlerSet = {};
this.aTextFieldContentProviderSet = [];
this.aSlideNumberProvider = new SlideNumberProvider( this.nStartSlideNumber + 1, this.sPageNumberingType );

this.bIsAnimated = false;
this.aSlideAnimationsMap = {};
this.initSlideAnimationsMap();

this.theMetaDummySlide = new MetaSlide( 'ooo:meta_dummy_slide', this );

for( var i = 0; i < this.nNumberOfSlides; ++i )
{
var sMetaSlideId = aOOOElemMetaSlide + '_' + i;
this.aMetaSlideSet.push( new MetaSlide( sMetaSlideId, this ) );
}
assert( this.aMetaSlideSet.length == this.nNumberOfSlides,
'MetaDocument: aMetaSlideSet.length != nNumberOfSlides.' );
}

MetaDocument.prototype =
{

getCurrentSlide : function()
{
return this.aMetaSlideSet[nCurSlide];
},

setCurrentSlide : function( nSlideIndex )
{
if( nSlideIndex >= 0 &&  nSlideIndex < this.nNumberOfSlides )
{
if( nCurSlide !== undefined )
this.aMetaSlideSet[nCurSlide].hide();
this.aMetaSlideSet[nSlideIndex].show();
nCurSlide = nSlideIndex;
}
else
{
log('MetaDocument.setCurrentSlide: slide index out of range: ' + nSlideIndex );
}
},


initSlideAnimationsMap : function()
{
var aAnimationsSection = document.getElementById( 'presentation-animations' );
if( aAnimationsSection )
{
var aAnimationsDefSet = aAnimationsSection.getElementsByTagName( 'defs' );

this.bIsAnimated = ( typeof aAnimationsDefSet.length =='number' &&
aAnimationsDefSet.length > 0 );

for( var i = 0; i < aAnimationsDefSet.length; ++i )
{
var sSlideId = aAnimationsDefSet[i].getAttributeNS( NSS['ooo'], aOOOAttrSlide );
var aChildSet = getElementChildren( aAnimationsDefSet[i] );
if( sSlideId && ( aChildSet.length === 1 ) )
{
this.aSlideAnimationsMap[ sSlideId ] = aChildSet[0];
}
}
}
}

}; // end MetaDocument prototype

function MetaSlide( sMetaSlideId, aMetaDoc )
{
this.theDocument = document;
this.id = sMetaSlideId;
this.theMetaDoc = aMetaDoc;

this.element = this.theDocument.getElementById( this.id );
assert( this.element,
'MetaSlide: meta_slide element <' + this.id + '> not found.' );

this.slideId = this.element.getAttributeNS( NSS['ooo'], aOOOAttrSlide );
this.slideElement = this.theDocument.getElementById( this.slideId );
assert( this.slideElement,
'MetaSlide: slide element <' + this.slideId + '> not found.' );

if( this.slideId !== 'dummy_slide' )
this.nSlideNumber = parseInt( this.slideId.substr(2) );
else
this.nSlideNumber= -1;

this.aContainerElement = this.slideElement.parentNode;
this.slideContainerId = this.aContainerElement.getAttribute( 'id' );
this.aVisibilityStatusElement = this.aContainerElement.parentNode;

this.pageElement = getElementByClassName( this.slideElement, aPageClassName );
assert( this.pageElement,
'MetaSlide: page element <' + this.slideId + '> not found.' );

this.masterPage = this.initMasterPage();

this.nAreMasterObjectsVisible     = this.initVisibilityProperty( aOOOAttrMasterObjectsVisibility,  VISIBLE );
this.nIsBackgroundVisible         = this.initVisibilityProperty( aOOOAttrBackgroundVisibility,     VISIBLE );
this.nIsPageNumberVisible         = this.initVisibilityProperty( aOOOAttrPageNumberVisibility,     HIDDEN );
this.nIsDateTimeVisible           = this.initVisibilityProperty( aOOOAttrDateTimeVisibility,       VISIBLE );
this.nIsFooterVisible             = this.initVisibilityProperty( aOOOAttrFooterVisibility,         VISIBLE );
this.nIsHeaderVisible             = this.initVisibilityProperty( aOOOAttrHeaderVisibility,         VISIBLE );

this.bIsDateTimeVariable = undefined;

this.aTextFieldContentProviderSet = {};
this.aTextFieldContentProviderSet[aSlideNumberClassName]   = this.initSlideNumberFieldContentProvider();
this.aTextFieldContentProviderSet[aDateTimeClassName]      = this.initDateTimeFieldContentProvider( aOOOAttrDateTimeField );
this.aTextFieldContentProviderSet[aFooterClassName]        = this.initFixedTextFieldContentProvider( aOOOAttrFooterField );
this.aTextFieldContentProviderSet[aHeaderClassName]        = this.initFixedTextFieldContentProvider( aOOOAttrHeaderField );

this.aTransitionHandler = null;
this.bHasTransition = this.initHasTransition() || true;
if( this.bHasTransition )
{
this.aTransitionHandler = new SlideTransition( this.getSlideAnimationsRoot(), this.slideId );
}

this.aSlideAnimationsHandler = new SlideAnimations( aSlideShow.getContext() );
this.aSlideAnimationsHandler.importAnimations( this.getSlideAnimationsRoot() );
this.aSlideAnimationsHandler.parseElements();

if( false && this.aSlideAnimationsHandler.aRootNode )
log( this.aSlideAnimationsHandler.aRootNode.info( true ) );

this.aTextShapeSet = this.collectTextShapes();

this.aHyperlinkSet = this.initHyperlinks();

}

MetaSlide.prototype =
{

show : function()
{
this.updateMasterPageView();
this.aVisibilityStatusElement.setAttribute( 'visibility', 'inherit' );
},

hide : function()
{
this.aVisibilityStatusElement.setAttribute( 'visibility', 'hidden' );
},

updateMasterPageView : function()
{
if( !this.aMasterPageView )
{
this.aMasterPageView = new MasterPageView( this );
this.aMasterPageView.attachToSlide();
}
this.aMasterPageView.update();
},

initMasterPage : function()
{
var sMasterPageId = this.element.getAttributeNS( NSS['ooo'], aOOOAttrMaster );

if( !this.theMetaDoc.aMasterPageSet.hasOwnProperty( sMasterPageId ) )
{
this.theMetaDoc.aMasterPageSet[ sMasterPageId ] = new MasterPage( sMasterPageId, this );

this.theMetaDoc.aTextFieldHandlerSet[ sMasterPageId ] = {};
}
return this.theMetaDoc.aMasterPageSet[ sMasterPageId ];
},

initHasTransition : function()
{
var sHasTransition = this.element.getAttributeNS( NSS['ooo'], aOOOAttrHasTransition );
return ( sHasTransition === 'true' );
},

initVisibilityProperty : function( aVisibilityAttribute, nDefaultValue )
{
var nVisibility = nDefaultValue;
var sVisibility = getOOOAttribute( this.element, aVisibilityAttribute );
if( sVisibility )
nVisibility = aVisibilityValue[ sVisibility ];
return nVisibility;
},

initSlideNumberFieldContentProvider : function()
{
return this.theMetaDoc.aSlideNumberProvider;
},

initDateTimeFieldContentProvider : function( aOOOAttrDateTimeField )
{
var sTextFieldId = getOOOAttribute( this.element, aOOOAttrDateTimeField );
if( !sTextFieldId )  return null;

var nLength = aOOOElemTextField.length + 1;
var nIndex = parseInt(sTextFieldId.substring( nLength ) );
if( typeof nIndex != 'number') return null;

if( !this.theMetaDoc.aTextFieldContentProviderSet[ nIndex ] )
{
var aTextField;
var aTextFieldElem = document.getElementById( sTextFieldId );
var sClassName = getClassAttribute( aTextFieldElem );
if( sClassName == 'FixedDateTimeField' )
{
aTextField = new FixedTextProvider( aTextFieldElem );
this.bIsDateTimeVariable = false;
}
else if( sClassName == 'VariableDateTimeField' )
{
aTextField = new CurrentDateTimeProvider( aTextFieldElem );
this.bIsDateTimeVariable = true;
}
else
{
aTextField = null;
}
this.theMetaDoc.aTextFieldContentProviderSet[ nIndex ] = aTextField;
}
return this.theMetaDoc.aTextFieldContentProviderSet[ nIndex ];
},

initFixedTextFieldContentProvider : function( aOOOAttribute )
{
var sTextFieldId = getOOOAttribute( this.element, aOOOAttribute );
if( !sTextFieldId ) return null;

var nLength = aOOOElemTextField.length + 1;
var nIndex = parseInt( sTextFieldId.substring( nLength ) );
if( typeof nIndex != 'number') return null;

if( !this.theMetaDoc.aTextFieldContentProviderSet[ nIndex ] )
{
var aTextFieldElem = document.getElementById( sTextFieldId );
this.theMetaDoc.aTextFieldContentProviderSet[ nIndex ]
= new FixedTextProvider( aTextFieldElem );
}
return this.theMetaDoc.aTextFieldContentProviderSet[ nIndex ];
},

collectTextShapes : function()
{
var aTextShapeSet = [];
var aTextShapeIndexElem = getElementByClassName( document, 'TextShapeIndex' );
if( aTextShapeIndexElem )
{
var aIndexEntryList = getElementChildren( aTextShapeIndexElem );
var i;
for( i = 0; i < aIndexEntryList.length; ++i )
{
var sSlideId = getOOOAttribute( aIndexEntryList[i], 'slide' );
if( sSlideId === this.slideId )
{
var sTextShapeIds = getOOOAttribute( aIndexEntryList[i], 'id-list' );
if( sTextShapeIds )
{
var aTextShapeIdSet =  sTextShapeIds.split( ' ' );
var j;
for( j = 0; j < aTextShapeIdSet.length; ++j )
{
var aTextShapeElem = document.getElementById( aTextShapeIdSet[j] );
if( aTextShapeElem )
{
aTextShapeSet.push( aTextShapeElem );
}
else
{
log( 'warning: MetaSlide.collectTextShapes: text shape with id <' + aTextShapeIdSet[j] + '> is not valid.'  );
}
}
}
break;
}
}
}
return aTextShapeSet;
},

initHyperlinks : function()
{
var aHyperlinkSet = {};
var i;
for( i = 0; i < this.aTextShapeSet.length; ++i )
{
if( this.aTextShapeSet[i] )
{
var aHyperlinkIdList = getElementByClassName( this.aTextShapeSet[i], 'HyperlinkIdList' );
if( aHyperlinkIdList )
{
var sHyperlinkIds = aHyperlinkIdList.textContent;
if( sHyperlinkIds )
{
var aHyperlinkIdSet = sHyperlinkIds.trim().split( ' ' );
var j;
for( j = 0; j < aHyperlinkIdSet.length; ++j )
{
var sId = aHyperlinkIdSet[j];
aHyperlinkSet[ sId ] = new HyperlinkElement( sId, this.aSlideAnimationsHandler.aEventMultiplexer );
}
}
}
}
}
return aHyperlinkSet;
},

getSlideAnimationsRoot : function()
{
return this.theMetaDoc.aSlideAnimationsMap[ this.slideId ];
}

}; // end MetaSlide prototype

function MasterPage( sMasterPageId, aMetaSlide )
{
this.id = sMasterPageId;
this.metaSlide = aMetaSlide;

this.element = document.getElementById( this.id );
assert( this.element,
'MasterPage: master page element <' + this.id + '> not found.' );

this.background = getElementByClassName( this.element, 'Background' );
if( this.background )
{
this.backgroundId = this.background.getAttribute( 'id' );
this.backgroundVisibility = initVisibilityProperty( this.background );
}
else
{
this.backgroundId = '';
log( 'MasterPage: the background element is not valid.' );
}

this.backgroundObjects = getElementByClassName( this.element, 'BackgroundObjects' );
if( this.backgroundObjects )
{
this.backgroundObjectsId = this.backgroundObjects.getAttribute( 'id' );
this.backgroundObjectsVisibility = initVisibilityProperty( this.backgroundObjects );

if( this.backgroundObjectsVisibility != HIDDEN )
{
var aBackgroundObjectList = getElementChildren( this.backgroundObjects );
var nFrom = 0;
var nCount = 0;
var nSubGroupId = 1;
var sClass;
var sId = '';
this.aBackgroundObjectSubGroupIdList = [];
var i = 0;
for( ; i < aBackgroundObjectList.length; ++i )
{
sClass = aBackgroundObjectList[i].getAttribute( 'class' );
if( !sClass || ( ( sClass !== aDateTimeClassName ) && ( sClass !== aFooterClassName )
&& ( sClass !== aHeaderClassName ) && ( sClass !== aSlideNumberClassName ) ) )
{
if( nCount === 0 )
{
nFrom = i;
sId = this.backgroundObjectsId + '.' + nSubGroupId;
++nSubGroupId;
this.aBackgroundObjectSubGroupIdList.push( sId );
}
++nCount;
}
else
{
this.aBackgroundObjectSubGroupIdList.push( sClass );
if( nCount !== 0 )
{
createElementGroup( this.backgroundObjects, aBackgroundObjectList, nFrom, nCount, 'BackgroundObjectSubgroup', sId );
nCount = 0;
}
}
}
if( nCount !== 0 )
{
createElementGroup( this.backgroundObjects, aBackgroundObjectList, nFrom, nCount, 'BackgroundObjectSubgroup', sId );
}
}
}
else
{
this.backgroundObjectsId = '';
log( 'MasterPage: the background objects element is not valid.' );
}

this.aPlaceholderShapeSet = {};
this.initPlaceholderShapes();
}

MasterPage.prototype =
{

initPlaceholderShapes : function()
{
this.aPlaceholderShapeSet[ aSlideNumberClassName ] = new PlaceholderShape( this, aSlideNumberClassName );
this.aPlaceholderShapeSet[ aDateTimeClassName ] = new PlaceholderShape( this, aDateTimeClassName );
this.aPlaceholderShapeSet[ aFooterClassName ] = new PlaceholderShape( this, aFooterClassName );
this.aPlaceholderShapeSet[ aHeaderClassName ] = new PlaceholderShape( this, aHeaderClassName );
}

}; // end MasterPage prototype

function PlaceholderShape( aMasterPage, sClassName )
{
this.masterPage = aMasterPage;
this.className = sClassName;

this.element = null;
this.textElement = null;
this.init();
}

PlaceholderShape.prototype.isValid = function()
{
return ( this.element && this.textElement );
};


PlaceholderShape.prototype.init = function()
{

var aTextFieldElement = getElementByClassName( this.masterPage.backgroundObjects, this.className );
if( aTextFieldElement )
{
var aPlaceholderElement = getElementByClassName( aTextFieldElement, 'PlaceholderText' );
if( aPlaceholderElement )
{
var aSVGRectElem = getElementByClassName( aTextFieldElement, 'BoundingBox' );
if( aSVGRectElem )
{
var aRect = new Rectangle( aSVGRectElem );
var sTextAdjust = getOOOAttribute( aTextFieldElement, aOOOAttrTextAdjust ) || 'left';
var sTextAnchor, sX;
if( sTextAdjust == 'left' )
{
sTextAnchor = 'start';
sX = String( aRect.left );
}
else if( sTextAdjust == 'right' )
{
sTextAnchor = 'end';
sX = String( aRect.right );
}
else if( sTextAdjust == 'center' )
{
sTextAnchor = 'middle';
var nMiddle = ( aRect.left + aRect.right ) / 2;
sX = String( parseInt( String( nMiddle ) ) );
}
if( sTextAnchor )
aPlaceholderElement.setAttribute( 'text-anchor', sTextAnchor );
if( sX )
aPlaceholderElement.setAttribute( 'x', sX );
}

if( this.masterPage.metaSlide.theMetaDoc.bIsUsePositionedChars )
{
var aTextLineGroupElem = aPlaceholderElement.parentNode.parentNode;
if( aTextLineGroupElem )
{
var sFontFamilyAttr = aTextLineGroupElem.getAttribute( 'font-family' );
if( sFontFamilyAttr )
{
var aChildSet = getElementChildren( aTextLineGroupElem );
if( aChildSet.length > 1  )
var i = 1;
for( ; i < aChildSet.length; ++i )
{
aTextLineGroupElem.removeChild( aChildSet[i] );
}
}
}
}
this.element = aTextFieldElement;
this.textElement = aPlaceholderElement;
}
}
};

function MasterPageView( aMetaSlide )
{
this.aMetaSlide = aMetaSlide;
this.aSlideElement = aMetaSlide.slideElement;
this.aPageElement = aMetaSlide.pageElement;
this.aMasterPage = aMetaSlide.masterPage;
this.aMPVElement = this.createElement();
this.bIsAttached = false;
}


MasterPageView.prototype.attachToSlide = function()
{
if( !this.bIsAttached )
{
var aInsertedElement = this.aSlideElement.insertBefore( this.aMPVElement, this.aPageElement );
assert( aInsertedElement === this.aMPVElement,
'MasterPageView.attachToSlide: aInsertedElement != this.aMPVElement' );

this.bIsAttached = true;
}
};

MasterPageView.prototype.detachFromSlide = function()
{
if( this.bIsAttached )
{
this.aSlideElement.removeChild( this.aMPVElement );
this.bIsAttached = false;
}
};

MasterPageView.prototype.update = function()
{
if( this.aDateTimeFieldHandler && this.aMetaSlide.bIsDateTimeVariable )
this.aDateTimeFieldHandler.update();
};


MasterPageView.prototype.createElement = function()
{
var theDocument = document;
var aMasterPageViewElement = theDocument.createElementNS( NSS['svg'], 'g' );
assert( aMasterPageViewElement,
'MasterPageView.createElement: failed to create a master page view element.' );
aMasterPageViewElement.setAttribute( 'class', 'MasterPageView' );

var aWhiteRect = theDocument.createElementNS( NSS['svg'], 'rect' );
var nWidthExt = WIDTH / 1000;
var nHeightExt = HEIGHT / 1000;
aWhiteRect.setAttribute( 'x', String( -nWidthExt / 2 ) );
aWhiteRect.setAttribute( 'y', String( -nHeightExt / 2 ) );
aWhiteRect.setAttribute( 'width', String( WIDTH + nWidthExt ) );
aWhiteRect.setAttribute( 'height', String( HEIGHT + nHeightExt ) );
aWhiteRect.setAttribute( 'fill', '#FFFFFF' );
aMasterPageViewElement.appendChild( aWhiteRect );

if( this.aMetaSlide.nIsBackgroundVisible )
{
this.aBackgroundElement = theDocument.createElementNS( NSS['svg'], 'use' );
this.aBackgroundElement.setAttribute( 'class', 'Background' );
setNSAttribute( 'xlink', this.aBackgroundElement,
'href', '#' + this.aMasterPage.backgroundId );

aMasterPageViewElement.appendChild( this.aBackgroundElement );
}

if( this.aMetaSlide.nAreMasterObjectsVisible )
{
this.aBackgroundObjectsElement = theDocument.createElementNS( NSS['svg'], 'g' );
this.aBackgroundObjectsElement.setAttribute( 'class', 'BackgroundObjects' );

var aBackgroundObjectSubGroupIdList = this.aMasterPage.aBackgroundObjectSubGroupIdList;
this.aBackgroundSubGroupElementSet = [];
var aPlaceholderShapeSet = this.aMasterPage.aPlaceholderShapeSet;
var aTextFieldContentProviderSet = this.aMetaSlide.aTextFieldContentProviderSet;
var aDefsElement = this.aMetaSlide.element.parentNode;
var aTextFieldHandlerSet = this.aMetaSlide.theMetaDoc.aTextFieldHandlerSet;
var sMasterSlideId = this.aMasterPage.id;

var i = 0;
var sId;
for( ; i < aBackgroundObjectSubGroupIdList.length; ++i )
{
sId = aBackgroundObjectSubGroupIdList[i];
if( sId === aSlideNumberClassName )
{
if( aPlaceholderShapeSet[aSlideNumberClassName] &&
aPlaceholderShapeSet[aSlideNumberClassName].isValid() &&
this.aMetaSlide.nIsPageNumberVisible &&
aTextFieldContentProviderSet[aSlideNumberClassName] )
{
this.aSlideNumberFieldHandler =
new SlideNumberFieldHandler( aPlaceholderShapeSet[aSlideNumberClassName],
aTextFieldContentProviderSet[aSlideNumberClassName] );
this.aSlideNumberFieldHandler.update( this.aMetaSlide.nSlideNumber );
this.aSlideNumberFieldHandler.appendTo( this.aBackgroundObjectsElement );
}
}
else if( sId === aDateTimeClassName )
{
if( this.aMetaSlide.nIsDateTimeVisible )
{
this.aDateTimeFieldHandler =
this.initTextFieldHandler( aDateTimeClassName, aPlaceholderShapeSet,
aTextFieldContentProviderSet, aDefsElement,
aTextFieldHandlerSet, sMasterSlideId );
}
}
else if( sId === aFooterClassName )
{
if( this.aMetaSlide.nIsFooterVisible )
{
this.aFooterFieldHandler =
this.initTextFieldHandler( aFooterClassName, aPlaceholderShapeSet,
aTextFieldContentProviderSet, aDefsElement,
aTextFieldHandlerSet, sMasterSlideId );
}
}
else if( sId === aHeaderClassName )
{
if( this.aMetaSlide.nIsHeaderVisible )
{
this.aHeaderFieldHandler =
this.initTextFieldHandler( aHeaderClassName, aPlaceholderShapeSet,
aTextFieldContentProviderSet, aDefsElement,
aTextFieldHandlerSet, sMasterSlideId );
}
}
else
{
var aBackgroundSubGroupElement = theDocument.createElementNS( NSS['svg'], 'use' );
aBackgroundSubGroupElement.setAttribute( 'class', 'BackgroundObjectSubGroup' );
setNSAttribute( 'xlink', aBackgroundSubGroupElement,
'href', '#' + sId );
this.aBackgroundSubGroupElementSet.push( aBackgroundSubGroupElement );
this.aBackgroundObjectsElement.appendChild( aBackgroundSubGroupElement );
}

}
aMasterPageViewElement.appendChild( this.aBackgroundObjectsElement );
}

return aMasterPageViewElement;
};

MasterPageView.prototype.initTextFieldHandler =
function( sClassName, aPlaceholderShapeSet, aTextFieldContentProviderSet,
aDefsElement, aTextFieldHandlerSet, sMasterSlideId )
{
var aTextFieldHandler = null;
if( aPlaceholderShapeSet[sClassName] &&
aPlaceholderShapeSet[sClassName].isValid()
&& aTextFieldContentProviderSet[sClassName] )
{
var sTextFieldContentProviderId = aTextFieldContentProviderSet[sClassName].sId;
if ( !aTextFieldHandlerSet[ sMasterSlideId ][ sTextFieldContentProviderId ] )
{
aTextFieldHandlerSet[ sMasterSlideId ][ sTextFieldContentProviderId ] =
new TextFieldHandler( aPlaceholderShapeSet[sClassName],
aTextFieldContentProviderSet[sClassName] );
aTextFieldHandler = aTextFieldHandlerSet[ sMasterSlideId ][ sTextFieldContentProviderId ];
aTextFieldHandler.update();
aTextFieldHandler.appendTo( aDefsElement );
}
else
{
aTextFieldHandler = aTextFieldHandlerSet[ sMasterSlideId ][ sTextFieldContentProviderId ];
}

var aTextFieldElement = document.createElementNS( NSS['svg'], 'use' );
aTextFieldElement.setAttribute( 'class', sClassName );
setNSAttribute( 'xlink', aTextFieldElement,
'href', '#' + aTextFieldHandler.sId );
this.aBackgroundObjectsElement.appendChild( aTextFieldElement );
}
return aTextFieldHandler;
};

function TextFieldHandler( aPlaceholderShape, aTextContentProvider )
{
this.aPlaceHolderShape = aPlaceholderShape;
this.aTextContentProvider = aTextContentProvider;
assert( this.aTextContentProvider,
'TextFieldHandler: text content provider not defined.' );
this.sId = 'tf' + String( TextFieldHandler.getUniqueId() );
this.aTextFieldElement = null;
this.aTextPlaceholderElement = null;
this.cloneElement();
}


TextFieldHandler.CURR_UNIQUE_ID = 0;

TextFieldHandler.getUniqueId = function()
{
++TextFieldHandler.CURR_UNIQUE_ID;
return TextFieldHandler.CURR_UNIQUE_ID;
};

TextFieldHandler.prototype.cloneElement = function()
{
assert( this.aPlaceHolderShape && this.aPlaceHolderShape.isValid(),
'TextFieldHandler.cloneElement: placeholder shape is not valid.' );
this.aTextFieldElement = this.aPlaceHolderShape.element.cloneNode( true /* deep clone */ );
assert( this.aTextFieldElement,
'TextFieldHandler.cloneElement: aTextFieldElement is not defined' );
this.aTextFieldElement.setAttribute( 'id', this.sId );
this.aTextFieldElement.removeAttribute( 'visibility' );
this.aTextPlaceholderElement = getElementByClassName( this.aTextFieldElement, 'PlaceholderText' );
assert( this.aTextPlaceholderElement,
'TextFieldHandler.cloneElement: aTextPlaceholderElement is not defined' );
};


TextFieldHandler.prototype.appendTo = function( aParentNode )
{
if( !this.aTextFieldElement )
{
log( 'TextFieldHandler.appendTo: aTextFieldElement is not defined' );
return;
}
if( !aParentNode )
{
log( 'TextFieldHandler.appendTo: parent node is not defined' );
return;
}

aParentNode.appendChild( this.aTextFieldElement );
};

TextFieldHandler.prototype.setTextContent = function( sText )
{
if( !this.aTextPlaceholderElement )
{
log( 'PlaceholderShape.setTextContent: text element is not valid in placeholder of type '
+ this.className + ' that belongs to master slide ' + this.masterPage.id );
return;
}
this.aTextPlaceholderElement.textContent = sText;
};

TextFieldHandler.prototype.update = function()
{
if( !this.aTextContentProvider )
log('TextFieldHandler.update: text content provider not defined.');
else
this.aTextContentProvider.update( this );
};

function SlideNumberFieldHandler( aPlaceholderShape, aTextContentProvider )
{
SlideNumberFieldHandler.superclass.constructor.call( this, aPlaceholderShape, aTextContentProvider );
}
extend( SlideNumberFieldHandler, TextFieldHandler );


SlideNumberFieldHandler.prototype.update = function( nPageNumber )
{
if( !this.aTextContentProvider )
log('TextFieldHandler.update: text content provider not defined.');
else
this.aTextContentProvider.update( this, nPageNumber );
};


function TextFieldContentProvider( aTextFieldContentElement )
{
if( aTextFieldContentElement )
this.sId = aTextFieldContentElement.getAttribute( 'id' );
}

function FixedTextProvider( aTextFieldContentElement )
{
FixedTextProvider.superclass.constructor.call( this, aTextFieldContentElement );
this.text = aTextFieldContentElement.textContent;
}
extend( FixedTextProvider, TextFieldContentProvider );


FixedTextProvider.prototype.update = function( aFixedTextField )
{
aFixedTextField.setTextContent( this.text );
};

function CurrentDateTimeProvider( aTextFieldContentElement )
{
CurrentDateTimeProvider.superclass.constructor.call( this, aTextFieldContentElement );
this.dateTimeFormat = getOOOAttribute( aTextFieldContentElement, aOOOAttrDateTimeFormat );
}
extend( CurrentDateTimeProvider, TextFieldContentProvider );


CurrentDateTimeProvider.prototype.update = function( aDateTimeField )
{
var sText = this.createDateTimeText( this.dateTimeFormat );
aDateTimeField.setTextContent( sText );
};


CurrentDateTimeProvider.prototype.createDateTimeText = function( sDateTimeFormat )
{
var aDate = new Date();
var sDate = aDate.toLocaleString();
return sDate;
};

function SlideNumberProvider( nInitialSlideNumber, sPageNumberingType )
{
SlideNumberProvider.superclass.constructor.call( this, null );
this.nInitialSlideNumber = nInitialSlideNumber;
this.pageNumberingType = sPageNumberingType;

}
extend( SlideNumberProvider, TextFieldContentProvider );


SlideNumberProvider.prototype.getNumberingType = function()
{
return this.pageNumberingType;
};


SlideNumberProvider.prototype.update = function( aSlideNumberField, nSlideNumber )
{
if( nSlideNumber === undefined )
{
if( nCurSlide === undefined )
nSlideNumber = this.nInitialSlideNumber;
else
nSlideNumber = nCurSlide + 1;
}
var sText = this.createSlideNumberText( nSlideNumber, this.getNumberingType() );
aSlideNumberField.setTextContent( sText );
};


SlideNumberProvider.prototype.createSlideNumberText = function( nSlideNumber, sNumberingType )
{
return String( nSlideNumber );
};


function SlideIndexPage()
{
this.pageElementId = 'slide_index';
this.pageBgColor = 'rgb(252,252,252)';
this.pageElement = this.createPageElement();
assert( this.pageElement, 'SlideIndexPage: pageElement is not valid' );
this.indexColumns = INDEX_COLUMNS_DEFAULT;
this.totalThumbnails = this.indexColumns * this.indexColumns;
this.selectedSlideIndex = undefined;

this.xSpacingFactor = 600/28000;
this.ySpacingFactor = 450/21000;
this.xSpacing = WIDTH * this.xSpacingFactor;
this.ySpacing = HEIGHT * this.ySpacingFactor;
this.halfBorderWidthFactor = ( 300/28000 ) * ( this.indexColumns / 3 );
this.halfBorderWidth = WIDTH * this.halfBorderWidthFactor;
this.borderWidth = 2 * this.halfBorderWidth;
this.scaleFactor = ( 1 - ( this.indexColumns + 1 ) * this.xSpacingFactor ) /
( this.indexColumns * ( 1 + 2 * this.halfBorderWidthFactor ) );

this.thumbnailMouseAreaTemplateId = 'thumbnail_mouse_area';
this.thumbnailMouseAreaTemplateElement = null;
this.thumbnailBorderTemplateId = 'thumbnail_border';
this.thumbnailBorderTemplateElement = null;
this.createTemplateElements();

this.aThumbnailSet = new Array( this.totalThumbnails );
for( var i = 0; i < this.totalThumbnails; ++i )
{
this.aThumbnailSet[i] = new Thumbnail( this, i );
this.aThumbnailSet[i].updateView();
}

this.curThumbnailIndex = 0;
}


SlideIndexPage.prototype.getTotalThumbnails = function()
{
return this.totalThumbnails;
};

SlideIndexPage.prototype.show = function()
{
this.pageElement.setAttribute( 'display', 'inherit' );
};

SlideIndexPage.prototype.hide = function()
{
this.pageElement.setAttribute( 'display', 'none' );
};

SlideIndexPage.prototype.setSelection = function( nIndex )
{
nIndex = getSafeIndex( nIndex, 0, this.getTotalThumbnails() - 1 );
if( this.curThumbnailIndex != nIndex )
{
this.aThumbnailSet[ this.curThumbnailIndex ].unselect();
this.aThumbnailSet[ nIndex ].select();
this.curThumbnailIndex = nIndex;
}
this.selectedSlideIndex = this.aThumbnailSet[ nIndex ].slideIndex;
};

SlideIndexPage.prototype.createPageElement = function()
{
var aPageElement = document.createElementNS( NSS['svg'], 'g' );
aPageElement.setAttribute( 'id', this.pageElementId );
aPageElement.setAttribute( 'display', 'none' );
aPageElement.setAttribute( 'visibility', 'visible' );

var sPageBgColor = this.pageBgColor + ';';
var aRectElement = document.createElementNS( NSS['svg'], 'rect' );
aRectElement.setAttribute( 'x', 0 );
aRectElement.setAttribute( 'y', 0 );
aRectElement.setAttribute( 'width', WIDTH );
aRectElement.setAttribute( 'height', HEIGHT );
aRectElement.setAttribute( 'style', 'stroke:none;fill:' + sPageBgColor );

aPageElement.appendChild( aRectElement );
ROOT_NODE.appendChild( aPageElement );
return( document.getElementById( this.pageElementId ) );
};

SlideIndexPage.prototype.createTemplateElements = function()
{
var aDefsElement = document.createElementNS( NSS['svg'], 'defs' );
var aRectElement = document.createElementNS( NSS['svg'], 'rect' );
aRectElement.setAttribute( 'id', this.thumbnailBorderTemplateId );
aRectElement.setAttribute( 'x', -this.halfBorderWidth );
aRectElement.setAttribute( 'y', -this.halfBorderWidth );
aRectElement.setAttribute( 'rx', this.halfBorderWidth );
aRectElement.setAttribute( 'ry', this.halfBorderWidth );
aRectElement.setAttribute( 'width', WIDTH + this.halfBorderWidth );
aRectElement.setAttribute( 'height', HEIGHT + this.halfBorderWidth );
aRectElement.setAttribute( 'stroke-width', this.borderWidth );
aRectElement.setAttribute( 'fill', 'none' );
aDefsElement.appendChild( aRectElement );

aRectElement = document.createElementNS( NSS['svg'], 'rect' );
aRectElement.setAttribute( 'id', this.thumbnailMouseAreaTemplateId );
aRectElement.setAttribute( 'x', 0 );
aRectElement.setAttribute( 'y', 0 );
aRectElement.setAttribute( 'width', WIDTH );
aRectElement.setAttribute( 'height', HEIGHT );
aRectElement.setAttribute( 'fill', this.pageBgColor );
aDefsElement.appendChild( aRectElement );

this.pageElement.appendChild( aDefsElement );

this.thumbnailMouseAreaTemplateElement = document.getElementById( this.thumbnailMouseAreaTemplateId );
this.thumbnailBorderTemplateElement = document.getElementById( this.thumbnailBorderTemplateId );
};

SlideIndexPage.prototype.decreaseNumberOfColumns  = function()
{
this.setNumberOfColumns( this.indexColumns - 1 );
};

SlideIndexPage.prototype.increaseNumberOfColumns  = function()
{
this.setNumberOfColumns( this.indexColumns + 1 );
};

SlideIndexPage.prototype.resetNumberOfColumns  = function()
{
this.setNumberOfColumns( INDEX_COLUMNS_DEFAULT );
};

SlideIndexPage.prototype.setNumberOfColumns  = function( nNumberOfColumns )
{
if( this.indexColumns == nNumberOfColumns )  return;
if( nNumberOfColumns < 2 || nNumberOfColumns > 6 ) return;

var suspendHandle = ROOT_NODE.suspendRedraw(500);

var nOldTotalThumbnails = this.totalThumbnails;
this.indexColumns = nNumberOfColumns;
this.totalThumbnails = nNumberOfColumns * nNumberOfColumns;

this.aThumbnailSet[this.curThumbnailIndex].unselect();

var i;
for( i = this.totalThumbnails; i < nOldTotalThumbnails; ++i )
{
this.aThumbnailSet[i].removeElement();
}

for( i = nOldTotalThumbnails; i < this.totalThumbnails; ++i )
{
this.aThumbnailSet[i] = new Thumbnail( this, i );
}

this.halfBorderWidthFactor = ( 300/28000 ) * ( this.indexColumns / 3 );
this.halfBorderWidth = WIDTH * this.halfBorderWidthFactor;
this.borderWidth = 2 * this.halfBorderWidth;
this.scaleFactor = ( 1 - ( this.indexColumns + 1 ) * this.xSpacingFactor ) /
( this.indexColumns * ( 1 + 2 * this.halfBorderWidthFactor ) );

var aRectElement = this.thumbnailBorderTemplateElement;
aRectElement.setAttribute( 'x', -this.halfBorderWidth );
aRectElement.setAttribute( 'y', -this.halfBorderWidth );
aRectElement.setAttribute( 'rx', this.halfBorderWidth );
aRectElement.setAttribute( 'ry', this.halfBorderWidth );
aRectElement.setAttribute( 'width', WIDTH + this.halfBorderWidth );
aRectElement.setAttribute( 'height', HEIGHT + this.halfBorderWidth );
aRectElement.setAttribute( 'stroke-width', this.borderWidth );

for( i = 0; i < this.totalThumbnails; ++i )
{
this.aThumbnailSet[i].updateView();
}

this.curThumbnailIndex = this.selectedSlideIndex % this.totalThumbnails;
this.aThumbnailSet[this.curThumbnailIndex].select();

INDEX_OFFSET = -1;
indexSetPageSlide( this.selectedSlideIndex );

ROOT_NODE.unsuspendRedraw( suspendHandle );
ROOT_NODE.forceRedraw();
};


function Thumbnail( aSlideIndexPage, nIndex )
{
this.container = aSlideIndexPage;
this.index = nIndex;//= getSafeIndex( nIndex, 0, this.container.getTotalThumbnails() );
this.pageElement = this.container.pageElement;
this.thumbnailId = 'thumbnail' + this.index;
this.thumbnailElement = this.createThumbnailElement();
this.slideElement = getElementByClassName( this.thumbnailElement, 'Slide' );
this.borderElement = getElementByClassName( this.thumbnailElement, 'Border' );
this.mouseAreaElement = getElementByClassName( this.thumbnailElement, 'MouseArea' );
this.aTransformSet = new Array( 3 );
this.visibility = VISIBLE;
this.isSelected = false;
}

Thumbnail.prototype.sNormalBorderColor = 'rgb(216,216,216)';
Thumbnail.prototype.sSelectionBorderColor = 'rgb(92,92,255)';

Thumbnail.prototype.removeElement = function()
{
if( this.thumbnailElement )
this.container.pageElement.removeChild( this.thumbnailElement );
};

Thumbnail.prototype.show = function()
{
if( this.visibility == HIDDEN )
{
this.thumbnailElement.setAttribute( 'display', 'inherit' );
this.visibility = VISIBLE;
}
};

Thumbnail.prototype.hide = function()
{
if( this.visibility == VISIBLE )
{
this.thumbnailElement.setAttribute( 'display', 'none' );
this.visibility = HIDDEN;
}
};

Thumbnail.prototype.select = function()
{
if( !this.isSelected )
{
this.borderElement.setAttribute( 'stroke', this.sSelectionBorderColor );
this.isSelected = true;
}
};

Thumbnail.prototype.unselect = function()
{
if( this.isSelected )
{
this.borderElement.setAttribute( 'stroke', this.sNormalBorderColor );
this.isSelected = false;
}
};

Thumbnail.prototype.updateView = function()
{
this.column = this.index % this.container.indexColumns;
this.row = ( this.index - this.column ) / this.container.indexColumns;
this.halfBorderWidth = this.container.halfBorderWidth;
this.borderWidth = this.container.borderWidth;
this.width = ( WIDTH + this.borderWidth ) * this.container.scaleFactor;
this.height = ( HEIGHT + this.borderWidth ) * this.container.scaleFactor;
this.aTransformSet[2] = 'translate(' + this.halfBorderWidth + ' ' + this.halfBorderWidth + ')';
this.aTransformSet[1] = 'scale(' + this.container.scaleFactor + ')';
var sTransformAttrValue = this.computeTransform();
this.thumbnailElement.setAttribute( 'transform', sTransformAttrValue );
this.mouseAreaElement.setAttribute( 'onmouseover', 'theSlideIndexPage.aThumbnailSet[' + this.index  + '].onMouseOver()' );
};

Thumbnail.prototype.update = function( nIndex )
{
if( this.slideIndex == nIndex )  return;

var aMetaSlide = theMetaDoc.aMetaSlideSet[nIndex];
aMetaSlide.updateMasterPageView();
setNSAttribute( 'xlink', this.slideElement, 'href', '#' + aMetaSlide.slideId );
this.slideIndex = nIndex;
};

Thumbnail.prototype.clear = function( nIndex )
{
setNSAttribute( 'xlink', this.slideElement, 'href', '' );
};

Thumbnail.prototype.createThumbnailElement = function()
{
var aThumbnailElement = document.createElementNS( NSS['svg'], 'g' );
aThumbnailElement.setAttribute( 'id', this.thumbnailId );
aThumbnailElement.setAttribute( 'display', 'inherit' );

var aSlideElement = document.createElementNS( NSS['svg'], 'use' );
setNSAttribute( 'xlink', aSlideElement, 'href', '' );
aSlideElement.setAttribute( 'class', 'Slide' );
aThumbnailElement.appendChild( aSlideElement );

var aMouseAreaElement = document.createElementNS( NSS['svg'], 'use' );
setNSAttribute( 'xlink', aMouseAreaElement, 'href', '#' + this.container.thumbnailMouseAreaTemplateId );
aMouseAreaElement.setAttribute( 'class', 'MouseArea' );
aMouseAreaElement.setAttribute( 'opacity', 0.0 );
aThumbnailElement.appendChild( aMouseAreaElement );

var aBorderElement = document.createElementNS( NSS['svg'], 'use' );
setNSAttribute( 'xlink', aBorderElement, 'href', '#' + this.container.thumbnailBorderTemplateId );
aBorderElement.setAttribute( 'stroke', this.sNormalBorderColor );
aBorderElement.setAttribute( 'class', 'Border' );
aThumbnailElement.appendChild( aBorderElement );

this.container.pageElement.appendChild( aThumbnailElement );
return( document.getElementById( this.thumbnailId ) );
};

Thumbnail.prototype.computeTransform = function()
{
var nXSpacing = this.container.xSpacing;
var nYSpacing = this.container.ySpacing;

var nXOffset = nXSpacing + ( this.width + nXSpacing ) * this.column;
var nYOffset = nYSpacing + ( this.height + nYSpacing ) * this.row;

this.aTransformSet[0] = 'translate(' + nXOffset + ' ' + nYOffset + ')';

var sTransform = this.aTransformSet.join( ' ' );

return sTransform;
};

Thumbnail.prototype.onMouseOver = function()
{
if( ( currentMode == INDEX_MODE ) && ( this.container.curThumbnailIndex !=  this.index ) )
{
this.container.setSelection( this.index );
}
};


function init()
{
var VIEWBOX = ROOT_NODE.getAttribute('viewBox');

if( VIEWBOX )
{
WIDTH = ROOT_NODE.viewBox.animVal.width;
HEIGHT = ROOT_NODE.viewBox.animVal.height;
}

aSlideShow = new SlideShow();
theMetaDoc =  new MetaDocument();
aSlideShow.bIsEnabled = theMetaDoc.bIsAnimated;
theSlideIndexPage = new SlideIndexPage();
aSlideShow.displaySlide( theMetaDoc.nStartSlideNumber, false );


}

function presentationEngineStop()
{
alert( 'We are sorry! An unexpected error occurred.\nThe presentation engine will be stopped' );
document.onkeydown = null;
document.onkeypress = null;
document.onclick = null;
window.onmousewheel = null;
}

function assert( condition, message )
{
if (!condition)
{
presentationEngineStop();
if (typeof console == 'object')
console.trace();
throw new Error( message );
}
}

function dispatchEffects(dir)
{

if( dir == 1 )
{
var bRet = aSlideShow.nextEffect();

if( !bRet )
{
switchSlide( 1, false );
}
}
else
{
switchSlide( dir, false );
}
}

function skipAllEffects()
{
var bRet = aSlideShow.skipAllEffects();
if( !bRet )
{
switchSlide( 1, true );
}
}

function skipEffects(dir)
{
if( dir == 1 )
{
var bRet = aSlideShow.skipPlayingOrNextEffect();

if( !bRet )
{
switchSlide( 1, true );
}
}
else
{
switchSlide( dir, true );
}
}

function switchSlide( nOffset, bSkipTransition )
{
var nNextSlide = nCurSlide + nOffset;
aSlideShow.displaySlide( nNextSlide, bSkipTransition );
}

function displayIndex( offsetNumber )
{
var aMetaSlideSet = theMetaDoc.aMetaSlideSet;
offsetNumber = getSafeIndex( offsetNumber, 0, aMetaSlideSet.length - 1 );

var nTotalThumbnails = theSlideIndexPage.getTotalThumbnails();
var nEnd = Math.min( offsetNumber + nTotalThumbnails, aMetaSlideSet.length);

var aThumbnailSet = theSlideIndexPage.aThumbnailSet;
var j = 0;
for( var i = offsetNumber; i < nEnd; ++i, ++j )
{
aThumbnailSet[j].update( i );
aThumbnailSet[j].show();
}
for( ; j < nTotalThumbnails; ++j )
{
aThumbnailSet[j].hide();
}

if (INDEX_OFFSET != offsetNumber)
INDEX_OFFSET = offsetNumber;
}

function toggleSlideIndex()
{

if( currentMode == SLIDE_MODE )
{

theMetaDoc.getCurrentSlide().hide();
INDEX_OFFSET = -1;
indexSetPageSlide( nCurSlide );
theSlideIndexPage.show();
currentMode = INDEX_MODE;
}
else if( currentMode == INDEX_MODE )
{
theSlideIndexPage.hide();
var nNewSlide = theSlideIndexPage.selectedSlideIndex;

aSlideShow.displaySlide( nNewSlide, true );
currentMode = SLIDE_MODE;
}

}

function abandonIndexMode()
{
theSlideIndexPage.selectedSlideIndex = nCurSlide;
toggleSlideIndex();
}


var CURR_UNIQUE_ID = 0;

function getUniqueId()
{
++CURR_UNIQUE_ID;
return CURR_UNIQUE_ID;
}

function mem_fn( sMethodName )
{
return  function( aObject )
{
var aMethod = aObject[ sMethodName ];
if( aMethod )
aMethod.call( aObject );
else
log( 'method sMethodName not found' );
};
}

function bind( aObject, aMethod )
{
return  function()
{
return aMethod.call( aObject, arguments[0] );
};
}

function bind2( aFunction )
{
if( !aFunction  )
log( 'bind2: passed function is not valid.' );

var aBoundArgList = arguments;

var aResultFunction = null;

switch( aBoundArgList.length )
{
case 1: aResultFunction = function()
{
return aFunction.call( arguments[0], arguments[1],
arguments[2], arguments[3],
arguments[4] );
};
break;
case 2: aResultFunction = function()
{
return aFunction.call( aBoundArgList[1], arguments[0],
arguments[1], arguments[2],
arguments[3] );
};
break;
case 3: aResultFunction = function()
{
return aFunction.call( aBoundArgList[1], aBoundArgList[2],
arguments[0], arguments[1],
arguments[2] );
};
break;
case 4: aResultFunction = function()
{
return aFunction.call( aBoundArgList[1], aBoundArgList[2],
aBoundArgList[3], arguments[0],
arguments[1] );
};
break;
case 5: aResultFunction = function()
{
return aFunction.call( aBoundArgList[1], aBoundArgList[2],
aBoundArgList[3], aBoundArgList[4],
arguments[0] );
};
break;
default:
log( 'bind2: arity not handled.' );
}

return aResultFunction;
}

function getCurrentSystemTime()
{
return ( new Date() ).getTime();
}

function getSlideAnimationsRoot( sSlideId )
{
return theMetaDoc.aSlideAnimationsMap[ sSlideId ];
}

function getElementChildren( aElement )
{
var aChildrenArray = [];

var nSize = aElement.childNodes.length;

for( var i = 0; i < nSize; ++i )
{
if( aElement.childNodes[i].nodeType == 1 )
aChildrenArray.push( aElement.childNodes[i] );
}

return aChildrenArray;
}

function removeWhiteSpaces( str )
{
if( !str )
return '';

var re = / */;
var aSplitString = str.split( re );
return aSplitString.join('');
}

function clamp( nValue, nMinimum, nMaximum )
{
if( nValue < nMinimum )
{
return nMinimum;
}
else if( nValue > nMaximum )
{
return nMaximum;
}
else
{
return nValue;
}
}

function makeMatrixString( a, b, c, d, e, f )
{
var s = 'matrix(';
s += a + ', ';
s += b + ', ';
s += c + ', ';
s += d + ', ';
s += e + ', ';
s += f + ')';

return s;
}

function matrixToString( aSVGMatrix )
{
return makeMatrixString( aSVGMatrix.a, aSVGMatrix.b, aSVGMatrix.c,
aSVGMatrix.d, aSVGMatrix.e, aSVGMatrix.f );
}


function numberParser( sValue )
{
if( sValue === '.' )
return undefined;
var reFloatNumber = /^[+-]?[0-9]*[.]?[0-9]*$/;

if( reFloatNumber.test( sValue ) )
return parseFloat( sValue );
else
return undefined;
}

function booleanParser( sValue )
{
sValue = sValue.toLowerCase();
if( sValue === 'true' )
return true;
else if( sValue === 'false' )
return false;
else
return undefined;
}

function colorParser( sValue )
{

function hsl( nHue, nSaturation, nLuminance )
{
return new HSLColor( nHue, nSaturation / 100, nLuminance / 100 );
}

function rgb( nRed, nGreen, nBlue )
{
return new RGBColor( nRed / 255, nGreen / 255, nBlue / 255 );
}

function prgb( nRed, nGreen, nBlue )
{
return new RGBColor( nRed / 100, nGreen / 100, nBlue / 100 );
}

var sCommaPattern = ' *[,] *';
var sIntegerPattern = '[+-]?[0-9]+';
var sHexDigitPattern = '[0-9A-Fa-f]';

var sHexColorPattern = '#(' + sHexDigitPattern + '{2})('
+ sHexDigitPattern + '{2})('
+ sHexDigitPattern + '{2})';

var sRGBIntegerPattern = 'rgb[(] *' + sIntegerPattern + sCommaPattern
+ sIntegerPattern + sCommaPattern
+ sIntegerPattern + ' *[)]';

var sRGBPercentPattern = 'rgb[(] *' + sIntegerPattern + '%' + sCommaPattern
+ sIntegerPattern + '%' + sCommaPattern
+ sIntegerPattern + '%' + ' *[)]';

var sHSLPercentPattern = 'hsl[(] *' + sIntegerPattern + sCommaPattern
+ sIntegerPattern + '%' + sCommaPattern
+ sIntegerPattern + '%' + ' *[)]';

var reHexColor = new RegExp( sHexColorPattern );
var reRGBInteger = new RegExp( sRGBIntegerPattern );
var reRGBPercent = new RegExp( sRGBPercentPattern );
var reHSLPercent = new RegExp( sHSLPercentPattern );

if( reHexColor.test( sValue ) )
{
var aRGBTriple = reHexColor.exec( sValue );

var nRed    = parseInt( aRGBTriple[1], 16 ) / 255;
var nGreen  = parseInt( aRGBTriple[2], 16 ) / 255;
var nBlue   = parseInt( aRGBTriple[3], 16 ) / 255;

return new RGBColor( nRed, nGreen, nBlue );
}
else if( reHSLPercent.test( sValue ) )
{
sValue = sValue.replace( '%', '' ).replace( '%', '' );
return eval( sValue );
}
else if( reRGBInteger.test( sValue ) )
{
return eval( sValue );
}
else if( reRGBPercent.test( sValue ) )
{
sValue = 'p' + sValue.replace( '%', '' ).replace( '%', '' ).replace( '%', '' );
return eval( sValue );
}
else
{
return null;
}
}


function RGBColor( nRed, nGreen, nBlue )
{
this.eColorSpace = COLOR_SPACE_RGB;
this.nRed = nRed;
this.nGreen = nGreen;
this.nBlue = nBlue;
}


RGBColor.prototype.clone = function()
{
return new RGBColor( this.nRed, this.nGreen, this.nBlue );
};

RGBColor.prototype.equal = function( aRGBColor )
{
return ( this.nRed == aRGBColor.nRed ) &&
( this.nGreen == aRGBColor.nGreen ) &&
( this.nBlue == aRGBColor.nBlue );
};

RGBColor.prototype.add = function( aRGBColor )
{
this.nRed += aRGBColor.nRed;
this.nGreen += aRGBColor.nGreen;
this.nBlue += aRGBColor.nBlue;
return this;
};

RGBColor.prototype.scale = function( aT )
{
this.nRed *= aT;
this.nGreen *= aT;
this.nBlue *= aT;
return this;
};

RGBColor.clamp = function( aRGBColor )
{
var aClampedRGBColor = new RGBColor( 0, 0, 0 );

aClampedRGBColor.nRed   = clamp( aRGBColor.nRed, 0.0, 1.0 );
aClampedRGBColor.nGreen = clamp( aRGBColor.nGreen, 0.0, 1.0 );
aClampedRGBColor.nBlue  = clamp( aRGBColor.nBlue, 0.0, 1.0 );

return aClampedRGBColor;
};

RGBColor.prototype.convertToHSL = function()
{
var nRed   = clamp( this.nRed, 0.0, 1.0 );
var nGreen = clamp( this.nGreen, 0.0, 1.0 );
var nBlue  = clamp( this.nBlue, 0.0, 1.0 );

var nMax = Math.max( nRed, nGreen, nBlue );
var nMin = Math.min( nRed, nGreen, nBlue );
var nDelta = nMax - nMin;

var nLuminance  = ( nMax + nMin ) / 2.0;
var nSaturation = 0.0;
var nHue = 0.0;
if( nDelta !== 0 )
{
nSaturation = ( nLuminance > 0.5 ) ?
( nDelta / ( 2.0 - nMax - nMin) ) :
( nDelta / ( nMax + nMin ) );

if( nRed == nMax )
nHue = ( nGreen - nBlue ) / nDelta;
else if( nGreen == nMax )
nHue = 2.0 + ( nBlue - nRed ) / nDelta;
else if( nBlue == nMax )
nHue = 4.0 + ( nRed - nGreen ) / nDelta;

nHue *= 60.0;

if( nHue < 0.0 )
nHue += 360.0;
}

return new HSLColor( nHue, nSaturation, nLuminance );

};

RGBColor.prototype.toString = function( bClamped )
{
var aRGBColor;
if( bClamped )
{
aRGBColor = RGBColor.clamp( this );
}
else
{
aRGBColor = this;
}

var nRed = Math.round( aRGBColor.nRed * 255 );
var nGreen = Math.round( aRGBColor.nGreen * 255 );
var nBlue = Math.round( aRGBColor.nBlue * 255 );

return ( 'rgb(' + nRed + ',' + nGreen + ',' + nBlue + ')' );
};

RGBColor.interpolate = function( aStartRGB , aEndRGB, nT )
{
var aResult = aStartRGB.clone();
var aTEndRGB = aEndRGB.clone();
aResult.scale( 1.0 - nT );
aTEndRGB.scale( nT );
aResult.add( aTEndRGB );

return aResult;
};


function HSLColor( nHue, nSaturation, nLuminance )
{
this.eColorSpace = COLOR_SPACE_HSL;
this.nHue = nHue;
this.nSaturation = nSaturation;
this.nLuminance = nLuminance;

this.normalizeHue();
}


HSLColor.prototype.clone = function()
{
return new HSLColor( this.nHue, this.nSaturation, this.nLuminance );
};

HSLColor.prototype.equal = function( aHSLColor )
{
return ( this.nHue == aHSLColor.nHue ) &&
( this.nSaturation += aHSLColor.nSaturation ) &&
( this.nLuminance += aHSLColor.nLuminance );
};

HSLColor.prototype.add = function( aHSLColor )
{
this.nHue += aHSLColor.nHue;
this.nSaturation += aHSLColor.nSaturation;
this.nLuminance += aHSLColor.nLuminance;
this.normalizeHue();
return this;
};

HSLColor.prototype.scale = function( aT )
{
this.nHue *= aT;
this.nSaturation *= aT;
this.nLuminance *= aT;
this.normalizeHue();
return this;
};

HSLColor.clamp = function( aHSLColor )
{
var aClampedHSLColor = new HSLColor( 0, 0, 0 );

aClampedHSLColor.nHue = aHSLColor.nHue % 360;
if( aClampedHSLColor.nHue < 0 )
aClampedHSLColor.nHue += 360;
aClampedHSLColor.nSaturation = clamp( aHSLColor.nSaturation, 0.0, 1.0 );
aClampedHSLColor.nLuminance = clamp( aHSLColor.nLuminance, 0.0, 1.0 );
};

HSLColor.prototype.normalizeHue = function()
{
this.nHue = this.nHue % 360;
if( this.nHue < 0 ) this.nHue += 360;
};

HSLColor.prototype.toString = function()
{
return 'hsl(' + this.nHue.toFixed( 3 ) + ','
+ this.nSaturation.toFixed( 3 ) + ','
+ this.nLuminance.toFixed( 3 ) + ')';
};

HSLColor.prototype.convertToRGB = function()
{

var nHue = this.nHue % 360;
if( nHue < 0 ) nHue += 360;
var nSaturation =  clamp( this.nSaturation, 0.0, 1.0 );
var nLuminance = clamp( this.nLuminance, 0.0, 1.0 );


if( nSaturation === 0 )
{
return new RGBColor( nLuminance, nLuminance, nLuminance );
}

var nVal1 = ( nLuminance <= 0.5 ) ?
( nLuminance * (1.0 + nSaturation) ) :
( nLuminance + nSaturation - nLuminance * nSaturation );

var nVal2 = 2.0 * nLuminance - nVal1;

var nRed    = HSLColor.hsl2rgbHelper( nVal2, nVal1, nHue + 120 );
var nGreen  = HSLColor.hsl2rgbHelper( nVal2, nVal1, nHue );
var nBlue   = HSLColor.hsl2rgbHelper( nVal2, nVal1, nHue - 120 );

return new RGBColor( nRed, nGreen, nBlue );
};

HSLColor.hsl2rgbHelper = function( nValue1, nValue2, nHue )
{
nHue = nHue % 360;
if( nHue < 0 )
nHue += 360;

if( nHue < 60.0 )
return nValue1 + ( nValue2 - nValue1 ) * nHue / 60.0;
else if( nHue < 180.0 )
return nValue2;
else if( nHue < 240.0 )
return ( nValue1 + ( nValue2 - nValue1 ) * ( 240.0 - nHue ) / 60.0 );
else
return nValue1;
};

HSLColor.interpolate = function( aFrom, aTo, nT, bCCW )
{
var nS = 1.0 - nT;

var nHue = 0.0;
if( aFrom.nHue <= aTo.nHue && !bCCW )
{
nHue = nS * (aFrom.nHue + 360.0) + nT * aTo.nHue;
}
else if( aFrom.nHue > aTo.nHue && bCCW )
{
nHue = nS * aFrom.nHue + nT * (aTo.nHue + 360.0);
}
else
{
nHue = nS * aFrom.nHue + nT * aTo.nHue;
}

var nSaturation = nS * aFrom.nSaturation + nT * aTo.nSaturation;
var nLuminance = nS * aFrom.nLuminance + nT * aTo.nLuminance;

return new HSLColor( nHue, nSaturation, nLuminance );
};


SVGIdentityMatrix = document.documentElement.createSVGMatrix();

SVGMatrix.prototype.setToIdentity = function()
{
this.a = this.d = 1;
this.b = this.c = this.d = this.e = 0;
};

SVGMatrix.prototype.setToRotationAroundPoint = function( nX, nY, nAngle )
{
nAngle = Math.PI * nAngle / 180;
var nSin = Math.sin( nAngle );
var nCos = Math.cos( nAngle );

this.a = nCos; this.c = -nSin; this.e = nX * (1 - nCos) + nY * nSin;
this.b = nSin; this.d =  nCos; this.f = nY * (1 - nCos) - nX * nSin;
};


SVGPathElement.prototype.prependPath = function( aPath )
{
var sPathData = aPath.getAttribute( 'd' );
sPathData += ( ' ' + this.getAttribute( 'd' ) );
this.setAttribute( 'd', sPathData );
};

SVGPathElement.prototype.appendPath = function( aPath )
{
var sPathData = this.getAttribute( 'd' );
sPathData += ( ' ' + aPath.getAttribute( 'd' ) );
this.setAttribute( 'd', sPathData );
};

SVGPathElement.prototype.matrixTransform = function( aSVGMatrix )
{
var aPathSegList = this.pathSegList;
var nLength = aPathSegList.numberOfItems;
var i;
for( i = 0; i < nLength; ++i )
{
aPathSegList.getItem( i ).matrixTransform( aSVGMatrix );
}
};

SVGPathElement.prototype.changeOrientation = function()
{
var aPathSegList = this.pathSegList;
var nLength = aPathSegList.numberOfItems;
if( nLength == 0 ) return;

var nCurrentX = 0;
var nCurrentY = 0;

var aPathSeg = aPathSegList.getItem( 0 );
if( aPathSeg.pathSegTypeAsLetter == 'M' )
{
nCurrentX = aPathSeg.x;
nCurrentY = aPathSeg.y;
aPathSegList.removeItem( 0 );
--nLength;
}

var i;
for( i = 0; i < nLength; ++i )
{
aPathSeg = aPathSegList.getItem( i );
var aPoint = aPathSeg.changeOrientation( nCurrentX, nCurrentY );
nCurrentX = aPoint.x;
nCurrentY = aPoint.y;
}


for( i = nLength - 2; i >= 0; --i )
{
aPathSeg = aPathSegList.removeItem( i );
aPathSegList.appendItem( aPathSeg );
}

var aMovePathSeg = this.createSVGPathSegMovetoAbs( nCurrentX, nCurrentY );
aPathSegList.insertItemBefore( aMovePathSeg, 0 );

};


var SVGPathSeg = typeof SVGPathSeg === 'undefined' ? function() {} : SVGPathSeg;

try
{   // Firefox, Google Chrome, Internet Explorer, Safari.

SVGPathSegMovetoAbs.prototype.matrixTransform = function( aSVGMatrix )
{
SVGPathMatrixTransform( this, aSVGMatrix );
};

SVGPathSegLinetoAbs.prototype.matrixTransform = function( aSVGMatrix )
{
SVGPathMatrixTransform( this, aSVGMatrix );
};

SVGPathSegCurvetoQuadraticAbs.prototype.matrixTransform = function( aSVGMatrix )
{
SVGPathMatrixTransform( this, aSVGMatrix );
var nX = this.x1;
this.x1 = aSVGMatrix.a * nX + aSVGMatrix.c * this.y1 + aSVGMatrix.e;
this.y1 = aSVGMatrix.b * nX + aSVGMatrix.d * this.y1 + aSVGMatrix.f;
};

SVGPathSegCurvetoCubicAbs.prototype.matrixTransform = function( aSVGMatrix )
{
SVGPathMatrixTransform( this, aSVGMatrix );
var nX = this.x1;
this.x1 = aSVGMatrix.a * nX + aSVGMatrix.c * this.y1 + aSVGMatrix.e;
this.y1 = aSVGMatrix.b * nX + aSVGMatrix.d * this.y1 + aSVGMatrix.f;
nX = this.x2;
this.x2 = aSVGMatrix.a * nX + aSVGMatrix.c * this.y2 + aSVGMatrix.e;
this.y2 = aSVGMatrix.b * nX + aSVGMatrix.d * this.y2 + aSVGMatrix.f;
};


SVGPathSegMovetoAbs.prototype.changeOrientation = function( nCurrentX, nCurrentY )
{
var aPoint = { x: this.x, y: this.y };
this.x = nCurrentX;
this.y = nCurrentY;
return aPoint;
};

SVGPathSegLinetoAbs.prototype.changeOrientation = function( nCurrentX, nCurrentY )
{
var aPoint = { x: this.x, y: this.y };
this.x = nCurrentX;
this.y = nCurrentY;
return aPoint;
};

SVGPathSegCurvetoQuadraticAbs.prototype.changeOrientation = function( nCurrentX, nCurrentY )
{
var aPoint = { x: this.x, y: this.y };
this.x = nCurrentX;
this.y = nCurrentY;
return aPoint;
};

SVGPathSegCurvetoCubicAbs.prototype.changeOrientation = function( nCurrentX, nCurrentY )
{
var aPoint = { x: this.x, y: this.y };
this.x = nCurrentX;
this.y = nCurrentY;
var nX = this.x1;
this.x1 = this.x2;
this.x2 = nX;
var nY = this.y1;
this.y1 = this.y2;
this.y2 = nY;
return aPoint;
};

}
catch( e )
{   // Opera

if( e.name == 'ReferenceError' )
{
SVGPathSeg.prototype.matrixTransform = function( aSVGMatrix )
{
var nX;
switch( this.pathSegTypeAsLetter )
{
case 'C':
nX = this.x2;
this.x2 = aSVGMatrix.a * nX + aSVGMatrix.c * this.y2 + aSVGMatrix.e;
this.y2 = aSVGMatrix.b * nX + aSVGMatrix.d * this.y2 + aSVGMatrix.f;
case 'Q':
nX = this.x1;
this.x1 = aSVGMatrix.a * nX + aSVGMatrix.c * this.y1 + aSVGMatrix.e;
this.y1 = aSVGMatrix.b * nX + aSVGMatrix.d * this.y1 + aSVGMatrix.f;
case 'M':
case 'L':
SVGPathMatrixTransform( this, aSVGMatrix );
break;
default:
log( 'SVGPathSeg.matrixTransform: unexpected path segment type: '
+ this.pathSegTypeAsLetter );
}
};

SVGPathSeg.prototype.changeOrientation = function( nCurrentX, nCurrentY )
{
switch( this.pathSegTypeAsLetter )
{
case 'C':
var nX = this.x1;
this.x1 = this.x2;
this.x2 = nX;
var nY = this.y1;
this.y1 = this.y2;
this.y2 = nY;
case 'M':
case 'L':
case 'Q':
var aPoint = { x: this.x, y: this.y };
this.x = nCurrentX;
this.y = nCurrentY;
return aPoint;
default:
log( 'SVGPathSeg.changeOrientation: unexpected path segment type: '
+ this.pathSegTypeAsLetter );
return null;
}
}
}
else throw e;
}

function SVGPathMatrixTransform( aPath, aSVGMatrix )
{
var nX = aPath.x;
aPath.x = aSVGMatrix.a * nX + aSVGMatrix.c * aPath.y + aSVGMatrix.e;
aPath.y = aSVGMatrix.b * nX + aSVGMatrix.d * aPath.y + aSVGMatrix.f;
}


function PriorityQueue( aCompareFunc )
{
this.aSequence = [];
this.aCompareFunc = aCompareFunc;
}

PriorityQueue.prototype.clone = function()
{
var aCopy = new PriorityQueue( this.aCompareFunc );
var src = this.aSequence;
var dest = [];
var i, l;
for( i = 0, l = src.length; i < l; ++i )
{
if( i in src )
{
dest.push( src[i] );
}
}
aCopy.aSequence = dest;
return aCopy;
};

PriorityQueue.prototype.top = function()
{
return this.aSequence[this.aSequence.length - 1];
};

PriorityQueue.prototype.isEmpty = function()
{
return ( this.aSequence.length === 0 );
};

PriorityQueue.prototype.push = function( aValue )
{
this.aSequence.unshift( aValue );
this.aSequence.sort(this.aCompareFunc);
};

PriorityQueue.prototype.clear = function()
{
this.aSequence = [];
};

PriorityQueue.prototype.pop = function()
{
return this.aSequence.pop();
};


var ANIMATION_NODE_CUSTOM               = 0;
var ANIMATION_NODE_PAR                  = 1;
var ANIMATION_NODE_SEQ                  = 2;
var ANIMATION_NODE_ITERATE              = 3;
var ANIMATION_NODE_ANIMATE              = 4;
var ANIMATION_NODE_SET                  = 5;
var ANIMATION_NODE_ANIMATEMOTION        = 6;
var ANIMATION_NODE_ANIMATECOLOR         = 7;
var ANIMATION_NODE_ANIMATETRANSFORM     = 8;
var ANIMATION_NODE_TRANSITIONFILTER     = 9;
var ANIMATION_NODE_AUDIO                = 10;
var ANIMATION_NODE_COMMAND              = 11;

aAnimationNodeTypeInMap = {
'par'               : ANIMATION_NODE_PAR,
'seq'               : ANIMATION_NODE_SEQ,
'iterate'           : ANIMATION_NODE_ITERATE,
'animate'           : ANIMATION_NODE_ANIMATE,
'set'               : ANIMATION_NODE_SET,
'animatemotion'     : ANIMATION_NODE_ANIMATEMOTION,
'animatecolor'      : ANIMATION_NODE_ANIMATECOLOR,
'animatetransform'  : ANIMATION_NODE_ANIMATETRANSFORM,
'transitionfilter'  : ANIMATION_NODE_TRANSITIONFILTER,
'audio'             : ANIMATION_NODE_AUDIO,
'command'           : ANIMATION_NODE_COMMAND
};


function getAnimationElementType( aElement )
{
var sName = aElement.localName.toLowerCase();

if( sName && aAnimationNodeTypeInMap[ sName ] )
return aAnimationNodeTypeInMap[ sName ];
else
return ANIMATION_NODE_CUSTOM;
}


var INVALID_NODE                = 0;
var UNRESOLVED_NODE             = 1;
var RESOLVED_NODE               = 2;
var ACTIVE_NODE                 = 4;
var FROZEN_NODE                 = 8;
var ENDED_NODE                  = 16;

function getNodeStateName( eNodeState )
{
switch( eNodeState )
{
case INVALID_NODE:
return 'INVALID';
case UNRESOLVED_NODE:
return 'UNRESOLVED';
case RESOLVED_NODE:
return 'RESOLVED';
case ACTIVE_NODE:
return 'ACTIVE';
case FROZEN_NODE:
return 'FROZEN';
case ENDED_NODE:
return 'ENDED';
default:
return 'UNKNOWN';
}
}


IMPRESS_DEFAULT_NODE                    = 0;
IMPRESS_ON_CLICK_NODE                   = 1;
IMPRESS_WITH_PREVIOUS_NODE              = 2;
IMPRESS_AFTER_PREVIOUS_NODE             = 3;
IMPRESS_MAIN_SEQUENCE_NODE              = 4;
IMPRESS_TIMING_ROOT_NODE                = 5;
IMPRESS_INTERACTIVE_SEQUENCE_NODE       = 6;

aImpressNodeTypeInMap = {
'on-click'                  : IMPRESS_ON_CLICK_NODE,
'with-previous'             : IMPRESS_WITH_PREVIOUS_NODE,
'after-previous'            : IMPRESS_AFTER_PREVIOUS_NODE,
'main-sequence'             : IMPRESS_MAIN_SEQUENCE_NODE,
'timing-root'               : IMPRESS_TIMING_ROOT_NODE,
'interactive-sequence'      : IMPRESS_INTERACTIVE_SEQUENCE_NODE
};

aImpressNodeTypeOutMap = [ 'default', 'on-click', 'with-previous', 'after-previous',
'main-sequence', 'timing-root', 'interactive-sequence' ];


aPresetClassInMap = {};


aPresetIdInMap = {};


var RESTART_MODE_DEFAULT            = 0;
var RESTART_MODE_INHERIT            = 0;
var RESTART_MODE_ALWAYS             = 1;
var RESTART_MODE_WHEN_NOT_ACTIVE    = 2;
var RESTART_MODE_NEVER              = 3;

aRestartModeInMap = {
'inherit'       : RESTART_MODE_DEFAULT,
'always'        : RESTART_MODE_ALWAYS,
'whenNotActive' : RESTART_MODE_WHEN_NOT_ACTIVE,
'never'         : RESTART_MODE_NEVER
};

aRestartModeOutMap = [ 'inherit','always', 'whenNotActive', 'never' ];


var FILL_MODE_DEFAULT           = 0;
var FILL_MODE_INHERIT           = 0;
var FILL_MODE_REMOVE            = 1;
var FILL_MODE_FREEZE            = 2;
var FILL_MODE_HOLD              = 3;
var FILL_MODE_TRANSITION        = 4;
var FILL_MODE_AUTO              = 5;

aFillModeInMap = {
'inherit'       : FILL_MODE_DEFAULT,
'remove'        : FILL_MODE_REMOVE,
'freeze'        : FILL_MODE_FREEZE,
'hold'          : FILL_MODE_HOLD,
'transition'    : FILL_MODE_TRANSITION,
'auto'          : FILL_MODE_AUTO
};

aFillModeOutMap = [ 'inherit', 'remove', 'freeze', 'hold', 'transition', 'auto' ];


var ADDITIVE_MODE_BASE          = 0;
var ADDITIVE_MODE_SUM           = 1;
var ADDITIVE_MODE_REPLACE       = 2;
var ADDITIVE_MODE_MULTIPLY      = 3;
var ADDITIVE_MODE_NONE          = 4;

aAddittiveModeInMap = {
'base'          : ADDITIVE_MODE_BASE,
'sum'           : ADDITIVE_MODE_SUM,
'replace'       : ADDITIVE_MODE_REPLACE,
'multiply'      : ADDITIVE_MODE_MULTIPLY,
'none'          : ADDITIVE_MODE_NONE
};

aAddittiveModeOutMap = [ 'base', 'sum', 'replace', 'multiply', 'none' ];


var ACCUMULATE_MODE_NONE        = 0;
var ACCUMULATE_MODE_SUM         = 1;

aAccumulateModeOutMap = [ 'none', 'sum' ];

var CALC_MODE_DISCRETE          = 0;
var CALC_MODE_LINEAR            = 1;
var CALC_MODE_PACED             = 2;
var CALC_MODE_SPLINE            = 3;

aCalcModeInMap = {
'discrete'      : CALC_MODE_DISCRETE,
'linear'        : CALC_MODE_LINEAR,
'paced'         : CALC_MODE_PACED,
'spline'        : CALC_MODE_SPLINE
};

aCalcModeOutMap = [ 'discrete', 'linear', 'paced', 'spline' ];


var COLOR_SPACE_RGB = 0;
var COLOR_SPACE_HSL = 1;

aColorSpaceInMap = { 'rgb': COLOR_SPACE_RGB, 'hsl': COLOR_SPACE_HSL };

aColorSpaceOutMap = [ 'rgb', 'hsl' ];


var CLOCKWISE               = 0;
var COUNTERCLOCKWISE        = 1;

aClockDirectionInMap = { 'clockwise': CLOCKWISE, 'counter-clockwise': COUNTERCLOCKWISE };

aClockDirectionOutMap = [ 'clockwise', 'counter-clockwise' ];


UNKNOWN_PROPERTY        = 0;
NUMBER_PROPERTY         = 1;
ENUM_PROPERTY           = 2;
COLOR_PROPERTY          = 3;
STRING_PROPERTY         = 4;
BOOL_PROPERTY           = 5;

aValueTypeOutMap = [ 'unknown', 'number', 'enum', 'color', 'string', 'boolean' ];


var aAttributeMap =
{
'height':           {   'type':         NUMBER_PROPERTY,
'get':          'getHeight',
'set':          'setHeight',
'getmod':       'makeScaler( 1/nHeight )',
'setmod':       'makeScaler( nHeight)'          },

'opacity':          {   'type':         NUMBER_PROPERTY,
'get':          'getOpacity',
'set':          'setOpacity'                    },

'width':            {   'type':         NUMBER_PROPERTY,
'get':          'getWidth',
'set':          'setWidth',
'getmod':       'makeScaler( 1/nWidth )',
'setmod':       'makeScaler( nWidth)'           },

'x':                {   'type':         NUMBER_PROPERTY,
'get':          'getX',
'set':          'setX',
'getmod':       'makeScaler( 1/nWidth )',
'setmod':       'makeScaler( nWidth)'           },

'y':                {   'type':         NUMBER_PROPERTY,
'get':          'getY',
'set':          'setY',
'getmod':       'makeScaler( 1/nHeight )',
'setmod':       'makeScaler( nHeight)'          },

'fill':             {   'type':         ENUM_PROPERTY,
'get':          'getFillStyle',
'set':          'setFillStyle'                  },

'stroke':           {   'type':         ENUM_PROPERTY,
'get':          'getStrokeStyle',
'set':          'setStrokeStyle'                },

'visibility':       {   'type':         ENUM_PROPERTY,
'get':          'getVisibility',
'set':          'setVisibility'                 },

'fill-color':       {   'type':         COLOR_PROPERTY,
'get':          'getFillColor',
'set':          'setFillColor'                  },

'stroke-color':     {   'type':         COLOR_PROPERTY,
'get':          'getStrokeColor',
'set':          'setStrokeColor'                },

'color':            {   'type':         COLOR_PROPERTY,
'get':          'getFontColor',
'set':          'setFontColor'                  }

};


TRANSITION_INVALID              = 0;    // Invalid type
TRANSITION_CLIP_POLYPOLYGON     = 1;    // Transition expressed by parametric clip polygon
TRANSITION_SPECIAL              = 2;    // Transition expressed by hand-crafted function

aTransitionClassOutMap = ['invalid', 'clip polypolygon', 'special'];


BARWIPE_TRANSITION          = 1;
BOXWIPE_TRANSITION          = 2;
FOURBOXWIPE_TRANSITION      = 3;
ELLIPSEWIPE_TRANSITION      = 4; // 17
CLOCKWIPE_TRANSITION        = 5; // 22
PINWHEELWIPE_TRANSITION     = 6; // 23
PUSHWIPE_TRANSITION         = 7; // 35
SLIDEWIPE_TRANSITION        = 8; // 36
FADE_TRANSITION             = 9; // 37
RANDOMBARWIPE_TRANSITION    = 10; // 38
CHECKERBOARDWIPE_TRANSITION = 11; // 39
DISSOLVE_TRANSITION         = 12; // 40

aTransitionTypeInMap = {
'barWipe'           : BARWIPE_TRANSITION,
'boxWipe'           : BOXWIPE_TRANSITION,
'fourBoxWipe'       : FOURBOXWIPE_TRANSITION,
'ellipseWipe'       : ELLIPSEWIPE_TRANSITION,
'clockWipe'         : CLOCKWIPE_TRANSITION,
'pinWheelWipe'      : PINWHEELWIPE_TRANSITION,
'pushWipe'          : PUSHWIPE_TRANSITION,
'slideWipe'         : SLIDEWIPE_TRANSITION,
'fade'              : FADE_TRANSITION,
'randomBarWipe'     : RANDOMBARWIPE_TRANSITION,
'checkerBoardWipe'  : CHECKERBOARDWIPE_TRANSITION,
'dissolve'          : DISSOLVE_TRANSITION
};

aTransitionTypeOutMap = [ '', 'barWipe', 'boxWipe', 'fourBoxWipe', 'ellipseWipe',
'clockWipe', 'pinWheelWipe', 'pushWipe', 'slideWipe',
'fade', 'randomBarWipe', 'checkerBoardWipe', 'dissolve' ];


DEFAULT_TRANS_SUBTYPE               = 0;
LEFTTORIGHT_TRANS_SUBTYPE           = 1;
TOPTOBOTTOM_TRANS_SUBTYPE           = 2;
CORNERSIN_TRANS_SUBTYPE             = 3; // 11
CORNERSOUT_TRANS_SUBTYPE            = 4;
VERTICAL_TRANS_SUBTYPE              = 5;
HORIZONTAL_TRANS_SUBTYPE            = 6; // 14
DOWN_TRANS_SUBTYPE                  = 7; // 19
CIRCLE_TRANS_SUBTYPE                = 8; // 27
CLOCKWISETWELVE_TRANS_SUBTYPE       = 9; // 33
CLOCKWISETHREE_TRANS_SUBTYPE        = 10;
CLOCKWISESIX_TRANS_SUBTYPE          = 11;
CLOCKWISENINE_TRANS_SUBTYPE         = 12;
TWOBLADEVERTICAL_TRANS_SUBTYPE      = 13;
TWOBLADEHORIZONTAL_TRANS_SUBTYPE    = 14;
FOURBLADE_TRANS_SUBTYPE             = 15; // 39
FROMLEFT_TRANS_SUBTYPE              = 16; // 97
FROMTOP_TRANS_SUBTYPE               = 17;
FROMRIGHT_TRANS_SUBTYPE             = 18;
FROMBOTTOM_TRANS_SUBTYPE            = 19;
CROSSFADE_TRANS_SUBTYPE             = 20;
FADETOCOLOR_TRANS_SUBTYPE           = 21;
FADEFROMCOLOR_TRANS_SUBTYPE         = 22;
FADEOVERCOLOR_TRANS_SUBTYPE         = 23;
THREEBLADE_TRANS_SUBTYPE            = 24;
EIGHTBLADE_TRANS_SUBTYPE            = 25;
ONEBLADE_TRANS_SUBTYPE              = 26; // 107
ACROSS_TRANS_SUBTYPE                = 27;

aTransitionSubtypeInMap = {
'default'           : DEFAULT_TRANS_SUBTYPE,
'leftToRight'       : LEFTTORIGHT_TRANS_SUBTYPE,
'topToBottom'       : TOPTOBOTTOM_TRANS_SUBTYPE,
'cornersIn'         : CORNERSIN_TRANS_SUBTYPE,
'cornersOut'        : CORNERSOUT_TRANS_SUBTYPE,
'vertical'          : VERTICAL_TRANS_SUBTYPE,
'horizontal'        : HORIZONTAL_TRANS_SUBTYPE,
'down'              : DOWN_TRANS_SUBTYPE,
'circle'            : CIRCLE_TRANS_SUBTYPE,
'clockwiseTwelve'   : CLOCKWISETWELVE_TRANS_SUBTYPE,
'clockwiseThree'    : CLOCKWISETHREE_TRANS_SUBTYPE,
'clockwiseSix'      : CLOCKWISESIX_TRANS_SUBTYPE,
'clockwiseNine'     : CLOCKWISENINE_TRANS_SUBTYPE,
'twoBladeVertical'  : TWOBLADEVERTICAL_TRANS_SUBTYPE,
'twoBladeHorizontal': TWOBLADEHORIZONTAL_TRANS_SUBTYPE,
'fourBlade'         : FOURBLADE_TRANS_SUBTYPE,
'fromLeft'          : FROMLEFT_TRANS_SUBTYPE,
'fromTop'           : FROMTOP_TRANS_SUBTYPE,
'fromRight'         : FROMRIGHT_TRANS_SUBTYPE,
'fromBottom'        : FROMBOTTOM_TRANS_SUBTYPE,
'crossfade'         : CROSSFADE_TRANS_SUBTYPE,
'fadeToColor'       : FADETOCOLOR_TRANS_SUBTYPE,
'fadeFromColor'     : FADEFROMCOLOR_TRANS_SUBTYPE,
'fadeOverColor'     : FADEOVERCOLOR_TRANS_SUBTYPE,
'threeBlade'        : THREEBLADE_TRANS_SUBTYPE,
'eightBlade'        : EIGHTBLADE_TRANS_SUBTYPE,
'oneBlade'          : ONEBLADE_TRANS_SUBTYPE,
'across'            : ACROSS_TRANS_SUBTYPE
};

aTransitionSubtypeOutMap = [ 'default', 'leftToRight', 'topToBottom', 'cornersIn',
'cornersOut', 'vertical', 'horizontal', 'down', 'circle',
'clockwiseTwelve', 'clockwiseThree', 'clockwiseSix',
'clockwiseNine', 'twoBladeVertical', 'twoBladeHorizontal',
'fourBlade', 'fromLeft', 'fromTop', 'fromRight',
'fromBottom', 'crossfade', 'fadeToColor', 'fadeFromColor',
'fadeOverColor', 'threeBlade', 'eightBlade', 'oneBlade',
'across' ];


TRANSITION_MODE_IN  = 1;
TRANSITION_MODE_OUT = 0;

aTransitionModeInMap = { 'out': TRANSITION_MODE_OUT, 'in': TRANSITION_MODE_IN };
aTransitionModeOutMap = [ 'out', 'in' ];


REVERSEMETHOD_IGNORE                    = 0;
REVERSEMETHOD_INVERT_SWEEP              = 1;
REVERSEMETHOD_SUBTRACT_POLYGON          = 2;
REVERSEMETHOD_SUBTRACT_AND_INVERT       = 3;
REVERSEMETHOD_ROTATE_180                = 4;
REVERSEMETHOD_FLIP_X                    = 5;
REVERSEMETHOD_FLIP_Y                    = 6;

aReverseMethodOutMap = ['ignore', 'invert sweep', 'subtract polygon',
'subtract and invert', 'rotate 180', 'flip x', 'flip y'];


var aTransitionInfoTable = {};

aTransitionInfoTable[0] = {};
aTransitionInfoTable[0][0] =
{
'class' : TRANSITION_INVALID,
'rotationAngle' : 0.0,
'scaleX' : 0.0,
'scaleY' : 0.0,
'reverseMethod' : REVERSEMETHOD_IGNORE,
'outInvertsSweep' : false,
'scaleIsotropically' : false
};


aTransitionInfoTable[BARWIPE_TRANSITION] = {};
aTransitionInfoTable[BARWIPE_TRANSITION][LEFTTORIGHT_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 0.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_FLIP_X,
'outInvertsSweep' : false,
'scaleIsotropically' : false
};
aTransitionInfoTable[BARWIPE_TRANSITION][TOPTOBOTTOM_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 90.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_FLIP_Y,
'outInvertsSweep' : false,
'scaleIsotropically' : false
};

aTransitionInfoTable[FOURBOXWIPE_TRANSITION] = {};
aTransitionInfoTable[FOURBOXWIPE_TRANSITION][CORNERSIN_TRANS_SUBTYPE] =
aTransitionInfoTable[FOURBOXWIPE_TRANSITION][CORNERSOUT_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 0.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_SUBTRACT_AND_INVERT,
'outInvertsSweep' : true,
'scaleIsotropically' : false
};

aTransitionInfoTable[ELLIPSEWIPE_TRANSITION] = {};
aTransitionInfoTable[ELLIPSEWIPE_TRANSITION][CIRCLE_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 0.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_SUBTRACT_AND_INVERT,
'outInvertsSweep' : true,
'scaleIsotropically' : true
};
aTransitionInfoTable[ELLIPSEWIPE_TRANSITION][HORIZONTAL_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 0.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_SUBTRACT_AND_INVERT,
'outInvertsSweep' : true,
'scaleIsotropically' : false
};
aTransitionInfoTable[ELLIPSEWIPE_TRANSITION][VERTICAL_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 90.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_SUBTRACT_AND_INVERT,
'outInvertsSweep' : true,
'scaleIsotropically' : false
};

aTransitionInfoTable[CLOCKWIPE_TRANSITION] = {};
aTransitionInfoTable[CLOCKWIPE_TRANSITION][CLOCKWISETWELVE_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 0.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_FLIP_X,
'outInvertsSweep' : true,
'scaleIsotropically' : false
};
aTransitionInfoTable[CLOCKWIPE_TRANSITION][CLOCKWISETHREE_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 90.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_FLIP_Y,
'outInvertsSweep' : true,
'scaleIsotropically' : false
};
aTransitionInfoTable[CLOCKWIPE_TRANSITION][CLOCKWISESIX_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 180.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_FLIP_X,
'outInvertsSweep' : true,
'scaleIsotropically' : false
};
aTransitionInfoTable[CLOCKWIPE_TRANSITION][CLOCKWISENINE_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 270.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_FLIP_Y,
'outInvertsSweep' : true,
'scaleIsotropically' : false
};

aTransitionInfoTable[PINWHEELWIPE_TRANSITION] = {};
aTransitionInfoTable[PINWHEELWIPE_TRANSITION][ONEBLADE_TRANS_SUBTYPE] =
aTransitionInfoTable[PINWHEELWIPE_TRANSITION][TWOBLADEVERTICAL_TRANS_SUBTYPE] =
aTransitionInfoTable[PINWHEELWIPE_TRANSITION][THREEBLADE_TRANS_SUBTYPE] =
aTransitionInfoTable[PINWHEELWIPE_TRANSITION][FOURBLADE_TRANS_SUBTYPE] =
aTransitionInfoTable[PINWHEELWIPE_TRANSITION][EIGHTBLADE_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 0.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_FLIP_X,
'outInvertsSweep' : true,
'scaleIsotropically' : true
};
aTransitionInfoTable[PINWHEELWIPE_TRANSITION][TWOBLADEHORIZONTAL_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : -90.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_FLIP_Y,
'outInvertsSweep' : true,
'scaleIsotropically' : true
};

aTransitionInfoTable[PUSHWIPE_TRANSITION] = {};
aTransitionInfoTable[PUSHWIPE_TRANSITION][FROMLEFT_TRANS_SUBTYPE] =
aTransitionInfoTable[PUSHWIPE_TRANSITION][FROMTOP_TRANS_SUBTYPE] =
aTransitionInfoTable[PUSHWIPE_TRANSITION][FROMRIGHT_TRANS_SUBTYPE] =
aTransitionInfoTable[PUSHWIPE_TRANSITION][FROMBOTTOM_TRANS_SUBTYPE] =
{
'class' : TRANSITION_SPECIAL,
'rotationAngle' : 0.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_IGNORE,
'outInvertsSweep' : true,
'scaleIsotropically' : false
};

aTransitionInfoTable[SLIDEWIPE_TRANSITION] = {};
aTransitionInfoTable[SLIDEWIPE_TRANSITION][FROMLEFT_TRANS_SUBTYPE] =
aTransitionInfoTable[SLIDEWIPE_TRANSITION][FROMTOP_TRANS_SUBTYPE] =
aTransitionInfoTable[SLIDEWIPE_TRANSITION][FROMRIGHT_TRANS_SUBTYPE] =
aTransitionInfoTable[SLIDEWIPE_TRANSITION][FROMBOTTOM_TRANS_SUBTYPE] =
{
'class' : TRANSITION_SPECIAL,
'rotationAngle' : 0.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_IGNORE,
'outInvertsSweep' : true,
'scaleIsotropically' : false
};

aTransitionInfoTable[FADE_TRANSITION] = {};
aTransitionInfoTable[FADE_TRANSITION][CROSSFADE_TRANS_SUBTYPE] =
aTransitionInfoTable[FADE_TRANSITION][FADETOCOLOR_TRANS_SUBTYPE] =
aTransitionInfoTable[FADE_TRANSITION][FADEFROMCOLOR_TRANS_SUBTYPE] =
aTransitionInfoTable[FADE_TRANSITION][FADEOVERCOLOR_TRANS_SUBTYPE] =
{
'class' : TRANSITION_SPECIAL,
'rotationAngle' : 0.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_IGNORE,
'outInvertsSweep' : true,
'scaleIsotropically' : false
};


aTransitionInfoTable[RANDOMBARWIPE_TRANSITION] = {};
aTransitionInfoTable[RANDOMBARWIPE_TRANSITION][VERTICAL_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 90.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_IGNORE,
'outInvertsSweep' : true,
'scaleIsotropically' : false
};
aTransitionInfoTable[RANDOMBARWIPE_TRANSITION][HORIZONTAL_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 0.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_IGNORE,
'outInvertsSweep' : true,
'scaleIsotropically' : false
};

aTransitionInfoTable[CHECKERBOARDWIPE_TRANSITION] = {};
aTransitionInfoTable[CHECKERBOARDWIPE_TRANSITION][DOWN_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 90.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_FLIP_Y,
'outInvertsSweep' : true,
'scaleIsotropically' : false
};
aTransitionInfoTable[CHECKERBOARDWIPE_TRANSITION][ACROSS_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 0.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_FLIP_X,
'outInvertsSweep' : true,
'scaleIsotropically' : false
};

aTransitionInfoTable[DISSOLVE_TRANSITION] = {};
aTransitionInfoTable[DISSOLVE_TRANSITION][DEFAULT_TRANS_SUBTYPE] =
{
'class' : TRANSITION_CLIP_POLYPOLYGON,
'rotationAngle' : 0.0,
'scaleX' : 1.0,
'scaleY' : 1.0,
'reverseMethod' : REVERSEMETHOD_IGNORE,
'outInvertsSweep' : true,
'scaleIsotropically' : true
};


function createStateTransitionTable()
{
var aSTT = {};

aSTT[RESTART_MODE_NEVER] = {};
aSTT[RESTART_MODE_WHEN_NOT_ACTIVE] = {};
aSTT[RESTART_MODE_ALWAYS] = {};

var aTable =
aSTT[RESTART_MODE_NEVER][FILL_MODE_REMOVE] = {};
aTable[INVALID_NODE]        = INVALID_NODE;
aTable[UNRESOLVED_NODE]     = RESOLVED_NODE | ENDED_NODE;
aTable[RESOLVED_NODE]       = ACTIVE_NODE | ENDED_NODE;
aTable[ACTIVE_NODE]         = ENDED_NODE;
aTable[FROZEN_NODE]         = INVALID_NODE;  // this state is unreachable here
aTable[ENDED_NODE]          = ENDED_NODE;    // this state is a sink here (cannot restart)

aTable =
aSTT[RESTART_MODE_NEVER][FILL_MODE_FREEZE] =
aSTT[RESTART_MODE_NEVER][FILL_MODE_HOLD] =
aSTT[RESTART_MODE_NEVER][FILL_MODE_TRANSITION] = {};
aTable[INVALID_NODE]        = INVALID_NODE;
aTable[UNRESOLVED_NODE]     = RESOLVED_NODE | ENDED_NODE;
aTable[RESOLVED_NODE]       = ACTIVE_NODE | ENDED_NODE;
aTable[ACTIVE_NODE]         = FROZEN_NODE | ENDED_NODE;
aTable[FROZEN_NODE]         = ENDED_NODE;
aTable[ENDED_NODE]          = ENDED_NODE;   // this state is a sink here (cannot restart)

aTable =
aSTT[RESTART_MODE_WHEN_NOT_ACTIVE][FILL_MODE_REMOVE] = {};
aTable[INVALID_NODE]        = INVALID_NODE;
aTable[UNRESOLVED_NODE]     = RESOLVED_NODE | ENDED_NODE;
aTable[RESOLVED_NODE]       = ACTIVE_NODE | ENDED_NODE;
aTable[ACTIVE_NODE]         = ENDED_NODE;
aTable[FROZEN_NODE]         = INVALID_NODE;  // this state is unreachable here
aTable[ENDED_NODE]          = RESOLVED_NODE | ACTIVE_NODE | ENDED_NODE;  // restart is possible

aTable =
aSTT[RESTART_MODE_WHEN_NOT_ACTIVE][FILL_MODE_FREEZE] =
aSTT[RESTART_MODE_WHEN_NOT_ACTIVE][FILL_MODE_HOLD] =
aSTT[RESTART_MODE_WHEN_NOT_ACTIVE][FILL_MODE_TRANSITION] = {};
aTable[INVALID_NODE]        = INVALID_NODE;
aTable[UNRESOLVED_NODE]     = RESOLVED_NODE | ENDED_NODE;
aTable[RESOLVED_NODE]       = ACTIVE_NODE | ENDED_NODE;
aTable[ACTIVE_NODE]         = FROZEN_NODE | ENDED_NODE;
aTable[FROZEN_NODE]         = RESOLVED_NODE | ACTIVE_NODE | ENDED_NODE;  // restart is possible
aTable[ENDED_NODE]          = RESOLVED_NODE | ACTIVE_NODE | ENDED_NODE;  // restart is possible

aTable =
aSTT[RESTART_MODE_ALWAYS][FILL_MODE_REMOVE] = {};
aTable[INVALID_NODE]        = INVALID_NODE;
aTable[UNRESOLVED_NODE]     = RESOLVED_NODE | ENDED_NODE;
aTable[RESOLVED_NODE]       = ACTIVE_NODE | ENDED_NODE;
aTable[ACTIVE_NODE]         = RESOLVED_NODE | ACTIVE_NODE | ENDED_NODE;  // restart is possible
aTable[FROZEN_NODE]         = INVALID_NODE;  // this state is unreachable here
aTable[ENDED_NODE]          = RESOLVED_NODE | ACTIVE_NODE | ENDED_NODE;  // restart is possible

aTable =
aSTT[RESTART_MODE_ALWAYS][FILL_MODE_FREEZE] =
aSTT[RESTART_MODE_ALWAYS][FILL_MODE_HOLD] =
aSTT[RESTART_MODE_ALWAYS][FILL_MODE_TRANSITION] = {};
aTable[INVALID_NODE]        = INVALID_NODE;
aTable[UNRESOLVED_NODE]     = RESOLVED_NODE | ENDED_NODE;
aTable[RESOLVED_NODE]       = ACTIVE_NODE | ENDED_NODE;
aTable[ACTIVE_NODE]         = RESOLVED_NODE | ACTIVE_NODE | FROZEN_NODE | ENDED_NODE;
aTable[FROZEN_NODE]         = RESOLVED_NODE | ACTIVE_NODE | ENDED_NODE;  // restart is possible
aTable[ENDED_NODE]          = RESOLVED_NODE | ACTIVE_NODE | ENDED_NODE;  // restart is possible

return aSTT;
}

var aStateTransitionTable = createStateTransitionTable();


function getTransitionTable( eRestartMode, eFillMode )
{
if( eRestartMode == RESTART_MODE_DEFAULT )
{
log( 'getTransitionTable: unexpected restart mode: ' + eRestartMode
+ '. Used NEVER instead.');
eRestartMode = RESTART_MODE_NEVER;
}

if( eFillMode == FILL_MODE_DEFAULT ||
eFillMode == FILL_MODE_AUTO )
{
eFillMode = FILL_MODE_REMOVE;
}

return aStateTransitionTable[eRestartMode][eFillMode];
}


var EVENT_TRIGGER_UNKNOWN               = 0;
var EVENT_TRIGGER_ON_SLIDE_BEGIN        = 1;
var EVENT_TRIGGER_ON_SLIDE_END          = 2;
var EVENT_TRIGGER_BEGIN_EVENT           = 3;
var EVENT_TRIGGER_END_EVENT             = 4;
var EVENT_TRIGGER_ON_CLICK              = 5;
var EVENT_TRIGGER_ON_DBL_CLICK          = 6;
var EVENT_TRIGGER_ON_MOUSE_ENTER        = 7;
var EVENT_TRIGGER_ON_MOUSE_LEAVE        = 8;
var EVENT_TRIGGER_ON_NEXT_EFFECT        = 9;
var EVENT_TRIGGER_ON_PREV_EFFECT        = 10;
var EVENT_TRIGGER_REPEAT                = 11;

aEventTriggerOutMap = [ 'unknown', 'slideBegin', 'slideEnd', 'begin', 'end', 'click',
'doubleClick', 'mouseEnter', 'mouseLeave', 'next', 'previous', 'repeat' ];


function getEventTriggerType( sEventTrigger )
{
if( sEventTrigger == 'begin' )
return EVENT_TRIGGER_BEGIN_EVENT;
else if( sEventTrigger == 'end' )
return EVENT_TRIGGER_END_EVENT;
else if( sEventTrigger == 'next' )
return EVENT_TRIGGER_ON_NEXT_EFFECT;
else if( sEventTrigger == 'prev' )
return EVENT_TRIGGER_ON_PREV_EFFECT;
else if( sEventTrigger == 'click' )
return EVENT_TRIGGER_ON_CLICK;
else
return EVENT_TRIGGER_UNKNOWN;
}


var UNKNOWN_TIMING          = 0;
var OFFSET_TIMING           = 1;
var WALLCLOCK_TIMING        = 2;
var INDEFINITE_TIMING       = 3;
var EVENT_TIMING            = 4;
var SYNCBASE_TIMING         = 5;
var MEDIA_TIMING            = 6;

aTimingTypeOutMap = [ 'unknown', 'offset', 'wallclock', 'indefinite', 'event', 'syncbase', 'media' ];


var CHARCODE_PLUS       = '+'.charCodeAt(0);
var CHARCODE_MINUS      = '-'.charCodeAt(0);
var CHARCODE_0          = '0'.charCodeAt(0);
var CHARCODE_9          = '9'.charCodeAt(0);


function Timing( aAnimationNode, sTimingAttribute )
{
this.aAnimationNode = aAnimationNode;     // the node, the timing attribute belongs to
this.sTimingDescription = removeWhiteSpaces( sTimingAttribute );
this.eTimingType = UNKNOWN_TIMING;
this.nOffset = 0.0;                       // in seconds
this.sEventBaseElementId = '';            // the element id for event based timing
this.eEventType = EVENT_TRIGGER_UNKNOWN;  // the event type
}

Timing.prototype.getAnimationNode = function()
{
return this.aAnimationNode;
};

Timing.prototype.getType = function()
{
return this.eTimingType;
};

Timing.prototype.getOffset = function()
{
return this.nOffset;
};

Timing.prototype.getEventBaseElementId = function()
{
return this.sEventBaseElementId;
};

Timing.prototype.getEventType = function()
{
return this.eEventType;
};

Timing.prototype.parse = function()
{
if( !this.sTimingDescription )
{
this.eTimingType = OFFSET_TIMING;
return;
}

if( this.sTimingDescription == 'indefinite' )
this.eTimingType = INDEFINITE_TIMING;
else
{
var nFirstCharCode = this.sTimingDescription.charCodeAt(0);
var bPositiveOffset = !( nFirstCharCode == CHARCODE_MINUS );
if ( ( nFirstCharCode == CHARCODE_PLUS ) ||
( nFirstCharCode == CHARCODE_MINUS ) ||
( ( nFirstCharCode >= CHARCODE_0 ) && ( nFirstCharCode <= CHARCODE_9 ) ) )
{
var sClockValue
= ( ( nFirstCharCode == CHARCODE_PLUS ) || ( nFirstCharCode == CHARCODE_MINUS ) )
? this.sTimingDescription.substr( 1 )
: this.sTimingDescription;

var TimeInSec = Timing.parseClockValue( sClockValue );
if( TimeInSec != undefined )
{
this.eTimingType = OFFSET_TIMING;
this.nOffset = bPositiveOffset ? TimeInSec : -TimeInSec;
}
}
else
{
var aTimingSplit = [];
bPositiveOffset = true;
if( this.sTimingDescription.indexOf( '+' ) != -1 )
{
aTimingSplit = this.sTimingDescription.split( '+' );
}
else if( this.sTimingDescription.indexOf( '-' ) != -1 )
{
aTimingSplit = this.sTimingDescription.split( '-' );
bPositiveOffset = false;
}
else
{
aTimingSplit[0] = this.sTimingDescription;
aTimingSplit[1] = '';
}

if( aTimingSplit[0].indexOf( '.' ) != -1 )
{
var aEventSplit = aTimingSplit[0].split( '.' );
this.sEventBaseElementId = aEventSplit[0];
this.eEventType = getEventTriggerType( aEventSplit[1] );
}
else
{
this.eEventType = getEventTriggerType( aTimingSplit[0] );
}

if( this.eEventType == EVENT_TRIGGER_UNKNOWN )
return;

if( ( this.eEventType == EVENT_TRIGGER_BEGIN_EVENT ) ||
( this.eEventType == EVENT_TRIGGER_END_EVENT ) )
{
this.eTimingType = SYNCBASE_TIMING;
}
else
{
this.eTimingType = EVENT_TIMING;
}

if( aTimingSplit[1] )
{
sClockValue = aTimingSplit[1];
TimeInSec = Timing.parseClockValue( sClockValue );
if( TimeInSec != undefined )
{
this.nOffset = ( bPositiveOffset ) ? TimeInSec : -TimeInSec;
}
else
{
this.eTimingType = UNKNOWN_TIMING;
}

}
}
}

};

Timing.parseClockValue = function( sClockValue )
{
if( !sClockValue )
return 0.0;

var nTimeInSec = undefined;

var reFullClockValue = /^([0-9]+):([0-5][0-9]):([0-5][0-9])(.[0-9]+)?$/;
var rePartialClockValue = /^([0-5][0-9]):([0-5][0-9])(.[0-9]+)?$/;
var reTimeCountValue = /^([0-9]+)(.[0-9]+)?(h|min|s|ms)?$/;

if( reFullClockValue.test( sClockValue ) )
{
var aClockTimeParts = reFullClockValue.exec( sClockValue );

var nHours = parseInt( aClockTimeParts[1] );
var nMinutes = parseInt( aClockTimeParts[2] );
var nSeconds = parseInt( aClockTimeParts[3] );
if( aClockTimeParts[4] )
nSeconds += parseFloat( aClockTimeParts[4] );

nTimeInSec = ( ( nHours * 60 ) +  nMinutes ) * 60 + nSeconds;

}
else if( rePartialClockValue.test( sClockValue ) )
{
aClockTimeParts = rePartialClockValue.exec( sClockValue );

nMinutes = parseInt( aClockTimeParts[1] );
nSeconds = parseInt( aClockTimeParts[2] );
if( aClockTimeParts[3] )
nSeconds += parseFloat( aClockTimeParts[3] );

nTimeInSec = nMinutes * 60 + nSeconds;
}
else if( reTimeCountValue.test( sClockValue ) )
{
aClockTimeParts = reTimeCountValue.exec( sClockValue );

var nTimeCount = parseInt( aClockTimeParts[1] );
if( aClockTimeParts[2] )
nTimeCount += parseFloat( aClockTimeParts[2] );

if( aClockTimeParts[3] )
{
if( aClockTimeParts[3] == 'h' )
{
nTimeInSec = nTimeCount * 3600;
}
else if( aClockTimeParts[3] == 'min' )
{
nTimeInSec = nTimeCount * 60;
}
else if( aClockTimeParts[3] == 's' )
{
nTimeInSec = nTimeCount;
}
else if( aClockTimeParts[3] == 'ms' )
{
nTimeInSec = nTimeCount / 1000;
}
}
else
{
nTimeInSec = nTimeCount;
}

}

if( nTimeInSec )
nTimeInSec = parseFloat( nTimeInSec.toFixed( 3 ) );
return nTimeInSec;
};

Timing.prototype.info = function( bVerbose )
{

var sInfo = '';

if( bVerbose )
{
sInfo = 'description: ' + this.sTimingDescription + ', ';

sInfo += ', type: ' +  aTimingTypeOutMap[ this.getType() ];
sInfo += ', offset: ' + this.getOffset();
sInfo += ', event base element id: ' + this.getEventBaseElementId();
sInfo += ', timing event type: ' + aEventTriggerOutMap[ this.getEventType() ];
}
else
{
switch( this.getType() )
{
case INDEFINITE_TIMING:
sInfo += 'indefinite';
break;
case OFFSET_TIMING:
sInfo += this.getOffset();
break;
case EVENT_TIMING:
case SYNCBASE_TIMING:
if( this.getEventBaseElementId() )
sInfo += this.getEventBaseElementId() + '.';
sInfo += aEventTriggerOutMap[ this.getEventType() ];
if( this.getOffset() )
{
if( this.getOffset() > 0 )
sInfo += '+';
sInfo += this.getOffset();
}
}
}

return sInfo;
};


function Duration( sDurationAttribute )
{
this.bIndefinite = false;
this.bMedia = false;
this.nValue = undefined;
this.bDefined = false;

if( !sDurationAttribute )
return;

if( sDurationAttribute == 'indefinite' )
this.bIndefinite = true;
else if( sDurationAttribute == 'media' )
this.bMedia = true;
else
{
this.nValue = Timing.parseClockValue( sDurationAttribute );
if( this.nValue <= 0.0 )
this.nValue = 0.001;  // duration must be always greater than 0
}
this.bDefined = true;
}


Duration.prototype.isSet = function()
{
return this.bDefined;
};

Duration.prototype.isIndefinite = function()
{
return this.bIndefinite;
};

Duration.prototype.isMedia = function()
{
return this.bMedia;
};

Duration.prototype.isValue = function()
{
return this.nValue != undefined;
};

Duration.prototype.getValue= function()
{
return this.nValue;
};

Duration.prototype.info= function()
{
var sInfo;

if( this.isIndefinite() )
sInfo = 'indefinite';
else if( this.isMedia() )
sInfo = 'media';
else if( this.getValue() )
sInfo = this.getValue();

return sInfo;
};


function AnimationNode()
{
}

AnimationNode.prototype.init = function() {};
AnimationNode.prototype.resolve = function() {};
AnimationNode.prototype.activate = function() {};
AnimationNode.prototype.deactivate = function() {};
AnimationNode.prototype.end = function() {};
AnimationNode.prototype.getState = function() {};
AnimationNode.prototype.registerDeactivatingListener = function() {};
AnimationNode.prototype.notifyDeactivating = function() {};


function NodeContext( aSlideShowContext )
{
this.aContext = aSlideShowContext;
this.aAnimationNodeMap = null;
this.aAnimatedElementMap = null;
this.aSourceEventElementMap = null;
this.nStartDelay = 0.0;
this.bFirstRun = undefined;
this.aSlideHeight = HEIGHT;
this.aSlideWidth = WIDTH;
}


NodeContext.prototype.makeSourceEventElement = function( sId, aEventBaseElem )
{
if( !aEventBaseElem )
{
log( 'NodeContext.makeSourceEventElement: event base element is not valid' );
return null;
}

if( !this.aContext.aEventMultiplexer )
{
log( 'NodeContext.makeSourceEventElement: event multiplexer not initialized' );
return null;
}

if( !this.aSourceEventElementMap[ sId ] )
{
this.aSourceEventElementMap[ sId ] = new SourceEventElement( sId, aEventBaseElem, this.aContext.aEventMultiplexer );
}
return this.aSourceEventElementMap[ sId ];
};


function StateTransition( aBaseNode )
{
this.aNode = aBaseNode;
this.eToState = INVALID_NODE;
}

StateTransition.prototype.enter = function( eNodeState, bForce )
{
if( !bForce ) bForce = false;

if( this.eToState != INVALID_NODE )
{
log( 'StateTransition.enter: commit() before enter()ing again!' );
return false;
}
if( !bForce && !this.aNode.isTransition( this.aNode.getState(), eNodeState  ) )
return false;

if( ( this.aNode.nCurrentStateTransition & eNodeState ) != 0 )
return false; // already in wanted transition

this.aNode.nCurrentStateTransition |= eNodeState;
this.eToState = eNodeState;
return true;
};

StateTransition.prototype.commit = function()
{
if( this.eToState != INVALID_NODE )
{
this.aNode.eCurrentState = this.eToState;
this.clear();
}
};

StateTransition.prototype.clear = function()
{
if( this.eToState != INVALID_NODE )
{
this.aNode.nCurrentStateTransition &= ~this.eToState;
this.eToState = INVALID_NODE;
}
};


function BaseNode( aAnimElem, aParentNode, aNodeContext )
{
this.nId = getUniqueId();
this.sClassName = 'BaseNode';

if( !aAnimElem )
log( 'BaseNode(id:' + this.nId + ') constructor: aAnimElem is not valid' );

if( !aNodeContext )
log( 'BaseNode(id:' + this.nId + ') constructor: aNodeContext is not valid' );

if( !aNodeContext.aContext )
log( 'BaseNode(id:' + this.nId + ') constructor: aNodeContext.aContext is not valid' );


this.bIsContainer = false;
this.aElement = aAnimElem;
this.aParentNode = aParentNode;
this.aNodeContext = aNodeContext;
this.aContext = aNodeContext.aContext;
this.nStartDelay = aNodeContext.nStartDelay;
this.eCurrentState = UNRESOLVED_NODE;
this.nCurrentStateTransition = 0;
this.aDeactivatingListenerArray = [];
this.aActivationEvent = null;
this.aDeactivationEvent = null;

this.aBegin = null;
this.aDuration = null;
this.aEnd = null;
this.bMainSequenceRootNode = false;
this.bInteractiveSequenceRootNode = false;
this.eFillMode = FILL_MODE_FREEZE;
this.eRestartMode = RESTART_MODE_NEVER;
this.nReapeatCount = undefined;
this.nAccelerate = 0.0;
this.nDecelerate = 0.0;
this.bAutoReverse = false;

}
extend( BaseNode, AnimationNode );


BaseNode.prototype.getId = function()
{
return this.nId;
};

BaseNode.prototype.parseElement = function()
{
var aAnimElem = this.aElement;

var sIdAttr = aAnimElem.getAttributeNS( NSS['xml'], 'id' );
if( sIdAttr )
this.aNodeContext.aAnimationNodeMap[ sIdAttr ] = this;

this.aBegin = null;
var sBeginAttr = aAnimElem.getAttributeNS( NSS['smil'], 'begin' );
this.aBegin = new Timing( this, sBeginAttr );
this.aBegin.parse();

this.aEnd = null;
var sEndAttr = aAnimElem.getAttributeNS( NSS['smil'], 'end' );
if( sEndAttr )
{
this.aEnd = new Timing( this, sEndAttr );
this.aEnd.parse();
}

this.aDuration = null;
var sDurAttr = aAnimElem.getAttributeNS( NSS['smil'], 'dur' );
this.aDuration = new Duration( sDurAttr );
if( !this.aDuration.isSet() )
{
if( this.isContainer() )
this.aDuration = null;
else
this.aDuration = new Duration( 'indefinite' );
}

var sFillAttr = aAnimElem.getAttributeNS( NSS['smil'], 'fill' );
if( sFillAttr && aFillModeInMap[ sFillAttr ])
this.eFillMode = aFillModeInMap[ sFillAttr ];
else
this.eFillMode = FILL_MODE_DEFAULT;

var sRestartAttr = aAnimElem.getAttributeNS( NSS['smil'], 'restart' );
if( sRestartAttr && aRestartModeInMap[ sRestartAttr ] )
this.eRestartMode = aRestartModeInMap[ sRestartAttr ];
else
this.eRestartMode = RESTART_MODE_DEFAULT;

var sRepeatCount = aAnimElem.getAttributeNS( NSS['smil'], 'repeatCount' );
if( !sRepeatCount )
this.nReapeatCount = 1;
else
this.nReapeatCount = parseFloat( sRepeatCount );
if( ( isNaN(this.nReapeatCount) ) && ( sRepeatCount != 'indefinite' ) )
this.nReapeatCount = 1;

this.nAccelerate = 0.0;
var sAccelerateAttr = aAnimElem.getAttributeNS( NSS['smil'], 'accelerate' );
if( sAccelerateAttr )
this.nAccelerate = parseFloat( sAccelerateAttr );
if( isNaN(this.nAccelerate) )
this.nAccelerate = 0.0;

this.nDecelerate = 0.0;
var sDecelerateAttr = aAnimElem.getAttributeNS( NSS['smil'], 'decelerate' );
if( sDecelerateAttr )
this.nDecelerate = parseFloat( sDecelerateAttr );
if( isNaN(this.nDecelerate) )
this.nDecelerate = 0.0;

this.bAutoreverse = false;
var sAutoReverseAttr = aAnimElem.getAttributeNS( NSS['smil'], 'autoReverse' );
if( sAutoReverseAttr == 'true' )
this.bAutoreverse = true;


if( this.eFillMode == FILL_MODE_DEFAULT )
if( this.getParentNode() )
this.eFillMode = this.getParentNode().getFillMode();
else
this.eFillMode = FILL_MODE_AUTO;

if( this.eFillMode ==  FILL_MODE_AUTO ) // see SMIL recommendation document
{
this.eFillMode = ( this.aEnd ||
( this.nReapeatCount != 1) ||
( this.aDuration && !this.aDuration.isIndefinite() ) )
? FILL_MODE_REMOVE
: FILL_MODE_FREEZE;
}

if( this.eRestartMode == RESTART_MODE_DEFAULT )
if( this.getParentNode() )
this.eRestartMode = this.getParentNode().getRestartMode();
else
this.eRestartMode = RESTART_MODE_ALWAYS;

if( ( this.nAccelerate + this.nDecelerate ) > 1.0 )
{
this.nAccelerate = 0.0;
this.nDecelerate = 0.0;
}

this.aStateTransTable = getTransitionTable( this.getRestartMode(), this.getFillMode() );

return true;
};

BaseNode.prototype.getParentNode = function()
{
return this.aParentNode;
};

BaseNode.prototype.init = function()
{
this.DBG( this.callInfo( 'init' ) );
if( ! this.checkValidNode() )
return false;
if( this.aActivationEvent )
this.aActivationEvent.dispose();
if( this.aDeactivationEvent )
this.aDeactivationEvent.dispose();

this.eCurrentState = UNRESOLVED_NODE;

return this.init_st();
};

BaseNode.prototype.resolve = function()
{
if( ! this.checkValidNode() )
return false;

this.DBG( this.callInfo( 'resolve' ) );

if( this.eCurrentState == RESOLVED_NODE )
log( 'BaseNode.resolve: already in RESOLVED state' );

var aStateTrans = new StateTransition( this );

if( aStateTrans.enter( RESOLVED_NODE ) &&
this.isTransition( RESOLVED_NODE, ACTIVE_NODE ) &&
this.resolve_st() )
{
aStateTrans.commit();

if( this.aActivationEvent )
{
this.aActivationEvent.charge();
}
else
{
this.aActivationEvent = makeDelay( bind( this, this.activate ), this.getBegin().getOffset() + this.nStartDelay );
}
registerEvent( this.getId(), this.getBegin(), this.aActivationEvent, this.aNodeContext );

return true;
}

return false;
};

BaseNode.prototype.activate = function()
{
if( ! this.checkValidNode() )
return false;

if( this.eCurrentState == ACTIVE_NODE )
log( 'BaseNode.activate: already in ACTIVE state' );

this.DBG( this.callInfo( 'activate' ), getCurrentSystemTime() );

var aStateTrans = new StateTransition( this );

if( aStateTrans.enter( ACTIVE_NODE ) )
{
this.activate_st();
aStateTrans.commit();
if( !this.aContext.aEventMultiplexer )
log( 'BaseNode.activate: this.aContext.aEventMultiplexer is not valid' );
this.aContext.aEventMultiplexer.notifyEvent( EVENT_TRIGGER_BEGIN_EVENT, this.getId() );
return true;
}
return false;
};

BaseNode.prototype.deactivate = function()
{
if( this.inStateOrTransition( ENDED_NODE | FROZEN_NODE ) || !this.checkValidNode() )
return;

if( this.isTransition( this.eCurrentState, FROZEN_NODE ) )
{
this.DBG( this.callInfo( 'deactivate' ), getCurrentSystemTime() );

var aStateTrans = new StateTransition( this );
if( aStateTrans.enter( FROZEN_NODE, true /* FORCE */ ) )
{
this.deactivate_st( FROZEN_NODE );
aStateTrans.commit();

this.notifyEndListeners();

if( this.aActivationEvent )
this.aActivationEvent.dispose();
if( this.aDeactivationEvent )
this.aDeactivationEvent.dispose();
}
}
else
{
this.end();
}
};

BaseNode.prototype.end = function()
{
var bIsFrozenOrInTransitionToFrozen = this.inStateOrTransition( FROZEN_NODE );
if( this.inStateOrTransition( ENDED_NODE ) || !this.checkValidNode() )
return;

if( !(this.isTransition( this.eCurrentState, ENDED_NODE ) ) )
log( 'BaseNode.end: end state not reachable in transition table' );

this.DBG( this.callInfo( 'end' ), getCurrentSystemTime() );

var aStateTrans = new StateTransition( this );
if( aStateTrans.enter( ENDED_NODE, true /* FORCE */ ) )
{
this.deactivate_st( ENDED_NODE );
aStateTrans.commit();

if( !bIsFrozenOrInTransitionToFrozen )
this.notifyEndListeners();

if( this.aActivationEvent )
this.aActivationEvent.dispose();
if( this.aDeactivationEvent )
this.aDeactivationEvent.dispose();
}
};

BaseNode.prototype.dispose = function()
{
if( this.aActivationEvent )
this.aActivationEvent.dispose();
if( this.aDeactivationEvent )
this.aDeactivationEvent.dispose();
this.aDeactivatingListenerArray = [];
};

BaseNode.prototype.getState = function()
{
return this.eCurrentState;
};

BaseNode.prototype.registerDeactivatingListener = function( aNotifiee )
{
if (! this.checkValidNode())
return false;

if( !aNotifiee )
{
log( 'BaseNode.registerDeactivatingListener(): invalid notifee' );
return false;
}
this.aDeactivatingListenerArray.push( aNotifiee );

return true;
};

BaseNode.prototype.notifyDeactivating = function( aNotifier )
{
assert( ( aNotifier.getState() == FROZEN_NODE ) || ( aNotifier.getState() == ENDED_NODE ),
'BaseNode.notifyDeactivating: Notifier node is neither in FROZEN nor in ENDED state' );
};

BaseNode.prototype.isMainSequenceRootNode = function()
{
return this.bMainSequenceRootNode;
};

BaseNode.prototype.isInteractiveSequenceRootNode = function()
{
return this.bInteractiveSequenceRootNode;
};

BaseNode.prototype.makeDeactivationEvent = function( nDelay )
{
if( this.aDeactivationEvent )
{
this.aDeactivationEvent.charge();
}
else
{
if( typeof( nDelay ) == typeof(0) )
this.aDeactivationEvent = makeDelay( bind( this, this.deactivate ), nDelay );
else
this.aDeactivationEvent = null;
}
return this.aDeactivationEvent;
};

BaseNode.prototype.scheduleDeactivationEvent = function( aEvent )
{
this.DBG( this.callInfo( 'scheduleDeactivationEvent' ) );

if( !aEvent )
{
if( this.getDuration() && this.getDuration().isValue() )
aEvent = this.makeDeactivationEvent( this.getDuration().getValue() );
}
if( aEvent )
{
this.aContext.aTimerEventQueue.addEvent( aEvent );
}
};

BaseNode.prototype.checkValidNode = function()
{
return ( this.eCurrentState != INVALID_NODE );
};

BaseNode.prototype.init_st = function()
{
return true;
};

BaseNode.prototype.resolve_st = function()
{
return true;
};

BaseNode.prototype.activate_st = function()
{
this.scheduleDeactivationEvent();
};

BaseNode.prototype.deactivate_st = function( aNodeState )
{
};

BaseNode.prototype.notifyEndListeners = function()
{
var nDeactivatingListenerCount = this.aDeactivatingListenerArray.length;

for( var i = 0; i < nDeactivatingListenerCount; ++i )
{
this.aDeactivatingListenerArray[i].notifyDeactivating( this );
}

this.aContext.aEventMultiplexer.notifyEvent( EVENT_TRIGGER_END_EVENT, this.getId() );
if( this.getParentNode() && this.getParentNode().isMainSequenceRootNode() )
this.aContext.aEventMultiplexer.notifyNextEffectEndEvent();
};

BaseNode.prototype.getContext = function()
{
return this.aContext;
};

BaseNode.prototype.isTransition = function( eFromState, eToState )
{
return ( ( this.aStateTransTable[ eFromState ] & eToState ) != 0 );
};

BaseNode.prototype.inStateOrTransition = function( nMask )
{
return ( ( ( this.eCurrentState & nMask ) != 0 ) || ( ( this.nCurrentStateTransition & nMask ) != 0 ) );
};

BaseNode.prototype.isContainer = function()
{
return this.bIsContainer;
};

BaseNode.prototype.getBegin = function()
{
return this.aBegin;
};

BaseNode.prototype.getDuration = function()
{
return this.aDuration;
};

BaseNode.prototype.getEnd = function()
{
return this.aEnd;
};

BaseNode.prototype.getFillMode = function()
{
return this.eFillMode;
};

BaseNode.prototype.getRestartMode = function()
{
return this.eRestartMode;
};

BaseNode.prototype.getRepeatCount = function()
{
return this.nReapeatCount;
};

BaseNode.prototype.getAccelerateValue = function()
{
return this.nAccelerate;
};

BaseNode.prototype.getDecelerateValue = function()
{
return this.nDecelerate;
};

BaseNode.prototype.isAutoReverseEnabled = function()
{
return this.bAutoreverse;
};

BaseNode.prototype.info = function( bVerbose )
{
var sInfo = 'class name: ' + this.sClassName;
sInfo += ';  element name: ' + this.aElement.localName;
sInfo += ';  id: ' + this.getId();
sInfo += ';  state: ' + getNodeStateName( this.getState() );

if( bVerbose )
{
sInfo += ';  is container: ' + this.isContainer();

if( this.getBegin() )
sInfo += ';  begin: ' + this.getBegin().info();

if( this.getDuration() )
sInfo += ';  dur: ' + this.getDuration().info();

if( this.getEnd() )
sInfo += ';  end: ' + this.getEnd().info();

if( this.getFillMode() )
sInfo += ';  fill: ' + aFillModeOutMap[ this.getFillMode() ];

if( this.getRestartMode() )
sInfo += ';  restart: ' + aRestartModeOutMap[ this.getRestartMode() ];

if( this.getRepeatCount() && ( this.getRepeatCount() != 1.0 ) )
sInfo += ';  repeatCount: ' + this.getRepeatCount();

if( this.getAccelerateValue() )
sInfo += ';  accelerate: ' + this.getAccelerateValue();

if( this.getDecelerateValue() )
sInfo += ';  decelerate: ' + this.getDecelerateValue();

if( this.isAutoReverseEnabled() )
sInfo += ';  autoReverse: true';

}

return sInfo;
};

BaseNode.prototype.callInfo = function( sMethodName )
{
var sInfo = this.sClassName +
'( ' + this.getId() +
', ' + getNodeStateName( this.getState() ) +
' ).' + sMethodName;
return sInfo;
};

BaseNode.prototype.DBG = function( sMessage, nTime )
{
ANIMDBG.print( sMessage, nTime );
};


function AnimationBaseNode( aAnimElem, aParentNode, aNodeContext )
{
AnimationBaseNode.superclass.constructor.call( this, aAnimElem, aParentNode, aNodeContext );

this.sClassName = 'AnimationBaseNode';
this.bIsContainer = false;
this.aTargetElement = null;
this.bIsTargetTextElement = false;
this.aAnimatedElement = null;
this.aActivity = null;

this.nMinFrameCount = undefined;
this.eAdditiveMode = undefined;

}
extend( AnimationBaseNode, BaseNode );


AnimationBaseNode.prototype.parseElement = function()
{
var bRet = AnimationBaseNode.superclass.parseElement.call( this );

var aAnimElem = this.aElement;

this.aTargetElement = null;
var sTargetElementAttr = aAnimElem.getAttributeNS( NSS['smil'], 'targetElement' );
if( sTargetElementAttr )
this.aTargetElement = document.getElementById( sTargetElementAttr );

if( !this.aTargetElement )
{
this.eCurrentState = INVALID_NODE;
log( 'AnimationBaseNode.parseElement: target element not found: ' + sTargetElementAttr );
}

var sSubItemAttr = aAnimElem.getAttributeNS( NSS['anim'], 'sub-item' );
this.bIsTargetTextElement = ( sSubItemAttr && ( sSubItemAttr === 'text' ) );

var sAdditiveAttr = aAnimElem.getAttributeNS( NSS['smil'], 'additive' );
if( sAdditiveAttr && aAddittiveModeInMap[sAdditiveAttr] )
this.eAdditiveMode = aAddittiveModeInMap[sAdditiveAttr];
else
this.eAdditiveMode = ADDITIVE_MODE_REPLACE;

this.nMinFrameCount = ( this.getDuration().isValue() )
? ( this.getDuration().getValue() * MINIMUM_FRAMES_PER_SECONDS )
: MINIMUM_FRAMES_PER_SECONDS;
if( this.nMinFrameCount < 1.0 )
this.nMinFrameCount = 1;
else if( this.nMinFrameCount > MINIMUM_FRAMES_PER_SECONDS )
this.nMinFrameCount = MINIMUM_FRAMES_PER_SECONDS;


if( this.aTargetElement )
{
if( aAnimElem.getAttributeNS( NSS['smil'], 'attributeName' ) === 'visibility' )
{
if( aAnimElem.getAttributeNS( NSS['smil'], 'to' ) === 'visible' )
this.aTargetElement.setAttribute( 'visibility', 'hidden' );
}

if( !this.aNodeContext.aAnimatedElementMap[ sTargetElementAttr ] )
{
if( this.bIsTargetTextElement )
{
this.aNodeContext.aAnimatedElementMap[ sTargetElementAttr ]
= new AnimatedTextElement( this.aTargetElement );
}
else
{
this.aNodeContext.aAnimatedElementMap[ sTargetElementAttr ]
= new AnimatedElement( this.aTargetElement );
}
}
this.aAnimatedElement = this.aNodeContext.aAnimatedElementMap[ sTargetElementAttr ];

this.aAnimatedElement.setAdditiveMode( this.eAdditiveMode );
}


return bRet;
};

AnimationBaseNode.prototype.init_st = function()
{
if( this.aActivity )
this.aActivity.activate( makeEvent( bind( this, this.deactivate ) ) );
else
this.aActivity = this.createActivity();
return true;
};

AnimationBaseNode.prototype.resolve_st = function()
{
return true;
};

AnimationBaseNode.prototype.activate_st = function()
{
if( this.aActivity )
{
this.saveStateOfAnimatedElement();
this.aActivity.setTargets( this.getAnimatedElement() );
if( this.getContext().bIsSkipping  )
{
this.aActivity.end();
}
else
{
this.getContext().aActivityQueue.addActivity( this.aActivity );
}
}
else
{
AnimationBaseNode.superclass.scheduleDeactivationEvent.call( this );
}

};

AnimationBaseNode.prototype.deactivate_st = function( eDestState )
{
if( eDestState == FROZEN_NODE )
{
if( this.aActivity )
this.aActivity.end();
}
if( eDestState == ENDED_NODE )
{
if( this.aActivity )
this.aActivity.dispose();
if( ( this.getFillMode() == FILL_MODE_REMOVE ) && this.getAnimatedElement()  )
this.removeEffect();
}
};

AnimationBaseNode.prototype.createActivity = function()
{
log( 'AnimationBaseNode.createActivity: abstract method called' );
};

AnimationBaseNode.prototype.fillActivityParams = function()
{

var nDuration = 0.001;
if( this.getDuration().isValue() )
{
nDuration = this.getDuration().getValue();
}
else
{
log( 'AnimationBaseNode.fillActivityParams: duration is not a number' );
}

var aActivityParamSet = new ActivityParamSet();

aActivityParamSet.aEndEvent             = makeEvent( bind( this, this.deactivate ) );
aActivityParamSet.aTimerEventQueue      = this.aContext.aTimerEventQueue;
aActivityParamSet.aActivityQueue        = this.aContext.aActivityQueue;
aActivityParamSet.nMinDuration          = nDuration;
aActivityParamSet.nMinNumberOfFrames    = this.getMinFrameCount();
aActivityParamSet.bAutoReverse          = this.isAutoReverseEnabled();
aActivityParamSet.nRepeatCount          = this.getRepeatCount();
aActivityParamSet.nAccelerationFraction = this.getAccelerateValue();
aActivityParamSet.nDecelerationFraction = this.getDecelerateValue();
aActivityParamSet.nSlideWidth           = this.aNodeContext.aSlideWidth;
aActivityParamSet.nSlideHeight          = this.aNodeContext.aSlideHeight;

return aActivityParamSet;
};

AnimationBaseNode.prototype.hasPendingAnimation = function()
{
return true;
};

AnimationBaseNode.prototype.saveStateOfAnimatedElement = function()
{
this.getAnimatedElement().saveState( this.getId() );
};

AnimationBaseNode.prototype.removeEffect = function()
{
this.getAnimatedElement().restoreState( this.getId() );
};

AnimationBaseNode.prototype.getTargetElement = function()
{
return this.aTargetElement;
};

AnimationBaseNode.prototype.getAnimatedElement = function()
{
return this.aAnimatedElement;
};

AnimationBaseNode.prototype.dispose= function()
{
if( this.aActivity )
this.aActivity.dispose();

AnimationBaseNode.superclass.dispose.call( this );
};

AnimationBaseNode.prototype.getMinFrameCount = function()
{
return this.nMinFrameCount;
};

AnimationBaseNode.prototype.getAdditiveMode = function()
{
return this.eAdditiveMode;
};

AnimationBaseNode.prototype.info = function( bVerbose )
{
var sInfo = AnimationBaseNode.superclass.info.call( this, bVerbose );

if( bVerbose )
{
if( this.getMinFrameCount() )
sInfo += ';  min frame count: ' + this.getMinFrameCount();

sInfo += ';  additive: ' + aAddittiveModeOutMap[ this.getAdditiveMode() ];

if( this.getTargetElement() )
{
var sElemId = this.getTargetElement().getAttribute( 'id' );
sInfo += ';  targetElement: ' +  sElemId;
}
}

return sInfo;
};


function AnimationBaseNode2( aAnimElem, aParentNode, aNodeContext )
{
AnimationBaseNode2.superclass.constructor.call( this, aAnimElem, aParentNode, aNodeContext );

this.sAttributeName = '';
this.aToValue = null;

}
extend( AnimationBaseNode2, AnimationBaseNode );


AnimationBaseNode2.prototype.parseElement = function()
{
var bRet = AnimationBaseNode2.superclass.parseElement.call( this );

var aAnimElem = this.aElement;

this.sAttributeName = aAnimElem.getAttributeNS( NSS['smil'], 'attributeName' );
if( !this.sAttributeName )
{
this.eCurrentState = INVALID_NODE;
log( 'AnimationBaseNode2.parseElement: target attribute name not found: ' + this.sAttributeName );
}

this.aToValue = aAnimElem.getAttributeNS( NSS['smil'], 'to' );

return bRet;
};

AnimationBaseNode2.prototype.getAttributeName = function()
{
return this.sAttributeName;
};

AnimationBaseNode2.prototype.getToValue = function()
{
return this.aToValue;
};

AnimationBaseNode2.prototype.info = function( bVerbose )
{
var sInfo = AnimationBaseNode2.superclass.info.call( this, bVerbose );

if( bVerbose )
{
if( this.getAttributeName() )
sInfo += ';  attributeName: ' + this.getAttributeName();

if( this.getToValue() )
sInfo += ';  to: ' + this.getToValue();
}

return sInfo;
};


function AnimationBaseNode3( aAnimElem, aParentNode, aNodeContext )
{
AnimationBaseNode3.superclass.constructor.call( this, aAnimElem, aParentNode, aNodeContext );

this.eAccumulate = undefined;
this.eCalcMode = undefined;
this.aFromValue = null;
this.aByValue = null;
this.aKeyTimes = null;
this.aValues = null;
this.aFormula= null;
}
extend( AnimationBaseNode3, AnimationBaseNode2 );


AnimationBaseNode3.prototype.parseElement = function()
{
var bRet = AnimationBaseNode3.superclass.parseElement.call( this );

var aAnimElem = this.aElement;

this.eAccumulate = ACCUMULATE_MODE_NONE;
var sAccumulateAttr = aAnimElem.getAttributeNS( NSS['smil'], 'accumulate' );
if( sAccumulateAttr == 'sum' )
this.eAccumulate = ACCUMULATE_MODE_SUM;

this.eCalcMode = CALC_MODE_LINEAR;
var sCalcModeAttr = aAnimElem.getAttributeNS( NSS['smil'], 'calcMode' );
if( sCalcModeAttr && aCalcModeInMap[ sCalcModeAttr ] )
this.eCalcMode = aCalcModeInMap[ sCalcModeAttr ];

this.aFromValue = aAnimElem.getAttributeNS( NSS['smil'], 'from' );

this.aByValue = aAnimElem.getAttributeNS( NSS['smil'], 'by' );

this.aKeyTimes = [];
var sKeyTimesAttr = aAnimElem.getAttributeNS( NSS['smil'], 'keyTimes' );
sKeyTimesAttr = removeWhiteSpaces( sKeyTimesAttr );
if( sKeyTimesAttr )
{
var aKeyTimes = sKeyTimesAttr.split( ';' );
for( var i = 0; i < aKeyTimes.length; ++i )
this.aKeyTimes.push( parseFloat( aKeyTimes[i] ) );
}

var sValuesAttr = aAnimElem.getAttributeNS( NSS['smil'], 'values' );
if( sValuesAttr )
{
this.aValues = sValuesAttr.split( ';' );
}
else
{
this.aValues = [];
}

this.aFormula = aAnimElem.getAttributeNS( NSS['anim'], 'formula' );

return bRet;
};

AnimationBaseNode3.prototype.getAccumulate = function()
{
return this.eAccumulate;
};

AnimationBaseNode3.prototype.getCalcMode = function()
{
return this.eCalcMode;
};

AnimationBaseNode3.prototype.getFromValue = function()
{
return this.aFromValue;
};

AnimationBaseNode3.prototype.getByValue = function()
{
return this.aByValue;
};

AnimationBaseNode3.prototype.getKeyTimes = function()
{
return this.aKeyTimes;
};

AnimationBaseNode3.prototype.getValues = function()
{
return this.aValues;
};

AnimationBaseNode3.prototype.getFormula = function()
{
return this.aFormula;
};

AnimationBaseNode3.prototype.info = function( bVerbose )
{
var sInfo = AnimationBaseNode3.superclass.info.call( this, bVerbose );

if( bVerbose )
{
if( this.getAccumulate() )
sInfo += ';  accumulate: ' + aAccumulateModeOutMap[ this.getAccumulate() ];

sInfo += ';  calcMode: ' + aCalcModeOutMap[ this.getCalcMode() ];

if( this.getFromValue() )
sInfo += ';  from: ' + this.getFromValue();

if( this.getByValue() )
sInfo += ';  by: ' + this.getByValue();

if( this.getKeyTimes().length )
sInfo += ';  keyTimes: ' + this.getKeyTimes().join( ',' );

if( this.getKeyTimes().length )
sInfo += ';  values: ' + this.getValues().join( ',' );

if( this.getFormula() )
sInfo += ';  formula: ' + this.getFormula();
}

return sInfo;
};


function BaseContainerNode( aAnimElem, aParentNode, aNodeContext )
{
BaseContainerNode.superclass.constructor.call( this, aAnimElem, aParentNode, aNodeContext );

this.sClassName = 'BaseContainerNode';
this.bIsContainer = true;
this.aChildrenArray = [];
this.nFinishedChildren = 0;
this.bDurationIndefinite = false;
this.nLeftIterations = 1;

this.eImpressNodeType = undefined;
this.ePresetClass =  undefined;
this.ePresetId =  undefined;
}
extend( BaseContainerNode, BaseNode );


BaseContainerNode.prototype.parseElement= function()
{
var bRet = BaseContainerNode.superclass.parseElement.call( this );

var aAnimElem = this.aElement;

this.eImpressNodeType = IMPRESS_DEFAULT_NODE;
var sNodeTypeAttr = aAnimElem.getAttributeNS( NSS['presentation'], 'node-type' );
if( sNodeTypeAttr && aImpressNodeTypeInMap[ sNodeTypeAttr ] )
this.eImpressNodeType = aImpressNodeTypeInMap[ sNodeTypeAttr ];
this.bMainSequenceRootNode = ( this.eImpressNodeType == IMPRESS_MAIN_SEQUENCE_NODE );
this.bInteractiveSequenceRootNode = ( this.eImpressNodeType == IMPRESS_INTERACTIVE_SEQUENCE_NODE );

this.ePresetClass =  undefined;
var sPresetClassAttr = aAnimElem.getAttributeNS( NSS['presentation'], 'preset-class' );
if( sPresetClassAttr && aPresetClassInMap[ sPresetClassAttr ] )
this.ePresetClass = aPresetClassInMap[ sPresetClassAttr ];

this.ePresetId =  undefined;
var sPresetIdAttr = aAnimElem.getAttributeNS( NSS['presentation'], 'preset-id' );
if( sPresetIdAttr && aPresetIdInMap[ sPresetIdAttr ] )
this.ePresetId = aPresetIdInMap[ sPresetIdAttr ];


var nChildrenCount = this.aChildrenArray.length;
for( var i = 0; i < nChildrenCount; ++i )
{
this.aChildrenArray[i].parseElement();
}


this.bDurationIndefinite
= ( !this.getDuration() || this.getDuration().isIndefinite()  ) &&
( !this.getEnd() || ( this.getEnd().getType() != OFFSET_TIMING ) );

return bRet;
};

BaseContainerNode.prototype.appendChildNode = function( aAnimationNode )
{
if( ! this.checkValidNode() )
return ;

if( aAnimationNode.registerDeactivatingListener( this ) )
this.aChildrenArray.push( aAnimationNode );
};

BaseContainerNode.prototype.init_st = function()
{
this.nLeftIterations = this.getRepeatCount();

return this.init_children();
};

BaseContainerNode.prototype.init_children = function()
{
this.nFinishedChildren = 0;
var nChildrenCount = this.aChildrenArray.length;
var nInitChildren = 0;
for( var i = 0; i < nChildrenCount; ++i )
{
if( this.aChildrenArray[i].init() )
{
++nInitChildren;
}
}
return ( nChildrenCount == nInitChildren );
};


BaseContainerNode.prototype.deactivate_st = function( eDestState )
{
this.nLeftIterations = 0;
if( eDestState == FROZEN_NODE )
{
this.forEachChildNode( mem_fn( 'deactivate' ), ~( FROZEN_NODE | ENDED_NODE ) );
}
else
{
this.forEachChildNode( mem_fn( 'end' ), ~ENDED_NODE );
if( this.getFillMode() == FILL_MODE_REMOVE )
this.removeEffect();
}
};

BaseContainerNode.prototype.hasPendingAnimation = function()
{
var nChildrenCount = this.aChildrenArray.length;
for( var i = 0; i < nChildrenCount; ++i )
{
if( this.aChildrenArray[i].hasPendingAnimation() )
return true;
}
return false;
};

BaseContainerNode.prototype.activate_st = function()
{
log( 'BaseContainerNode.activate_st: abstract method called' );
};

BaseContainerNode.prototype.notifyDeactivating = function( aAnimationNode )
{
log( 'BaseContainerNode.notifyDeactivating: abstract method called' );
};

BaseContainerNode.prototype.isDurationIndefinite = function()
{
return this.bDurationIndefinite;
};

BaseContainerNode.prototype.isChildNode = function( aAnimationNode )
{
var nChildrenCount = this.aChildrenArray.length;
for( var i = 0; i < nChildrenCount; ++i )
{
if( this.aChildrenArray[i].getId() == aAnimationNode.getId() )
return true;
}
return false;
};

BaseContainerNode.prototype.notifyDeactivatedChild = function( aChildNode )
{
assert( ( aChildNode.getState() == FROZEN_NODE ) || ( aChildNode.getState() == ENDED_NODE ),
'BaseContainerNode.notifyDeactivatedChild: passed child node is neither in FROZEN nor in ENDED state' );

assert( this.getState() != INVALID_NODE,
'BaseContainerNode.notifyDeactivatedChild: this node is invalid' );

if( !this.isChildNode( aChildNode ) )
{
log( 'BaseContainerNode.notifyDeactivatedChild: unknown child notifier!' );
return false;
}

var nChildrenCount = this.aChildrenArray.length;

assert( ( this.nFinishedChildren < nChildrenCount ),
'BaseContainerNode.notifyDeactivatedChild: assert(this.nFinishedChildren < nChildrenCount) failed' );

++this.nFinishedChildren;
var bFinished = ( this.nFinishedChildren >= nChildrenCount );

if( bFinished && this.isDurationIndefinite() )
{
if( this.nLeftIterations >= 1.0 )
{
this.nLeftIterations -= 1.0;
}
if( this.nLeftIterations >= 1.0 )
{
bFinished = false;
var aRepetitionEvent = makeDelay( bind( this, this.repeat ), 0.0 );
this.aContext.aTimerEventQueue.addEvent( aRepetitionEvent );
}
else
{
this.deactivate();
}
}

return bFinished;
};

BaseContainerNode.prototype.repeat = function()
{
this.forEachChildNode( mem_fn( 'end' ), ~ENDED_NODE );
this.removeEffect();
var bInitialized = this.init_children();
if( bInitialized )
this.activate_st();
return bInitialized;
};

BaseContainerNode.prototype.removeEffect = function()
{
var nChildrenCount = this.aChildrenArray.length;
if( nChildrenCount == 0 )
return;
for( var i = nChildrenCount - 1; i >= 0; --i )
{
if( ( this.aChildrenArray[i].getState() & ( FROZEN_NODE | ENDED_NODE ) ) == 0 )
{
log( 'BaseContainerNode.removeEffect: child(id:'
+ this.aChildrenArray[i].getId() + ') is neither frozen nor ended;'
+ ' state: '
+ aTransitionModeOutMap[ this.aChildrenArray[i].getState() ] );
continue;
}
this.aChildrenArray[i].removeEffect();
}
};

BaseContainerNode.prototype.saveStateOfAnimatedElement = function()
{
var nChildrenCount = this.aChildrenArray.length;
for( var i = 0; i < nChildrenCount; ++i )
{
this.aChildrenArray[i].saveStateOfAnimatedElement();
}
};

BaseContainerNode.prototype.forEachChildNode = function( aFunction, eNodeStateMask )
{
if( !eNodeStateMask )
eNodeStateMask = -1;

var nChildrenCount = this.aChildrenArray.length;
for( var i = 0; i < nChildrenCount; ++i )
{
if( ( eNodeStateMask != -1 ) && ( ( this.aChildrenArray[i].getState() & eNodeStateMask ) == 0 ) )
continue;
aFunction( this.aChildrenArray[i] );
}
};

BaseContainerNode.prototype.dispose = function()
{
var nChildrenCount = this.aChildrenArray.length;
for( var i = 0; i < nChildrenCount; ++i )
{
this.aChildrenArray[i].dispose();
}

BaseContainerNode.superclass.dispose.call( this );
};

BaseContainerNode.prototype.getImpressNodeType = function()
{
return this.eImpressNodeType;
};

BaseContainerNode.prototype.info = function( bVerbose )
{
var sInfo = BaseContainerNode.superclass.info.call( this, bVerbose );

if( bVerbose )
{
if( this.getImpressNodeType() )
sInfo += ';  node-type: ' + aImpressNodeTypeOutMap[ this.getImpressNodeType() ];
}

var nChildrenCount = this.aChildrenArray.length;
for( var i = 0; i < nChildrenCount; ++i )
{
sInfo += '\n';
sInfo += this.aChildrenArray[i].info( bVerbose );
}

return sInfo;
};


function ParallelTimeContainer( aAnimElem, aParentNode, aNodeContext )
{
ParallelTimeContainer.superclass.constructor.call( this, aAnimElem, aParentNode, aNodeContext );

this.sClassName = 'ParallelTimeContainer';
}
extend( ParallelTimeContainer, BaseContainerNode );


ParallelTimeContainer.prototype.activate_st = function()
{
var nChildrenCount = this.aChildrenArray.length;
var nResolvedChildren = 0;
for( var i = 0; i < nChildrenCount; ++i )
{
if( this.aChildrenArray[i].resolve() )
{
++nResolvedChildren;
}
}

if( nChildrenCount != nResolvedChildren )
{
log( 'ParallelTimeContainer.activate_st: resolving all children failed' );
return;
}


if( this.isDurationIndefinite() && ( nChildrenCount == 0  ) )
{
this.scheduleDeactivationEvent( this.makeDeactivationEvent( 0.0 ) );
}
else
{
this.scheduleDeactivationEvent();
}
};

ParallelTimeContainer.prototype.notifyDeactivating = function( aAnimationNode )
{
this.notifyDeactivatedChild( aAnimationNode );
};


function SequentialTimeContainer( aAnimElem, aParentNode, aNodeContext )
{
SequentialTimeContainer.superclass.constructor.call( this, aAnimElem, aParentNode, aNodeContext );

this.sClassName = 'SequentialTimeContainer';
this.bIsRewinding = false;
this.aCurrentSkipEvent = null;
this.aRewindCurrentEffectEvent = null;
this.aRewindLastEffectEvent = null;
}
extend( SequentialTimeContainer, BaseContainerNode );


SequentialTimeContainer.prototype.activate_st = function()
{
var nChildrenCount = this.aChildrenArray.length;
for( ; this.nFinishedChildren < nChildrenCount; ++this.nFinishedChildren )
{
if( this.resolveChild( this.aChildrenArray[ this.nFinishedChildren ] ) )
break;
else
log( 'SequentialTimeContainer.activate_st: resolving child failed!' );
}

if( this.isDurationIndefinite() && ( ( nChildrenCount == 0 ) || ( this.nFinishedChildren >= nChildrenCount ) ) )
{
this.scheduleDeactivationEvent( this.makeDeactivationEvent( 0.0 ) );
}
else
{
this.scheduleDeactivationEvent();
}
};

SequentialTimeContainer.prototype.notifyDeactivating = function( aNotifier )
{
if( this.bIsRewinding )
return;

if( this.notifyDeactivatedChild( aNotifier ) )
return;

assert( this.nFinishedChildren < this.aChildrenArray.length,
'SequentialTimeContainer.notifyDeactivating: assertion (this.nFinishedChildren < this.aChildrenArray.length) failed' );

var aNextChild = this.aChildrenArray[ this.nFinishedChildren ];

assert( aNextChild.getState() == UNRESOLVED_NODE,
'SequentialTimeContainer.notifyDeactivating: assertion (aNextChild.getState == UNRESOLVED_NODE) failed' );

if( !this.resolveChild( aNextChild ) )
{
this.deactivate();
}
};

SequentialTimeContainer.prototype.skipEffect = function( aChildNode )
{
if( this.isChildNode( aChildNode ) )
{
this.getContext().aActivityQueue.endAll();
this.getContext().bIsSkipping = true;
this.getContext().aTimerEventQueue.forceEmpty();
this.getContext().bIsSkipping = false;
var aEvent = makeEvent( bind2( aChildNode.deactivate, aChildNode ) );
this.getContext().aTimerEventQueue.addEvent( aEvent );
}
else
{
log( 'SequentialTimeContainer.skipEffect: unknown child: '
+ aChildNode.getId() );
}
};

SequentialTimeContainer.prototype.rewindCurrentEffect = function( aChildNode )
{
if( this.isChildNode( aChildNode ) )
{
assert( !this.bIsRewinding,
'SequentialTimeContainer.rewindCurrentEffect: is already rewinding.' );

this.bIsRewinding = true;
this.getContext().aActivityQueue.endAll();
this.getContext().bIsSkipping = true;
this.getContext().aTimerEventQueue.forceEmpty();
this.getContext().bIsSkipping = false;
this.getContext().aActivityQueue.endAll();

aChildNode.end();
aChildNode.removeEffect();
aChildNode.init();
this.resolveChild( aChildNode );
this.notifyRewindedEvent( aChildNode );
this.bIsRewinding = false;
}
else
{
log( 'SequentialTimeContainer.rewindCurrentEffect: unknown child: '
+ aChildNode.getId() );
}
};

SequentialTimeContainer.prototype.rewindLastEffect = function( aChildNode )
{
if( this.isChildNode( aChildNode ) )
{
assert( !this.bIsRewinding,
'SequentialTimeContainer.rewindLastEffect: is already rewinding.' );

this.bIsRewinding = true;
this.getContext().aTimerEventQueue.forceEmpty();
this.getContext().aActivityQueue.clear();
aChildNode.end();

--this.nFinishedChildren;
var aPreviousChildNode = this.aChildrenArray[ this.nFinishedChildren ];

aPreviousChildNode.removeEffect();
aPreviousChildNode.init();
aChildNode.init();
this.resolveChild( aPreviousChildNode );
this.notifyRewindedEvent( aChildNode );
this.bIsRewinding = false;
}
else
{
log( 'SequentialTimeContainer.rewindLastEffect: unknown child: '
+ aChildNode.getId() );
}
};

SequentialTimeContainer.prototype.resolveChild = function( aChildNode )
{
var bResolved = aChildNode.resolve();

if( bResolved && ( this.isMainSequenceRootNode() || this.isInteractiveSequenceRootNode() ) )
{
if( this.aCurrentSkipEvent )
this.aCurrentSkipEvent.dispose();
this.aCurrentSkipEvent = makeEvent( bind2( SequentialTimeContainer.prototype.skipEffect, this, aChildNode ) );

if( this.aRewindCurrentEffectEvent )
this.aRewindCurrentEffectEvent.dispose();
this.aRewindCurrentEffectEvent = makeEvent( bind2( SequentialTimeContainer.prototype.rewindCurrentEffect, this, aChildNode ) );

if( this.aRewindLastEffectEvent )
this.aRewindLastEffectEvent.dispose();
this.aRewindLastEffectEvent = makeEvent( bind2( SequentialTimeContainer.prototype.rewindLastEffect, this, aChildNode ) );

if( this.isMainSequenceRootNode() )
{
this.aContext.aEventMultiplexer.registerSkipEffectEvent( this.aCurrentSkipEvent );
this.aContext.aEventMultiplexer.registerRewindCurrentEffectEvent( this.aRewindCurrentEffectEvent );
this.aContext.aEventMultiplexer.registerRewindLastEffectEvent( this.aRewindLastEffectEvent );
}
else if( this.isInteractiveSequenceRootNode() )
{
this.aContext.aEventMultiplexer.registerSkipInteractiveEffectEvent( aChildNode.getId(), this.aCurrentSkipEvent );
this.aContext.aEventMultiplexer.registerRewindRunningInteractiveEffectEvent( aChildNode.getId(), this.aRewindCurrentEffectEvent );
this.aContext.aEventMultiplexer.registerRewindEndedInteractiveEffectEvent( aChildNode.getId(), this.aRewindLastEffectEvent );
}
}
return bResolved;
};

SequentialTimeContainer.prototype.notifyRewindedEvent = function( aChildNode )
{
if( this.isInteractiveSequenceRootNode() )
{
this.aContext.aEventMultiplexer.notifyRewindedEffectEvent( aChildNode.getId() );

var sId = aChildNode.getBegin().getEventBaseElementId();
if( sId )
{
this.aContext.aEventMultiplexer.notifyRewindedEffectEvent( sId );
}
}
};

SequentialTimeContainer.prototype.dispose = function()
{
if( this.aCurrentSkipEvent )
this.aCurrentSkipEvent.dispose();

SequentialTimeContainer.superclass.dispose.call( this );
};


function PropertyAnimationNode(  aAnimElem, aParentNode, aNodeContext )
{
PropertyAnimationNode.superclass.constructor.call( this, aAnimElem, aParentNode, aNodeContext );

this.sClassName = 'PropertyAnimationNode';
}
extend( PropertyAnimationNode, AnimationBaseNode3 );


PropertyAnimationNode.prototype.createActivity = function()
{


var aActivityParamSet = this.fillActivityParams();

var aAnimation = createPropertyAnimation( this.getAttributeName(),
this.getAnimatedElement(),
this.aNodeContext.aSlideWidth,
this.aNodeContext.aSlideHeight );

var aInterpolator = null;  // createActivity will compute it;
return createActivity( aActivityParamSet, this, aAnimation, aInterpolator );

};


function AnimationSetNode(  aAnimElem, aParentNode, aNodeContext )
{
AnimationSetNode.superclass.constructor.call( this, aAnimElem, aParentNode, aNodeContext );

this.sClassName = 'AnimationSetNode';
}
extend( AnimationSetNode, AnimationBaseNode2 );


AnimationSetNode.prototype.createActivity = function()
{
var aAnimation = createPropertyAnimation( this.getAttributeName(),
this.getAnimatedElement(),
this.aNodeContext.aSlideWidth,
this.aNodeContext.aSlideHeight );

var aActivityParamSet = this.fillActivityParams();

return new SetActivity( aActivityParamSet, aAnimation, this.getToValue() );
};


function AnimationColorNode(  aAnimElem, aParentNode, aNodeContext )
{
AnimationColorNode.superclass.constructor.call( this, aAnimElem, aParentNode, aNodeContext );

this.sClassName = 'AnimationColorNode';

this.eColorInterpolation = undefined;
this.eColorInterpolationDirection = undefined;
}
extend( AnimationColorNode, AnimationBaseNode3 );


AnimationColorNode.prototype.parseElement = function()
{
var bRet = AnimationColorNode.superclass.parseElement.call( this );

var aAnimElem = this.aElement;

this.eColorInterpolation = COLOR_SPACE_RGB;
var sColorInterpolationAttr = aAnimElem.getAttributeNS( NSS['anim'], 'color-interpolation' );
if( sColorInterpolationAttr && aColorSpaceInMap[ sColorInterpolationAttr ] )
this.eColorInterpolation = aColorSpaceInMap[ sColorInterpolationAttr ];

this.eColorInterpolationDirection = CLOCKWISE;
var sColorInterpolationDirectionAttr = aAnimElem.getAttributeNS( NSS['anim'], 'color-interpolation-direction' );
if( sColorInterpolationDirectionAttr && aClockDirectionInMap[ sColorInterpolationDirectionAttr ] )
this.eColorInterpolationDirection = aClockDirectionInMap[ sColorInterpolationDirectionAttr ];

return bRet;
};

AnimationColorNode.prototype.createActivity = function()
{


var aActivityParamSet = this.fillActivityParams();

var aAnimation = createPropertyAnimation( this.getAttributeName(),
this.getAnimatedElement(),
this.aNodeContext.aSlideWidth,
this.aNodeContext.aSlideHeight );

var aColorAnimation;
var aInterpolator;
if( this.getColorInterpolation() === COLOR_SPACE_HSL )
{
ANIMDBG.print( 'AnimationColorNode.createActivity: color space hsl'  );
aColorAnimation = new HSLAnimationWrapper( aAnimation );
var aInterpolatorMaker = aInterpolatorHandler.getInterpolator( this.getCalcMode(),
COLOR_PROPERTY,
COLOR_SPACE_HSL );
aInterpolator = aInterpolatorMaker( this.getColorInterpolationDirection() );
}
else
{
ANIMDBG.print( 'AnimationColorNode.createActivity: color space rgb'  );
aColorAnimation = aAnimation;
aInterpolator = aInterpolatorHandler.getInterpolator( this.getCalcMode(),
COLOR_PROPERTY,
COLOR_SPACE_RGB );
}

return createActivity( aActivityParamSet, this, aColorAnimation, aInterpolator );


};

AnimationColorNode.prototype.getColorInterpolation = function()
{
return this.eColorInterpolation;
};

AnimationColorNode.prototype.getColorInterpolationDirection = function()
{
return this.eColorInterpolationDirection;
};

AnimationColorNode.prototype.info = function( bVerbose )
{
var sInfo = AnimationColorNode.superclass.info.call( this, bVerbose );

if( bVerbose )
{
sInfo += ';  color-interpolation: ' + aColorSpaceOutMap[ this.getColorInterpolation() ];

sInfo += ';  color-interpolation-direction: ' + aClockDirectionOutMap[ this.getColorInterpolationDirection() ];
}
return sInfo;
};


function AnimationTransitionFilterNode(  aAnimElem, aParentNode, aNodeContext )
{
AnimationTransitionFilterNode.superclass.constructor.call( this, aAnimElem, aParentNode, aNodeContext );

this.sClassName = 'AnimationTransitionFilterNode';

this.eTransitionType = undefined;
this.eTransitionSubType = undefined;
this.bReverseDirection = undefined;
this.eTransitionMode = undefined;
}
extend( AnimationTransitionFilterNode, AnimationBaseNode );


AnimationTransitionFilterNode.prototype.createActivity = function()
{
var aActivityParamSet = this.fillActivityParams();

return createShapeTransition( aActivityParamSet,
this.getAnimatedElement(),
this.aNodeContext.aSlideWidth,
this.aNodeContext.aSlideHeight,
this );
};

AnimationTransitionFilterNode.prototype.parseElement = function()
{
var bRet = AnimationTransitionFilterNode.superclass.parseElement.call( this );
var bIsValidTransition = true;

var aAnimElem = this.aElement;

this.eTransitionType = undefined;
var sTypeAttr = aAnimElem.getAttributeNS( NSS['smil'], 'type' );
if( sTypeAttr && aTransitionTypeInMap[ sTypeAttr ] )
{
this.eTransitionType = aTransitionTypeInMap[ sTypeAttr ];
}
else
{
bIsValidTransition = false;
log( 'AnimationTransitionFilterNode.parseElement: transition type not valid: ' + sTypeAttr );
}

this.eTransitionSubType = undefined;
var sSubTypeAttr = aAnimElem.getAttributeNS( NSS['smil'], 'subtype' );
if( sSubTypeAttr === null )
sSubTypeAttr = 'default';
if( sSubTypeAttr && ( aTransitionSubtypeInMap[ sSubTypeAttr ] !== undefined  ) )
{
this.eTransitionSubType = aTransitionSubtypeInMap[ sSubTypeAttr ];
}
else
{
bIsValidTransition = false;
log( 'AnimationTransitionFilterNode.parseElement: transition subtype not valid: ' + sSubTypeAttr );
}

if( !bIsValidTransition )
{
this.eTransitionType = FADE_TRANSITION;
this.eTransitionSubType = CROSSFADE_TRANS_SUBTYPE;
log( 'AnimationTransitionFilterNode.parseElement: in place of the invalid transition a crossfade transition is used' );
}

this.bReverseDirection = false;
var sDirectionAttr = aAnimElem.getAttributeNS( NSS['smil'], 'direction' );
if( sDirectionAttr == 'reverse' )
this.bReverseDirection = true;

this.eTransitionMode = TRANSITION_MODE_IN;
var sModeAttr = aAnimElem.getAttributeNS( NSS['smil'], 'mode' );
if( sModeAttr === 'out' )
this.eTransitionMode = TRANSITION_MODE_OUT;

return bRet;
};

AnimationTransitionFilterNode.prototype.getTransitionType = function()
{
return this.eTransitionType;
};

AnimationTransitionFilterNode.prototype.getTransitionSubType = function()
{
return this.eTransitionSubType;
};

AnimationTransitionFilterNode.prototype.getTransitionMode = function()
{
return this.eTransitionMode;
};

AnimationTransitionFilterNode.prototype.getReverseDirection = function()
{
return this.bReverseDirection;
};

AnimationTransitionFilterNode.prototype.info = function( bVerbose )
{
var sInfo = AnimationTransitionFilterNode.superclass.info.call( this, bVerbose );

if( bVerbose )
{
sInfo += ';  type: ' + aTransitionTypeOutMap[ String( this.getTransitionType() ) ];

sInfo += ';  subtype: ' + aTransitionSubtypeOutMap[ this.getTransitionSubType() ];

if( this.getReverseDirection() )
sInfo += ';  direction: reverse';
}

return sInfo;
};


function createAnimationTree( aRootElement, aNodeContext )
{
return createAnimationNode( aRootElement, null, aNodeContext );
}


function createAnimationNode( aElement, aParentNode, aNodeContext )
{
assert( aElement, 'createAnimationNode: invalid animation element' );

var eAnimationNodeType = getAnimationElementType( aElement );

var aCreatedNode = null;
var aCreatedContainer = null;

switch( eAnimationNodeType )
{
case ANIMATION_NODE_PAR:
aCreatedNode = aCreatedContainer =
new ParallelTimeContainer( aElement, aParentNode, aNodeContext );
break;
case ANIMATION_NODE_ITERATE:
aCreatedNode = aCreatedContainer =
new ParallelTimeContainer( aElement, aParentNode, aNodeContext );
break;
case ANIMATION_NODE_SEQ:
aCreatedNode = aCreatedContainer =
new SequentialTimeContainer( aElement, aParentNode, aNodeContext );
break;
case ANIMATION_NODE_ANIMATE:
aCreatedNode = new PropertyAnimationNode( aElement, aParentNode, aNodeContext );
break;
case ANIMATION_NODE_SET:
aCreatedNode = new AnimationSetNode( aElement, aParentNode, aNodeContext );
break;
case ANIMATION_NODE_ANIMATEMOTION:
log( 'createAnimationNode: ANIMATEMOTION not implemented' );
return null;
case ANIMATION_NODE_ANIMATECOLOR:
aCreatedNode = new AnimationColorNode( aElement, aParentNode, aNodeContext );
break;
case ANIMATION_NODE_ANIMATETRANSFORM:
log( 'createAnimationNode: ANIMATETRANSFORM not implemented' );
return null;
case ANIMATION_NODE_TRANSITIONFILTER:
aCreatedNode = new AnimationTransitionFilterNode( aElement, aParentNode, aNodeContext );
break;
case ANIMATION_NODE_AUDIO:
log( 'createAnimationNode: AUDIO not implemented' );
return null;
case ANIMATION_NODE_COMMAND:
log( 'createAnimationNode: COMMAND not implemented' );
return null;
default:
log( 'createAnimationNode: invalid Animation Node Type: ' + eAnimationNodeType );
return null;
}

if( aCreatedContainer )
{
if( eAnimationNodeType == ANIMATION_NODE_ITERATE )
{
createIteratedNodes( aElement, aCreatedContainer, aNodeContext );
}
else
{
var aChildrenArray = getElementChildren( aElement );
for( var i = 0; i < aChildrenArray.length; ++i )
{
if( !createChildNode( aChildrenArray[i], aCreatedContainer, aNodeContext ) )
{
return null;
}
}
}
}

return aCreatedNode;
}


function createChildNode( aElement, aParentNode, aNodeContext )
{
var aChildNode = createAnimationNode( aElement, aParentNode, aNodeContext );

if( !aChildNode )
{
log( 'createChildNode: child node creation failed' );
return false;
}
else
{
aParentNode.appendChildNode( aChildNode );
return true;
}
}


function createIteratedNodes( aElement, aContainerNode, aNodeContext )
{
}


function makeScaler( nScale )
{
if( ( typeof( nScale ) !== typeof( 0 ) ) || !isFinite( nScale ) )
{
log( 'makeScaler: not valid param passed: ' + nScale );
return null;
}

return  function( nValue )
{
return ( nScale * nValue );
};
}


function createPropertyAnimation( sAttrName, aAnimatedElement, nWidth, nHeight )
{
if( !aAttributeMap[ sAttrName ] )
{
log( 'createPropertyAnimation: attribute is unknown' );
return null;
}


var aFunctorSet = aAttributeMap[ sAttrName ];

var sGetValueMethod =   aFunctorSet.get;
var sSetValueMethod =   aFunctorSet.set;

if( !sGetValueMethod || !sSetValueMethod  )
{
log( 'createPropertyAnimation: attribute is not handled' );
return null;
}

var aGetModifier =  eval( aFunctorSet.getmod );
var aSetModifier =  eval( aFunctorSet.setmod );


return new GenericAnimation( bind( aAnimatedElement, aAnimatedElement[ sGetValueMethod ] ),
bind( aAnimatedElement, aAnimatedElement[ sSetValueMethod ] ),
aGetModifier,
aSetModifier);
}


function createShapeTransition( aActivityParamSet, aAnimatedElement,
nSlideWidth, nSlideHeight,
aAnimatedTransitionFilterNode )
{
if( !aAnimatedTransitionFilterNode )
{
log( 'createShapeTransition: the animated transition filter node is not valid.' );
return null;
}
var eTransitionType = aAnimatedTransitionFilterNode.getTransitionType();
var eTransitionSubType = aAnimatedTransitionFilterNode.getTransitionSubType();
var bDirectionForward = ! aAnimatedTransitionFilterNode.getReverseDirection();
var bModeIn = ( aAnimatedTransitionFilterNode.getTransitionMode() == FORWARD );

var aTransitionInfo = aTransitionInfoTable[eTransitionType][eTransitionSubType];
var eTransitionClass = aTransitionInfo['class'];

switch( eTransitionClass )
{
default:
case TRANSITION_INVALID:
log( 'createShapeTransition: transition class: TRANSITION_INVALID' );
return null;

case TRANSITION_CLIP_POLYPOLYGON:
var aParametricPolyPolygon
= createClipPolyPolygon( eTransitionType, eTransitionSubType );
var aClippingAnimation
= new ClippingAnimation( aParametricPolyPolygon, aTransitionInfo,
bDirectionForward, bModeIn );
return new SimpleActivity( aActivityParamSet, aClippingAnimation, true );

case TRANSITION_SPECIAL:
switch( eTransitionType )
{
default:
var aAnimation
= createPropertyAnimation( 'opacity',
aAnimatedElement,
nSlideWidth,
nSlideHeight );
return new SimpleActivity( aActivityParamSet, aAnimation, bModeIn );
}
}

}


function ClippingAnimation( aParametricPolyPolygon, aTransitionInfo,
bDirectionForward, bModeIn )
{
this.aClippingFunctor = new ClippingFunctor( aParametricPolyPolygon,
aTransitionInfo,
bDirectionForward, bModeIn );
this.bAnimationStarted = false;
}

ClippingAnimation.prototype.start = function( aAnimatableElement )
{
assert( aAnimatableElement,
'ClippingAnimation.start: animatable element is not valid' );
this.aAnimatableElement = aAnimatableElement;
this.aAnimatableElement.initClipPath();
this.aAnimatableElement.notifyAnimationStart();

if( !this.bAnimationStarted )
this.bAnimationStarted = true;

};

ClippingAnimation.prototype.end = function()
{
if( this.bAnimationStarted )
{
this.aAnimatableElement.cleanClipPath();
this.bAnimationStarted = false;
this.aAnimatableElement.notifyAnimationEnd();
}
};

ClippingAnimation.prototype.perform = function( nValue )
{
var nWidth = this.aAnimatableElement.aClippingBBox.width;
var nHeight = this.aAnimatableElement.aClippingBBox.height;
var aPolyPolygonElement = this.aClippingFunctor.perform( nValue, nWidth, nHeight );
this.aAnimatableElement.setClipPath( aPolyPolygonElement );
};

ClippingAnimation.prototype.getUnderlyingValue = function()
{
return 0.0;
};


function GenericAnimation( aGetValueFunc, aSetValueFunc, aGetModifier, aSetModifier )
{
assert( aGetValueFunc && aSetValueFunc,
'GenericAnimation constructor: get value functor and/or set value functor are not valid' );

this.aGetValueFunc = aGetValueFunc;
this.aSetValueFunc = aSetValueFunc;
this.aGetModifier = aGetModifier;
this.aSetModifier = aSetModifier;
this.aAnimatableElement = null;
this.bAnimationStarted = false;
}


GenericAnimation.prototype.start = function( aAnimatableElement )
{
assert( aAnimatableElement, 'GenericAnimation.start: animatable element is not valid' );

this.aAnimatableElement = aAnimatableElement;
this.aAnimatableElement.notifyAnimationStart();

if( !this.bAnimationStarted )
this.bAnimationStarted = true;
};

GenericAnimation.prototype.end = function()
{
if( this.bAnimationStarted )
{
this.bAnimationStarted = false;
this.aAnimatableElement.notifyAnimationEnd();
}
};

GenericAnimation.prototype.perform = function( aValue )
{
if( this.aSetModifier )
aValue = this.aSetModifier( aValue );

this.aSetValueFunc( aValue );
};

GenericAnimation.prototype.getUnderlyingValue = function()
{
var aValue = this.aGetValueFunc();
if( this.aGetModifier )
aValue = this.aGetModifier( aValue );
return aValue;
};


function HSLAnimationWrapper( aColorAnimation )
{
assert( aColorAnimation,
'HSLAnimationWrapper constructor: invalid color animation delegate' );

this.aAnimation = aColorAnimation;
}


HSLAnimationWrapper.prototype.start = function( aAnimatableElement )
{
this.aAnimation.start( aAnimatableElement );
};

HSLAnimationWrapper.prototype.end = function()
{
this.aAnimation.end();
};
HSLAnimationWrapper.prototype.perform = function( aHSLValue )
{
this.aAnimation.perform( aHSLValue.convertToRGB() );
};

HSLAnimationWrapper.prototype.getUnderlyingValue = function()
{
return this.aAnimation.getUnderlyingValue().convertToHSL();
};


function SlideChangeBase(aLeavingSlide, aEnteringSlide)
{
this.aLeavingSlide = aLeavingSlide;
this.aEnteringSlide = aEnteringSlide;
this.bIsFinished = false;
}

SlideChangeBase.prototype.start = function()
{
};

SlideChangeBase.prototype.end = function()
{
if( this.bIsFinished )
return;

this.aLeavingSlide.hide();
this.aEnteringSlide.reset();
this.aLeavingSlide.reset();

this.bIsFinished = true;
};

SlideChangeBase.prototype.perform = function( nValue )
{
if( this.bIsFinished ) return false;

if( this.aLeavingSlide )
this.performOut( nValue );

if( this.aEnteringSlide )
this.performIn( nValue );

return true;
};

SlideChangeBase.prototype.getUnderlyingValue = function()
{
return 0.0;
};

SlideChangeBase.prototype.performIn = function( nValue )
{
log( 'SlideChangeBase.performIn: abstract method called' );
};

SlideChangeBase.prototype.performOut = function( nValue )
{
log( 'SlideChangeBase.performOut: abstract method called' );
};


function FadingSlideChange( aLeavingSlide, aEnteringSlide )
{
FadingSlideChange.superclass.constructor.call( this, aLeavingSlide, aEnteringSlide );
this.bFirstRun = true;
}
extend( FadingSlideChange, SlideChangeBase );

FadingSlideChange.prototype.start = function()
{
FadingSlideChange.superclass.start.call( this );
this.aEnteringSlide.notifyUsedAttribute( 'opacity' );
this.aLeavingSlide.notifyUsedAttribute( 'opacity' );
this.aEnteringSlide.setOpacity( 0.0 );
this.aEnteringSlide.show();
};

FadingSlideChange.prototype.performIn = function( nT )
{
this.aEnteringSlide.setOpacity( nT );
};

FadingSlideChange.prototype.performOut = function( nT )
{

this.aLeavingSlide.setOpacity( 1 - nT );
};


function FadingOverColorSlideChange( aLeavingSlide, aEnteringSlide, sFadeColor )
{
FadingSlideChange.superclass.constructor.call( this, aLeavingSlide, aEnteringSlide );
this.sFadeColor = sFadeColor;
if( !this.sFadeColor )
{
log( 'FadingOverColorSlideChange: sFadeColor not valid.' );
this.sFadeColor = '#000000';
}
this.aColorPlaneElement = this.createColorPlaneElement();
}
extend( FadingOverColorSlideChange, SlideChangeBase );

FadingOverColorSlideChange.prototype.start = function()
{
FadingOverColorSlideChange.superclass.start.call( this );
this.aEnteringSlide.notifyUsedAttribute( 'opacity' );
this.aLeavingSlide.notifyUsedAttribute( 'opacity' );
this.aLeavingSlide.insertBefore( this.aColorPlaneElement );
this.aEnteringSlide.setOpacity( 0.0 );
this.aEnteringSlide.show();
};

FadingOverColorSlideChange.prototype.end = function()
{
FadingOverColorSlideChange.superclass.end.call( this );
this.aLeavingSlide.removeElement( this.aColorPlaneElement );
};

FadingOverColorSlideChange.prototype.performIn = function( nT )
{
this.aEnteringSlide.setOpacity( (nT > 0.55) ? 2.0*(nT-0.55) : 0.0 );
};

FadingOverColorSlideChange.prototype.performOut = function( nT )
{
this.aLeavingSlide.setOpacity( (nT > 0.45) ? 0.0 : 2.0*(0.45-nT) );
};

FadingOverColorSlideChange.prototype.createColorPlaneElement = function()
{
var aColorPlaneElement = document.createElementNS( NSS['svg'], 'rect' );
aColorPlaneElement.setAttribute( 'width', String( this.aLeavingSlide.getWidth() ) );
aColorPlaneElement.setAttribute( 'height', String( this.aLeavingSlide.getHeight() ) );
aColorPlaneElement.setAttribute( 'fill', this.sFadeColor );
return aColorPlaneElement;
};


function MovingSlideChange( aLeavingSlide, aEnteringSlide,
aLeavingDirection, aEnteringDirection )
{
MovingSlideChange.superclass.constructor.call( this, aLeavingSlide, aEnteringSlide );
this.aLeavingDirection = aLeavingDirection;
this.aEnteringDirection = aEnteringDirection;
}
extend( MovingSlideChange, SlideChangeBase );

MovingSlideChange.prototype.start = function()
{
MovingSlideChange.superclass.start.call( this );
this.aEnteringSlide.notifyUsedAttribute( 'transform' );
this.aLeavingSlide.notifyUsedAttribute( 'transform' );
this.performIn( 0 );
this.aEnteringSlide.show();
};

MovingSlideChange.prototype.performIn = function( nT )
{
var nS = nT - 1;
var dx = nS * this.aEnteringDirection.x * this.aEnteringSlide.getWidth();
var dy = nS * this.aEnteringDirection.y * this.aEnteringSlide.getHeight();
this.aEnteringSlide.translate( dx, dy );
};

MovingSlideChange.prototype.performOut = function( nT )
{
var dx = nT * this.aLeavingDirection.x * this.aLeavingSlide.getWidth();
var dy = nT * this.aLeavingDirection.y * this.aLeavingSlide.getHeight();
this.aLeavingSlide.translate( dx, dy );
};


function ClippedSlideChange( aLeavingSlide, aEnteringSlide, aParametricPolyPolygon,
aTransitionInfo, bIsDirectionForward )
{
ClippedSlideChange.superclass.constructor.call( this, aLeavingSlide, aEnteringSlide );

var bIsModeIn = true;
this.aClippingFunctor= new ClippingFunctor( aParametricPolyPolygon, aTransitionInfo,
bIsDirectionForward, bIsModeIn );
}
extend( ClippedSlideChange, SlideChangeBase );

ClippedSlideChange.prototype.start = function()
{
ClippedSlideChange.superclass.start.call( this );
this.aEnteringSlide.notifyUsedAttribute( 'clip-path' );
this.performIn( 0 );
this.aEnteringSlide.show();
};

ClippedSlideChange.prototype.performIn = function( nT )
{
var nWidth = this.aEnteringSlide.getWidth();
var nHeight = this.aEnteringSlide.getHeight();
var aPolyPolygonElement = this.aClippingFunctor.perform( nT, nWidth, nHeight );
this.aEnteringSlide.setClipPath( aPolyPolygonElement );
};

ClippedSlideChange.prototype.performOut = function( nT )
{
};


function ClippingFunctor( aParametricPolyPolygon, aTransitionInfo,
bIsDirectionForward, bIsModeIn)
{
this.aParametricPolyPolygon = aParametricPolyPolygon;
this.aStaticTransformation = null;
this.bForwardParameterSweep = true;
this.bSubtractPolygon = false;
this.bScaleIsotropically = aTransitionInfo.scaleIsotropically;
this.bFlip = false;

assert( this.aParametricPolyPolygon,
'ClippingFunctor: parametric polygon is not valid' );

if( aTransitionInfo.rotationAngle != 0.0 ||
aTransitionInfo.scaleX != 1.0 ||  aTransitionInfo.scaleY != 1.0 )
{
this.aStaticTransformation = SVGIdentityMatrix.translate( 0.5, 0.5 );
if( aTransitionInfo.scaleX != 1.0 ||  aTransitionInfo.scaleY != 1.0 )
this.aStaticTransformation
= this.aStaticTransformation.scaleNonUniform( aTransitionInfo.scaleX,
aTransitionInfo.scaleY );
if( aTransitionInfo.rotationAngle != 0.0 )
this.aStaticTransformation
= this.aStaticTransformation.rotate( aTransitionInfo.rotationAngle );
this.aStaticTransformation = this.aStaticTransformation.translate( -0.5, -0.5 );
}
else
{
this.aStaticTransformation = document.documentElement.createSVGMatrix();
}

if( !bIsDirectionForward )
{
var aMatrix = null;
switch( aTransitionInfo.reverseMethod )
{
default:
log( 'ClippingFunctor: unexpected reverse method.' );
break;
case REVERSEMETHOD_IGNORE:
break;
case REVERSEMETHOD_INVERT_SWEEP:
this.bForwardParameterSweep = !this.bForwardParameterSweep;
break;
case REVERSEMETHOD_SUBTRACT_POLYGON:
this.bSubtractPolygon = !this.bSubtractPolygon;
break;
case REVERSEMETHOD_SUBTRACT_AND_INVERT:
this.bForwardParameterSweep = !this.bForwardParameterSweep;
this.bSubtractPolygon = !this.bSubtractPolygon;
break;
case REVERSEMETHOD_ROTATE_180:
aMatrix = document.documentElement.createSVGMatrix();
aMatrix.setToRotationAroundPoint( 0.5, 0.5, 180 );
this.aStaticTransformation = aMatrix.multiply( this.aStaticTransformation );
break;
case REVERSEMETHOD_FLIP_X:
aMatrix = document.documentElement.createSVGMatrix();
aMatrix.a = -1; aMatrix.e = 1.0;
this.aStaticTransformation = aMatrix.multiply( this.aStaticTransformation );
this.bFlip = true;
break;
case REVERSEMETHOD_FLIP_Y:
aMatrix = document.documentElement.createSVGMatrix();
aMatrix.d = -1; aMatrix.f = 1.0;
this.aStaticTransformation = aMatrix.multiply( this.aStaticTransformation );
this.bFlip = true;
break;
}
}

if( !bIsModeIn )
{
if( aTransitionInfo.outInvertsSweep )
{
this.bForwardParameterSweep = !this.bForwardParameterSweep;
}
else
{
this.bSubtractPolygon = !this.bSubtractPolygon;
}
}
}

ClippingFunctor.aBoundingPath = document.createElementNS( NSS['svg'], 'path' );
ClippingFunctor.aBoundingPath.setAttribute( 'd', 'M -1 -1 L 2 -1 L 2 2 L -1 2 L -1 -1' );

ClippingFunctor.prototype.perform = function( nT, nWidth, nHeight )
{
var aClipPoly = this.aParametricPolyPolygon.perform( this.bForwardParameterSweep ? nT : (1 - nT) );


if( this.bSubtractPolygon )
{
aClipPoly.changeOrientation();
aClipPoly.prependPath( ClippingFunctor.aBoundingPath );
}

var aMatrix;
if( this.bScaleIsotropically )
{
var nScaleFactor = Math.max( nWidth, nHeight );
aMatrix = SVGIdentityMatrix.translate( -( nScaleFactor - nWidth ) / 2.0,
-( nScaleFactor - nHeight ) / 2.0 );
aMatrix = aMatrix.scale( nScaleFactor );
aMatrix = aMatrix.multiply( this.aStaticTransformation );
}
else
{
aMatrix = SVGIdentityMatrix.scaleNonUniform( nWidth, nHeight );
aMatrix = aMatrix.multiply( this.aStaticTransformation );
}

aClipPoly.matrixTransform( aMatrix );

return aClipPoly;
};


function createClipPolyPolygon( nType, nSubtype )
{
switch( nType )
{
default:
log( 'createClipPolyPolygon: unknown transition type: ' + nType );
return null;
case BARWIPE_TRANSITION:
return new BarWipePath( 1 );
case FOURBOXWIPE_TRANSITION:
return new FourBoxWipePath( nSubtype === CORNERSOUT_TRANS_SUBTYPE );
case ELLIPSEWIPE_TRANSITION:
return new EllipseWipePath( nSubtype );
case PINWHEELWIPE_TRANSITION:
var nBlades;
switch( nSubtype )
{
case ONEBLADE_TRANS_SUBTYPE:
nBlades = 1;
break;
case DEFAULT_TRANS_SUBTYPE:
case TWOBLADEVERTICAL_TRANS_SUBTYPE:
nBlades = 2;
break;
case TWOBLADEHORIZONTAL_TRANS_SUBTYPE:
nBlades = 2;
break;
case THREEBLADE_TRANS_SUBTYPE:
nBlades = 3;
break;
case FOURBLADE_TRANS_SUBTYPE:
nBlades = 4;
break;
case EIGHTBLADE_TRANS_SUBTYPE:
nBlades = 8;
break;
default:
log( 'createClipPolyPolygon: unknown subtype: ' + nSubtype );
return null;
}
return new PinWheelWipePath( nBlades );
case RANDOMBARWIPE_TRANSITION:
return new RandomWipePath( 128, true /* bars */ );
case CHECKERBOARDWIPE_TRANSITION:
return new CheckerBoardWipePath( 10 );
case DISSOLVE_TRANSITION:
return new RandomWipePath( 16 * 16, false /* dissolve */ );
}
}


function createUnitSquarePath()
{
var aPath = document.createElementNS( NSS['svg'], 'path' );
var sD = 'M 0 0 L 1 0 L 1 1 L 0 1 L 0 0';
aPath.setAttribute( 'd', sD );
return aPath;
}

function createEmptyPath()
{
var aPath = document.createElementNS( NSS['svg'], 'path' );
var sD = 'M 0 0 L 0 0';
aPath.setAttribute( 'd', sD );
return aPath;
}

function pruneScaleValue( nVal )
{
if( nVal < 0.0 )
return (nVal < -0.00001 ? nVal : -0.00001);
else
return (nVal > 0.00001 ? nVal : 0.00001);
}


function BarWipePath( nBars /* nBars > 1: blinds effect */ )
{
this.nBars = nBars;
if( this.nBars === undefined || this.nBars < 1 )
this.nBars = 1;
this.aBasePath = createUnitSquarePath();
}

BarWipePath.prototype.perform = function( nT )
{

var aMatrix = SVGIdentityMatrix.scaleNonUniform( pruneScaleValue( nT / this.nBars ), 1.0 );

var aPolyPath = this.aBasePath.cloneNode( true );
aPolyPath.matrixTransform( aMatrix );

if( this.nBars > 1 )
{
var i;
var aTransform;
var aPath;
for( i = this.nBars - 1; i > 0; --i )
{
aTransform = SVGIdentityMatrix.translate( i / this.nBars, 0.0 );
aTransform = aTransform.multiply( aMatrix );
aPath = this.aBasePath.cloneNode( true );
aPath.matrixTransform( aTransform );
aPolyPath.appendPath( aPath );
}
}
return aPolyPath;
};


function FourBoxWipePath( bCornersOut )
{
this.bCornersOut = bCornersOut;
this.aBasePath = createUnitSquarePath();
}

FourBoxWipePath.prototype.perform = function( nT )
{
var aMatrix;
var d = pruneScaleValue( nT / 2.0 );

if( this.bCornersOut )
{
aMatrix = SVGIdentityMatrix.translate( -0.25, -0.25 ).scale( d ).translate( -0.5, -0.5 );
}
else
{
aMatrix = SVGIdentityMatrix.translate( -0.5, -0.5 ).scale( d );
}


var aTransform = aMatrix;
var aSquare = this.aBasePath.cloneNode( true );
aSquare.matrixTransform( aTransform );
var aPolyPath = aSquare;
aMatrix = SVGIdentityMatrix.flipY();
aTransform = aMatrix.multiply( aTransform );
aSquare = this.aBasePath.cloneNode( true );
aSquare.matrixTransform( aTransform );
aSquare.changeOrientation();
aPolyPath.appendPath( aSquare );
aMatrix = SVGIdentityMatrix.flipX();
aTransform = aMatrix.multiply( aTransform );
aSquare = this.aBasePath.cloneNode( true );
aSquare.matrixTransform( aTransform );
aPolyPath.appendPath( aSquare );
aMatrix = SVGIdentityMatrix.flipY();
aTransform = aMatrix.multiply( aTransform );
aSquare = this.aBasePath.cloneNode( true );
aSquare.matrixTransform( aTransform );
aSquare.changeOrientation();
aPolyPath.appendPath( aSquare );

aMatrix = SVGIdentityMatrix.translate( 0.5, 0.5 );
aMatrix = aMatrix.scale( 1.1 );
aPolyPath.matrixTransform( aMatrix );

return aPolyPath;
};


function EllipseWipePath( eSubtype )
{
this.eSubtype = eSubtype;

var sPathData = 'M 0.5 -0.207107 ' +
'C 0.687536 -0.207107 0.867392 -0.132608 1 0 ' +
'C 1.13261 0.132608 1.20711 0.312464 1.20711 0.5 ' +
'C 1.20711 0.687536 1.13261 0.867392 1 1 ' +
'C 0.867392 1.13261 0.687536 1.20711 0.5 1.20711 ' +
'C 0.312464 1.20711 0.132608 1.13261 0 1 ' +
'C -0.132608 0.867392 -0.207107 0.687536 -0.207107 0.5 ' +
'C -0.207107 0.312464 -0.132608 0.132608 0 0 ' +
'C 0.132608 -0.132608 0.312464 -0.207107 0.5 -0.207107';

this.aBasePath = document.createElementNS( NSS['svg'], 'path' );
this.aBasePath.setAttribute( 'd', sPathData );
}

EllipseWipePath.prototype.perform = function( nT )
{

var aTransform = SVGIdentityMatrix.translate( 0.5, 0.5 ).scale( nT ).translate( -0.5, -0.5 );
var aEllipse = this.aBasePath.cloneNode( true );
aEllipse.matrixTransform( aTransform );

return aEllipse;
};


function PinWheelWipePath( nBlades )
{
this.nBlades = nBlades;
if( !this.nBlades || this.nBlades < 1 )
this.nBlades = 1;
}

PinWheelWipePath.calcCenteredClock = function( nT, nE )
{
var nMAX_EDGE = 2;

var aTransform = SVGIdentityMatrix.rotate( nT * 360 );

var aPoint = document.documentElement.createSVGPoint();
aPoint.y = -nMAX_EDGE;
aPoint = aPoint.matrixTransform( aTransform );

var sPathData = 'M ' + aPoint.x + ' ' + aPoint.y + ' ';
if( nT >= 0.875 )
sPathData += 'L ' + '-' + nE + ' -' + nE + ' ';
if( nT >= 0.625 )
sPathData += 'L ' + '-' + nE + ' ' + nE + ' ';
if( nT >= 0.375 )
sPathData += 'L ' + nE + ' ' + nE + ' ';
if( nT >= 0.125 )
sPathData += 'L ' + nE + ' -' + nE + ' ';

sPathData += 'L 0 -' + nE + ' ';
sPathData += 'L 0 0 ';
sPathData += 'L '  + aPoint.x + ' ' + aPoint.y;

var aPath = document.createElementNS( NSS['svg'], 'path' );
aPath.setAttribute( 'd', sPathData );
return aPath;
};

PinWheelWipePath.prototype.perform = function( nT )
{
var aBasePath = PinWheelWipePath.calcCenteredClock( nT / this.nBlades,
2.0 /* max edge when rotating */  );

var aPolyPath = aBasePath.cloneNode( true );
var aPath;
var aRotation;
var i;
for( i = this.nBlades - 1; i > 0; --i )
{
aRotation = SVGIdentityMatrix.rotate( (i * 360) / this.nBlades );
aPath = aBasePath.cloneNode( true );
aPath.matrixTransform( aRotation );
aPolyPath.appendPath( aPath );
}

var aTransform = SVGIdentityMatrix.translate( 0.5, 0.5 ).scale( 0.5 );
aPolyPath.matrixTransform( aTransform );

return aPolyPath;
};


function CheckerBoardWipePath( unitsPerEdge )
{
this.unitsPerEdge = unitsPerEdge;
if( this.unitsPerEdge === undefined || this.unitsPerEdge < 1 )
this.unitsPerEdge = 10;
this.aBasePath = createUnitSquarePath();
}

CheckerBoardWipePath.prototype.perform = function( nT )
{
var d = pruneScaleValue(1.0 / this.unitsPerEdge);
var aMatrix = SVGIdentityMatrix.scaleNonUniform(pruneScaleValue( d*2.0*nT ),
pruneScaleValue( d ) );

var aPolyPath = null;
var i, j;
var aTransform;
var aPath;
for ( i = this.unitsPerEdge; i--; )
{
aTransform = SVGIdentityMatrix;

if ((i % 2) == 1) // odd line
aTransform = aTransform.translate( -d, 0.0 );

aTransform = aTransform.multiply( aMatrix );

for ( j = (this.unitsPerEdge / 2) + 1; j--;)
{
aPath = this.aBasePath.cloneNode( true );
aPath.matrixTransform( aTransform );
if (aPolyPath == null) aPolyPath = aPath;
else aPolyPath.appendPath( aPath );
aTransform = SVGIdentityMatrix.translate( d*2.0, 0.0 ).multiply( aTransform );
}

aMatrix = SVGIdentityMatrix.translate( 0.0, d ).multiply( aMatrix ); // next line
}

return aPolyPath;
};


function RandomWipePath( nElements, bRandomBars )
{
this.nElements = nElements;
this.aBasePath = createUnitSquarePath();
this.aPositionArray = new Array( nElements );
this.aClipPath = createEmptyPath();
this.nAlreadyAppendedElements = 0;

var fEdgeLength, nPos, aTransform;

if( bRandomBars ) // random bar wipe
{
fEdgeLength = 1.0 / nElements;
for( nPos = 0; nPos < nElements; ++nPos )
{
this.aPositionArray[nPos] = { x: 0.0, y: pruneScaleValue( nPos * fEdgeLength ) }
}
aTransform = SVGIdentityMatrix.scaleNonUniform( 1.0, pruneScaleValue( fEdgeLength ) );
}
else // dissolve wipe
{
var nSqrtElements = Math.round( Math.sqrt( nElements ) );
fEdgeLength = 1.0 / nSqrtElements;
for( nPos = 0; nPos < nElements; ++nPos )
{
this.aPositionArray[nPos] = {
x: pruneScaleValue( ( nPos % nSqrtElements ) * fEdgeLength ),
y: pruneScaleValue( ( nPos / nSqrtElements ) * fEdgeLength ) }
}
aTransform = SVGIdentityMatrix.scale( pruneScaleValue( fEdgeLength ) );
}
this.aBasePath.matrixTransform( aTransform );

var nPos1, nPos2;
var tmp;
for( nPos1 = nElements - 1; nPos1 > 0; --nPos1 )
{
nPos2 = getRandomInt( nPos1 + 1 );
tmp = this.aPositionArray[nPos1];
this.aPositionArray[nPos1] = this.aPositionArray[nPos2];
this.aPositionArray[nPos2] = tmp;
}
}

RandomWipePath.prototype.perform = function( nT )
{
var aPolyPath = createEmptyPath();
var aPoint;
var aPath;
var aTransform;
var nElements = Math.round( nT * this.nElements );
if( nElements === 0 )
{
return aPolyPath;
}
if( this.nAlreadyAppendedElements >= nElements )
{
this.nAlreadyAppendedElements = 0;
this.aClipPath = createEmptyPath();
}
var nPos;
for( nPos = this.nAlreadyAppendedElements; nPos < nElements; ++nPos )
{
aPoint = this.aPositionArray[nPos];
aPath = this.aBasePath.cloneNode( true );
aTransform = SVGIdentityMatrix.translate( aPoint.x, aPoint.y );
aPath.matrixTransform( aTransform );
aPolyPath.appendPath( aPath );
}

this.nAlreadyAppendedElements = nElements;
this.aClipPath.appendPath( aPolyPath );

return this.aClipPath.cloneNode( true );
};


function AnimatedSlide( aMetaSlide )
{
if( !aMetaSlide )
{
log( 'AnimatedSlide constructor: meta slide is not valid' );
}

this.aMetaSlide = aMetaSlide;
this.aSlideElement = this.aMetaSlide.slideElement;
this.sSlideId = this.aMetaSlide.slideId;

this.aUsedAttributeSet = [];

this.aClipPathElement = null;
this.aClipPathContent = null;
this.bIsClipped = false;
}

AnimatedSlide.prototype.show = function()
{
this.aMetaSlide.show();
};

AnimatedSlide.prototype.hide = function()
{
this.aMetaSlide.hide();
};

AnimatedSlide.prototype.notifyUsedAttribute = function( sName )
{
if( sName == 'clip-path' )
{
this.initClipPath();
this.bIsClipped = true;
}
else
{
this.aUsedAttributeSet.push( sName );
}
};

AnimatedSlide.prototype.reset = function()
{
if( this.bIsClipped )
{
this.cleanClipPath();
this.bIsClipped = false;
}

var i;
for( i = 0; i < this.aUsedAttributeSet.length; ++i )
{
var sAttrName = this.aUsedAttributeSet[i];
this.aSlideElement.removeAttribute( sAttrName );
}
this.aUsedAttributeSet = [];
};

AnimatedSlide.prototype.initClipPath = function()
{
this.aClipPathElement = document.createElementNS( NSS['svg'], 'clipPath' );

var sId = 'clip-path-' + this.sSlideId;
this.aClipPathElement.setAttribute( 'id', sId );
this.aClipPathElement.setAttribute( 'clipPathUnits', 'userSpaceOnUse' );

this.aClipPathContent = document.createElementNS( NSS['svg'], 'path' );
var sPathData = 'M 0 0 h ' + WIDTH + ' v ' + HEIGHT + ' h -' + WIDTH + ' z';
this.aClipPathContent.setAttribute( 'd', sPathData );
this.aClipPathElement.appendChild( this.aClipPathContent );

var aClipPathGroup = theMetaDoc.aClipPathGroup;
aClipPathGroup.appendChild( this.aClipPathElement );

var sRef = 'url(#' + sId + ')';
this.aSlideElement.parentNode.setAttribute( 'clip-path', sRef );
};

AnimatedSlide.prototype.cleanClipPath = function()
{
this.aSlideElement.parentNode.removeAttribute( 'clip-path' );

if( this.aClipPathElement )
{
var aClipPathGroup = theMetaDoc.aClipPathGroup;
aClipPathGroup.removeChild( this.aClipPathElement );
this.aClipPathElement = null;
this.aClipPathContent = null;
}
};

AnimatedSlide.prototype.insertBefore = function( aElement )
{
if( aElement )
{
this.aSlideElement.parentNode.insertBefore( aElement, this.aSlideElement );
}
};

AnimatedSlide.prototype.appendElement = function( aElement )
{
if( aElement )
{
this.aSlideElement.parentNode.appendChild( aElement );
}
};

AnimatedSlide.prototype.removeElement = function( aElement )
{
if( aElement )
{
this.aSlideElement.parentNode.removeChild( aElement );
}
};

AnimatedSlide.prototype.getWidth = function()
{
return WIDTH;
};

AnimatedSlide.prototype.getHeight = function()
{
return HEIGHT;
};

AnimatedSlide.prototype.setOpacity = function( nValue )
{
this.aSlideElement.setAttribute( 'opacity', nValue );
};

AnimatedSlide.prototype.translate = function( nDx, nDy )
{
var sTransformAttr = 'translate(' + nDx + ',' + nDy + ')';
this.aSlideElement.setAttribute( 'transform', sTransformAttr );
};

AnimatedSlide.prototype.setClipPath = function( aClipPathContent )
{
if( this.aClipPathContent )
{
var sPathData = aClipPathContent.getAttribute( 'd' );
this.aClipPathContent.setAttribute( 'd', sPathData );
}
};


function AnimatedElement( aElement )
{
if( !aElement )
{
log( 'AnimatedElement constructor: element is not valid' );
}

this.aSlideShowContext = null;

this.aBaseElement = aElement.cloneNode( true );
this.aActiveElement = aElement;
this.sElementId = this.aActiveElement.getAttribute( 'id' );

this.aBaseBBox = this.aActiveElement.getBBox();
this.nBaseCenterX = this.aBaseBBox.x + this.aBaseBBox.width / 2;
this.nBaseCenterY = this.aBaseBBox.y + this.aBaseBBox.height / 2;


this.aClipPathElement = null;
this.aClipPathContent = null;

this.aPreviousElement = null;
this.aStateSet = {};

this.eAdditiveMode = ADDITIVE_MODE_REPLACE;
this.bIsUpdated = true;

this.aTMatrix = document.documentElement.createSVGMatrix();
this.aCTM = document.documentElement.createSVGMatrix();
this.aICTM = document.documentElement.createSVGMatrix();

this.initElement();
}

AnimatedElement.prototype.initElement = function()
{
this.nCenterX = this.nBaseCenterX;
this.nCenterY = this.nBaseCenterY;
this.nScaleFactorX = 1.0;
this.nScaleFactorY = 1.0;

this.aActiveElement.setAttribute( 'transform', makeMatrixString( 1, 0, 0, 1, 0, 0 ) );
};

AnimatedElement.prototype.initClipPath = function()
{
this.aClipPathElement = document.createElementNS( NSS['svg'], 'clipPath' );

var sId = 'clip-path-' + this.sElementId;
this.aClipPathElement.setAttribute( 'id', sId );
this.aClipPathElement.setAttribute( 'clipPathUnits', 'userSpaceOnUse' );

this.aClipPathContent = document.createElementNS( NSS['svg'], 'path' );
this.aClippingBBox = this.getBBoxWithStroke();
var nWidth = this.aClippingBBox.width;
var nHeight = this.aClippingBBox.height;
var sPathData = 'M ' + this.aClippingBBox.x + ' ' + this.aClippingBBox.y +
' h ' + nWidth + ' v ' + nHeight + ' h -' + nWidth + ' z';
this.aClipPathContent.setAttribute( 'd', sPathData );
this.aClipPathElement.appendChild( this.aClipPathContent );

var aClipPathGroup = theMetaDoc.aClipPathGroup;
aClipPathGroup.appendChild( this.aClipPathElement );

var sRef = 'url(#' + sId + ')';
this.aActiveElement.setAttribute( 'clip-path', sRef );
};

AnimatedElement.prototype.cleanClipPath = function()
{
this.aActiveElement.removeAttribute( 'clip-path' );

if( this.aClipPathElement )
{
var aClipPathGroup = theMetaDoc.aClipPathGroup;
aClipPathGroup.removeChild( this.aClipPathElement );
this.aClipPathElement = null;
this.aClipPathContent = null;
}
};

AnimatedElement.prototype.getId = function()
{
return this.aActiveElement.getAttribute( 'id' );
};

AnimatedElement.prototype.getAdditiveMode = function()
{
return this.eAdditiveMode;
};

AnimatedElement.prototype.setAdditiveMode = function( eAdditiveMode )
{
this.eAdditiveMode = eAdditiveMode;
};

AnimatedElement.prototype.setToElement = function( aElement )
{
if( !aElement )
{
log( 'AnimatedElement(' + this.getId() + ').setToElement: element is not valid' );
return false;
}

var aClone = aElement.cloneNode( true );
this.aPreviousElement = this.aActiveElement.parentNode.replaceChild( aClone, this.aActiveElement );
this.aActiveElement = aClone;

return true;
};

AnimatedElement.prototype.notifySlideStart = function( aSlideShowContext )
{
if( !aSlideShowContext )
{
log( 'AnimatedElement.notifySlideStart: slideshow context is not valid' );
}
this.aSlideShowContext = aSlideShowContext;

var aClone = this.aBaseElement.cloneNode( true );
this.aActiveElement.parentNode.replaceChild( aClone, this.aActiveElement );
this.aActiveElement = aClone;

this.initElement();
this.DBG( '.notifySlideStart invoked' );
};

AnimatedElement.prototype.notifySlideEnd = function()
{
};

AnimatedElement.prototype.notifyAnimationStart = function()
{
};

AnimatedElement.prototype.notifyAnimationEnd = function()
{
};

AnimatedElement.prototype.notifyNextEffectStart = function( nEffectIndex )
{
};

AnimatedElement.prototype.saveState = function( nAnimationNodeId )
{
ANIMDBG.print( 'AnimatedElement(' + this.getId() + ').saveState(' + nAnimationNodeId +')' );
if( !this.aStateSet[ nAnimationNodeId ] )
{
this.aStateSet[ nAnimationNodeId ] = {};
}
var aState = this.aStateSet[ nAnimationNodeId ];
aState.aElement = this.aActiveElement.cloneNode( true );
aState.nCenterX = this.nCenterX;
aState.nCenterY = this.nCenterY;
aState.nScaleFactorX = this.nScaleFactorX;
aState.nScaleFactorY = this.nScaleFactorY;

};

AnimatedElement.prototype.restoreState = function( nAnimationNodeId )
{
if( !this.aStateSet[ nAnimationNodeId ] )
{
log( 'AnimatedElement(' + this.getId() + ').restoreState: state '
+nAnimationNodeId  + ' is not valid' );
return false;
}

ANIMDBG.print( 'AnimatedElement(' + this.getId() + ').restoreState(' + nAnimationNodeId +')' );
var aState = this.aStateSet[ nAnimationNodeId ];
var bRet = this.setToElement( aState.aElement );
if( bRet )
{
this.nCenterX = aState.nCenterX;
this.nCenterY = aState.nCenterY;
this.nScaleFactorX = aState.nScaleFactorX;
this.nScaleFactorY = aState.nScaleFactorY;
}
return bRet;
};

AnimatedElement.prototype.getBaseBBox = function()
{
return this.aBaseBBox;
};

AnimatedElement.prototype.getBaseCenterX = function()
{
return this.nBaseCenterX;
};

AnimatedElement.prototype.getBaseCenterY = function()
{
return this.nBaseCenterY;
};

AnimatedElement.prototype.getBBox = function()
{
return this.aActiveElement.parentNode.getBBox();
};

AnimatedElement.prototype.getBBoxWithStroke = function()
{
var aBBox = this.aActiveElement.parentNode.getBBox();

var aChildrenSet = this.aActiveElement.childNodes;

var sStroke, sStrokeWidth;
var nStrokeWidth = 0;
var i;
for( i = 0; i < aChildrenSet.length; ++i )
{
if( ! aChildrenSet[i].getAttribute  )
continue;

sStroke = aChildrenSet[i].getAttribute( 'stroke' );
if( sStroke && sStroke != 'none' )
{
sStrokeWidth = aChildrenSet[i].getAttribute( 'stroke-width' );
var nSW = parseFloat( sStrokeWidth );
if( nSW > nStrokeWidth )
nStrokeWidth = nSW;
}
}

if( nStrokeWidth == 0 )
{
sStrokeWidth = ROOT_NODE.getAttribute( 'stroke-width' );
nStrokeWidth = parseFloat( sStrokeWidth );
}
if( nStrokeWidth != 0 )
{
nStrokeWidth *= 1.1;
var nHalfStrokeWidth = nStrokeWidth / 2;
var nDoubleStrokeWidth = nStrokeWidth * 2;

var aEBBox = document.documentElement.createSVGRect();
aEBBox.x = aBBox.x - nHalfStrokeWidth;
aEBBox.y = aBBox.y - nHalfStrokeWidth;
aEBBox.width = aBBox.width + nDoubleStrokeWidth;
aEBBox.height = aBBox.height + nDoubleStrokeWidth;
aBBox = aEBBox;
}
return aBBox;
};

AnimatedElement.prototype.setClipPath = function( aClipPathContent )
{
if( this.aClipPathContent )
{
var aTranslation = SVGIdentityMatrix.translate( this.aClippingBBox.x,
this.aClippingBBox.y);
aClipPathContent.matrixTransform( aTranslation );
var sPathData = aClipPathContent.getAttribute( 'd' );
this.aClipPathContent.setAttribute( 'd', sPathData );
}
};


AnimatedElement.prototype.getX = function()
{
return this.nCenterX;
};

AnimatedElement.prototype.getY = function()
{
return this.nCenterY;
};

AnimatedElement.prototype.getWidth = function()
{
return this.nScaleFactorX * this.getBaseBBox().width;
};

AnimatedElement.prototype.getHeight = function()
{
return this.nScaleFactorY * this.getBaseBBox().height;
};

AnimatedElement.prototype.updateTransformAttribute = function()
{
this.aTransformAttrList = this.aActiveElement.transform.baseVal;
this.aTransformAttr = this.aTransformAttrList.getItem( 0 );
this.aTransformAttr.setMatrix( this.aTMatrix );
};

AnimatedElement.prototype.setX = function( nNewCenterX )
{
if( nNewCenterX === this.nCenterX ) return;

this.aTransformAttrList = this.aActiveElement.transform.baseVal;
this.aTransformAttr = this.aTransformAttrList.getItem( 0 );
this.aTMatrix = this.aTransformAttr.matrix.translate( nNewCenterX - this.nCenterX, 0 );
this.aTransformAttr.setMatrix( this.aTMatrix );
this.nCenterX = nNewCenterX;
};

AnimatedElement.prototype.setY = function( nNewCenterY )
{
if( nNewCenterY === this.nCenterY ) return;

this.aTransformAttrList = this.aActiveElement.transform.baseVal;
this.aTransformAttr = this.aTransformAttrList.getItem( 0 );
this.aTMatrix = this.aTransformAttr.matrix.translate( 0, nNewCenterY - this.nCenterY );
this.aTransformAttr.setMatrix( this.aTMatrix );
this.nCenterY = nNewCenterY;
};

AnimatedElement.prototype.setWidth = function( nNewWidth )
{
ANIMDBG.print( 'AnimatedElement.setWidth: nNewWidth = ' + nNewWidth );
if( nNewWidth < 0 )
{
log('AnimatedElement(' + this.getId() + ').setWidth: negative height!');
nNewWidth = 0;
}

var nBaseWidth = this.getBaseBBox().width;
var nScaleFactorX = nNewWidth / nBaseWidth;

if( nScaleFactorX < 1e-5 ) nScaleFactorX = 1e-5;
if( nScaleFactorX == this.nScaleFactorX ) return;

this.aTMatrix = document.documentElement.createSVGMatrix()
.translate( this.nCenterX, this.nCenterY )
.scaleNonUniform( nScaleFactorX, this.nScaleFactorY )
.translate( -this.nBaseCenterX, -this.nBaseCenterY );
this.updateTransformAttribute();

this.nScaleFactorX = nScaleFactorX;
};

AnimatedElement.prototype.setHeight = function( nNewHeight )
{
ANIMDBG.print( 'AnimatedElement.setWidth: nNewHeight = ' + nNewHeight );
if( nNewHeight < 0 )
{
log('AnimatedElement(' + this.getId() + ').setWidth: negative height!');
nNewHeight = 0;
}

var nBaseHeight = this.getBaseBBox().height;
var nScaleFactorY = nNewHeight / nBaseHeight;

if( nScaleFactorY < 1e-5 ) nScaleFactorY = 1e-5;
if( nScaleFactorY == this.nScaleFactorY ) return;

this.aTMatrix = document.documentElement.createSVGMatrix()
.translate( this.nCenterX, this.nCenterY )
.scaleNonUniform( this.nScaleFactorX, nScaleFactorY )
.translate( -this.nBaseCenterX, -this.nBaseCenterY );
this.updateTransformAttribute();

this.nScaleFactorY = nScaleFactorY;
};

AnimatedElement.prototype.getOpacity = function()
{
return this.aActiveElement.getAttribute( 'opacity' );
};

AnimatedElement.prototype.setOpacity = function( nValue )
{
this.aActiveElement.setAttribute( 'opacity', nValue );
};

AnimatedElement.prototype.getVisibility = function()
{

var sVisibilityValue = this.aActiveElement.getAttribute( 'visibility' );
if( !sVisibilityValue || ( sVisibilityValue === 'inherit' ) )
return 'visible'; // TODO: look for parent visibility!
else
return sVisibilityValue;
};

AnimatedElement.prototype.setVisibility = function( sValue )
{
if( sValue == 'visible' )
sValue = 'inherit';
this.aActiveElement.setAttribute( 'visibility', sValue );
};

AnimatedElement.prototype.getStrokeStyle = function()
{
return 'solid';
};

AnimatedElement.prototype.setStrokeStyle = function( sValue )
{
ANIMDBG.print( 'AnimatedElement.setStrokeStyle(' + sValue + ')' );
};

AnimatedElement.prototype.getFillStyle = function()
{
return 'solid';
};

AnimatedElement.prototype.setFillStyle = function( sValue )
{
ANIMDBG.print( 'AnimatedElement.setFillStyle(' + sValue + ')' );
};

AnimatedElement.prototype.getFillColor = function()
{
var aChildSet = getElementChildren( this.aActiveElement );
var sFillColorValue = '';
for( var i = 0; i <  aChildSet.length; ++i )
{
sFillColorValue = aChildSet[i].getAttribute( 'fill' );
if( sFillColorValue && ( sFillColorValue !== 'none' ) )
break;
}

return colorParser( sFillColorValue );
};

AnimatedElement.prototype.setFillColor = function( aRGBValue )
{
assert( aRGBValue instanceof RGBColor,
'AnimatedElement.setFillColor: value argument is not an instance of RGBColor' );

var sValue = aRGBValue.toString( true /* clamped values */ );
var aChildSet = getElementChildren( this.aActiveElement );

var sFillColorValue = '';
for( var i = 0; i <  aChildSet.length; ++i )
{
sFillColorValue = aChildSet[i].getAttribute( 'fill' );
if( sFillColorValue && ( sFillColorValue !== 'none' ) )
{
aChildSet[i].setAttribute( 'fill', sValue );
}
}
};

AnimatedElement.prototype.getStrokeColor = function()
{
var aChildSet = getElementChildren( this.aActiveElement );
var sStrokeColorValue = '';
for( var i = 0; i <  aChildSet.length; ++i )
{
sStrokeColorValue = aChildSet[i].getAttribute( 'stroke' );
if( sStrokeColorValue && ( sStrokeColorValue !== 'none' ) )
break;
}

return colorParser( sStrokeColorValue );
};

AnimatedElement.prototype.setStrokeColor = function( aRGBValue )
{
assert( aRGBValue instanceof RGBColor,
'AnimatedElement.setFillColor: value argument is not an instance of RGBColor' );

var sValue = aRGBValue.toString( true /* clamped values */ );
var aChildSet = getElementChildren( this.aActiveElement );

var sStrokeColorValue = '';
for( var i = 0; i <  aChildSet.length; ++i )
{
sStrokeColorValue = aChildSet[i].getAttribute( 'stroke' );
if( sStrokeColorValue && ( sStrokeColorValue !== 'none' ) )
{
aChildSet[i].setAttribute( 'stroke', sValue );
}
}
};

AnimatedElement.prototype.getFontColor = function()
{
return new RGBColor( 0, 0, 0 );
};

AnimatedElement.prototype.setFontColor = function( sValue )
{
ANIMDBG.print( 'AnimatedElement.setFontColor(' + sValue + ')' );
};

AnimatedElement.prototype.DBG = function( sMessage, nTime )
{
aAnimatedElementDebugPrinter.print( 'AnimatedElement(' + this.getId() + ')' + sMessage, nTime );
};


function AnimatedTextElement( aElement, aEventMultiplexer )
{
var theDocument = document;

var sTextType = aElement.getAttribute( 'class' );
var bIsListItem = ( sTextType === 'ListItem' );
if( ( sTextType !== 'TextParagraph' ) && !bIsListItem )
{
log( 'AnimatedTextElement: passed element is not a paragraph.' );
return;
}
var aTextShapeElement = aElement.parentNode;
sTextType = aTextShapeElement.getAttribute( 'class' );
if( sTextType !== 'TextShape' )
{
log( 'AnimatedTextElement: element parent is not a text shape.' );
return;
}
var aTextShapeGroup = aTextShapeElement.parentNode;
var aAnimatedElementGroup = getElementByClassName( aTextShapeGroup, 'AnimatedElements' );
if( !aAnimatedElementGroup )
{
aAnimatedElementGroup = theDocument.createElementNS( NSS['svg'], 'g' );
aAnimatedElementGroup.setAttribute( 'class', 'AnimatedElements' );
aTextShapeGroup.appendChild( aAnimatedElementGroup );
}

var aAnimatableElement = theDocument.createElementNS( NSS['svg'], 'g' );
var aTextElement = theDocument.createElementNS( NSS['svg'], 'text' );
var aParagraphElement = aElement.cloneNode( true );

this.aGraphicGroupElement = theDocument.createElementNS( NSS['svg'], 'g' );
this.aGraphicGroupElement.setAttribute( 'class', 'GraphicGroup' );

var aBulletCharClone = null;
var aBulletCharElem = null;
var bIsBulletCharStyle =
( aElement.getAttributeNS( NSS['ooo'], aOOOAttrListItemNumberingType ) === 'bullet-style' );
if( bIsBulletCharStyle )
{
var aBulletCharGroupElem = getElementByClassName( aTextShapeGroup, 'BulletChars' );
if( aBulletCharGroupElem )
{
var aBulletPlaceholderElem = getElementByClassName( aElement, 'BulletPlaceholder' );
if( aBulletPlaceholderElem )
{
var sId = aBulletPlaceholderElem.getAttribute( 'id' );
sId = 'bullet-char(' + sId + ')';
aBulletCharElem = theDocument.getElementById( sId );
if( aBulletCharElem )
{
aBulletCharClone = aBulletCharElem.cloneNode( true );
}
else
{
log( 'AnimatedTextElement: ' + sId + ' not found.' );
}
}
else
{
log( 'AnimatedTextElement: no bullet placeholder found' );
}
}
else
{
log( 'AnimatedTextElement: no bullet char group found' );
}
}

var aBitmapElemSet = [];
var aBitmapCloneSet = [];
var aBitmapPlaceholderSet = getElementsByClassName( aElement, 'BitmapPlaceholder' );
var i;
if( aBitmapPlaceholderSet )
{
for( i = 0; i < aBitmapPlaceholderSet.length; ++i )
{
sId = aBitmapPlaceholderSet[i].getAttribute( 'id' );
var sBitmapChecksum = sId.substring( 'bitmap-placeholder'.length + 1, sId.length - 1 );
sId = 'embedded-bitmap(' + sBitmapChecksum + ')';
aBitmapElemSet[i] = theDocument.getElementById( sId );
if( aBitmapElemSet[i] )
{
aBitmapCloneSet[i] = aBitmapElemSet[i].cloneNode( true );
}
else
{
log( 'AnimatedTextElement: ' + sId + ' not found.' );
}
}
}


this.sParagraphId = sId = aParagraphElement.getAttribute( 'id' );
aParagraphElement.removeAttribute( 'id' );
aAnimatableElement.setAttribute( 'id', sId +'.a' );
if( aBulletCharClone )
aBulletCharClone.removeAttribute( 'id' );
for( i = 0; i < aBitmapCloneSet.length; ++i )
{
if( aBitmapCloneSet[i] )
aBitmapCloneSet[i].removeAttribute( 'id' );
}

var sVisibilityAttr = aElement.getAttribute( 'visibility' );
if( !sVisibilityAttr )
sVisibilityAttr = 'inherit';
aAnimatableElement.setAttribute( 'visibility', sVisibilityAttr );
aParagraphElement.setAttribute( 'visibility', 'inherit' );
this.aGraphicGroupElement.setAttribute( 'visibility', 'inherit' );
if( aBulletCharElem )
aBulletCharElem.setAttribute( 'visibility', 'hidden' );
for( i = 0; i < aBitmapCloneSet.length; ++i )
{
if( aBitmapElemSet[i] )
aBitmapElemSet[i].setAttribute( 'visibility', 'hidden' );
}


aTextElement.appendChild( aParagraphElement );
aAnimatableElement.appendChild( aTextElement );

if( aBulletCharClone )
this.aGraphicGroupElement.appendChild( aBulletCharClone );
for( i = 0; i < aBitmapCloneSet.length; ++i )
{
if( aBitmapCloneSet[i] )
this.aGraphicGroupElement.appendChild( aBitmapCloneSet[i] );
}
aAnimatableElement.appendChild( this.aGraphicGroupElement );
aAnimatedElementGroup.appendChild( aAnimatableElement );

this.aParentTextElement = aElement.parentNode;
this.aParagraphElement = aElement;
this.aAnimatedElementGroup = aAnimatedElementGroup;
this.nRunningAnimations = 0;

this.aHyperlinkIdSet = [];
var aHyperlinkElementSet = getElementsByClassName( this.aParagraphElement, 'UrlField' );
var sHyperlinkId;
for( i = 0; i < aHyperlinkElementSet.length; ++i )
{
sHyperlinkId = aHyperlinkElementSet[i].getAttribute( 'id' );
if( sHyperlinkId )
this.aHyperlinkIdSet.push( sHyperlinkId );
else
log( 'error: AnimatedTextElement constructor: hyperlink element has no id' );
}

AnimatedTextElement.superclass.constructor.call( this, aAnimatableElement, aEventMultiplexer );

}
extend( AnimatedTextElement, AnimatedElement );


AnimatedTextElement.prototype.setToElement = function( aElement )
{
var bRet = AnimatedTextElement.superclass.setToElement.call( this, aElement );
if( bRet )
{
this.aGraphicGroupElement = getElementByClassName( this.aActiveElement, 'GraphicGroup' );
}
return ( bRet && this.aGraphicGroupElement );
};

AnimatedTextElement.prototype.notifySlideStart = function( aSlideShowContext )
{
DBGLOG( 'AnimatedTextElement.notifySlideStart' );
AnimatedTextElement.superclass.notifySlideStart.call( this, aSlideShowContext );
this.aGraphicGroupElement = getElementByClassName( this.aActiveElement, 'GraphicGroup' );
this.restoreBaseTextParagraph();
};

AnimatedTextElement.prototype.notifySlideEnd = function()
{
DBGLOG( 'AnimatedTextElement.notifySlideEnd' );
this.aGraphicGroupElement.setAttribute( 'visibility', 'inherit' );
};

AnimatedTextElement.prototype.restoreBaseTextParagraph = function()
{
var aActiveParagraphElement = this.aActiveElement.firstElementChild.firstElementChild;
if( aActiveParagraphElement )
{
var sVisibilityAttr = this.aActiveElement.getAttribute( 'visibility' );
if( !sVisibilityAttr || ( sVisibilityAttr === 'visible' ) )
sVisibilityAttr = 'inherit';
if( sVisibilityAttr === 'inherit' )
this.aGraphicGroupElement.setAttribute( 'visibility', 'visible' );
else
this.aGraphicGroupElement.setAttribute( 'visibility', 'hidden' );

var aParagraphClone = aActiveParagraphElement.cloneNode( true );
aParagraphClone.setAttribute( 'id', this.sParagraphId );
aParagraphClone.setAttribute( 'visibility', sVisibilityAttr );
this.aParentTextElement.replaceChild( aParagraphClone, this.aParagraphElement );
this.aParagraphElement = aParagraphClone;


var aEventMultiplexer = this.aSlideShowContext.aEventMultiplexer;
var aHyperlinkIdSet = this.aHyperlinkIdSet;
var aHyperlinkElementSet = getElementsByClassName( this.aParagraphElement, 'UrlField' );
var i = 0;
for( ; i < aHyperlinkIdSet.length; ++i )
{
aEventMultiplexer.notifyElementChangedEvent( aHyperlinkIdSet[i], aHyperlinkElementSet[i] );
}
}
this.aActiveElement.setAttribute( 'visibility', 'hidden' );
};

AnimatedTextElement.prototype.notifyAnimationStart = function()
{
DBGLOG( 'AnimatedTextElement.notifyAnimationStart' );
if( this.nRunningAnimations === 0 )
{
var sVisibilityAttr = this.aParagraphElement.getAttribute( 'visibility' );
if( !sVisibilityAttr )
sVisibilityAttr = 'inherit';
this.aActiveElement.setAttribute( 'visibility', sVisibilityAttr );
this.aGraphicGroupElement.setAttribute( 'visibility', 'inherit' );
this.aParagraphElement.setAttribute( 'visibility', 'hidden' );
}
++this.nRunningAnimations;
};

AnimatedTextElement.prototype.notifyAnimationEnd = function()
{
DBGLOG( 'AnimatedTextElement.notifyAnimationEnd' );
--this.nRunningAnimations;
if( this.nRunningAnimations === 0 )
{
this.restoreBaseTextParagraph();
}
};

AnimatedTextElement.prototype.saveState = function( nAnimationNodeId )
{
if( this.nRunningAnimations === 0 )
{
var sVisibilityAttr = this.aParagraphElement.getAttribute( 'visibility' );
this.aActiveElement.setAttribute( 'visibility', sVisibilityAttr );
this.aGraphicGroupElement.setAttribute( 'visibility', 'inherit' );
}
AnimatedTextElement.superclass.saveState.call( this, nAnimationNodeId );
};

AnimatedTextElement.prototype.restoreState = function( nAnimationNodeId )
{
var bRet = AnimatedTextElement.superclass.restoreState.call( this, nAnimationNodeId );
if( bRet )
this.restoreBaseTextParagraph();
return bRet;
};


function SlideTransition( aAnimationsRootElement, aSlideId )
{
this.sSlideId = aSlideId;
this.bIsValid = false;
this.eTransitionType = undefined;
this.eTransitionSubType = undefined;
this.bReverseDirection = false;
this.eTransitionMode = TRANSITION_MODE_IN;
this.sFadeColor = null;
this.aDuration = null;
this.nMinFrameCount = undefined;

if( aAnimationsRootElement )
{
if( aAnimationsRootElement.firstElementChild &&
( aAnimationsRootElement.firstElementChild.getAttributeNS( NSS['smil'], 'begin' ) === (this.sSlideId + '.begin') ) )
{
var aTransitionFilterElement = aAnimationsRootElement.firstElementChild.firstElementChild;
if( aTransitionFilterElement && ( aTransitionFilterElement.localName === 'transitionFilter' ) )
{
this.aElement = aTransitionFilterElement;
this.parseElement();
}
aAnimationsRootElement.removeChild( aAnimationsRootElement.firstElementChild );
}
}
}

SlideTransition.prototype.createSlideTransition = function( aLeavingSlide, aEnteringSlide )
{
if( !this.isValid() )
return null;
if( this.eTransitionType == 0 )
return null;

if( !aEnteringSlide )
{
log( 'SlideTransition.createSlideTransition: invalid entering slide.' );
return null;
}

var aTransitionInfo = aTransitionInfoTable[this.eTransitionType][this.eTransitionSubType];
var eTransitionClass = aTransitionInfo['class'];

switch( eTransitionClass )
{
default:
case TRANSITION_INVALID:
log( 'SlideTransition.createSlideTransition: transition class: TRANSITION_INVALID' );
return null;

case TRANSITION_CLIP_POLYPOLYGON:
var aParametricPolyPolygon
= createClipPolyPolygon( this.eTransitionType, this.eTransitionSubType );
return new ClippedSlideChange( aLeavingSlide, aEnteringSlide, aParametricPolyPolygon,
aTransitionInfo, this.isDirectionForward() );

case TRANSITION_SPECIAL:
switch( this.eTransitionType )
{
default:
log( 'SlideTransition.createSlideTransition: ' +
'transition class: TRANSITION_SPECIAL, ' +
'unknown transition type: ' + this.eTransitionType );
return null;

case PUSHWIPE_TRANSITION:
{
var bCombined = false;
var aDirection = null;
switch( this.eTransitionSubType )
{
default:
log( 'SlideTransition.createSlideTransition: ' +
'transition type: PUSHWIPE_TRANSITION, ' +
'unknown transition subtype: ' + this.eTransitionSubType );
return null;
case FROMTOP_TRANS_SUBTYPE:
aDirection = { x: 0.0, y: 1.0 };
break;
case FROMBOTTOM_TRANS_SUBTYPE:
aDirection = { x: 0.0, y: -1.0 };
break;
case FROMLEFT_TRANS_SUBTYPE:
aDirection = { x: 1.0, y: 0.0 };
break;
case FROMRIGHT_TRANS_SUBTYPE:
aDirection = { x: -1.0, y: 0.0 };
break;
}
if( bCombined )
return null;
else
return new MovingSlideChange( aLeavingSlide, aEnteringSlide, aDirection, aDirection );
}

case SLIDEWIPE_TRANSITION:
{
var aInDirection = null;
switch( this.eTransitionSubType )
{
default:
log( 'SlideTransition.createSlideTransition: ' +
'transition type: SLIDEWIPE_TRANSITION, ' +
'unknown transition subtype: ' + this.eTransitionSubType );
return null;
case FROMTOP_TRANS_SUBTYPE:
aInDirection = { x: 0.0, y: 1.0 };
break;
case FROMBOTTOM_TRANS_SUBTYPE:
aInDirection = { x: 0.0, y: -1.0 };
break;
case FROMLEFT_TRANS_SUBTYPE:
aInDirection = { x: 1.0, y: 0.0 };
break;
case FROMRIGHT_TRANS_SUBTYPE:
aInDirection = { x: -1.0, y: 0.0 };
break;
}
var aNoDirection = { x: 0.0, y: 0.0 };
if( !this.bReverseDirection )
{
return new MovingSlideChange( aLeavingSlide, aEnteringSlide, aNoDirection, aInDirection );
}
else
{
return new MovingSlideChange( aLeavingSlide, aEnteringSlide, aInDirection, aNoDirection );
}
}

case FADE_TRANSITION:
switch( this.eTransitionSubType )
{
default:
log( 'SlideTransition.createSlideTransition: ' +
'transition type: FADE_TRANSITION, ' +
'unknown transition subtype: ' + this.eTransitionSubType );
return null;
case CROSSFADE_TRANS_SUBTYPE:
return new FadingSlideChange( aLeavingSlide, aEnteringSlide );
case FADEOVERCOLOR_TRANS_SUBTYPE:
return new FadingOverColorSlideChange( aLeavingSlide, aEnteringSlide, this.getFadeColor() );
}
}
}
};

SlideTransition.prototype.parseElement = function()
{
this.bIsValid = true;
var aAnimElem = this.aElement;

this.eTransitionType = undefined;
var sTypeAttr = aAnimElem.getAttributeNS( NSS['smil'], 'type' );
if( sTypeAttr && aTransitionTypeInMap[ sTypeAttr ] )
{
this.eTransitionType = aTransitionTypeInMap[ sTypeAttr ];
}
else
{
this.bIsValid = false;
log( 'SlideTransition.parseElement: transition type not valid: ' + sTypeAttr );
}

this.eTransitionSubType = undefined;
var sSubTypeAttr = aAnimElem.getAttributeNS( NSS['smil'], 'subtype' );
if( sSubTypeAttr === null )
sSubTypeAttr = 'default';
if( sSubTypeAttr && ( aTransitionSubtypeInMap[ sSubTypeAttr ] !== undefined ) )
{
this.eTransitionSubType = aTransitionSubtypeInMap[ sSubTypeAttr ];
}
else
{
this.bIsValid = false;
log( 'SlideTransition.parseElement: transition subtype not valid: ' + sSubTypeAttr );
}

if( this.bIsValid && aTransitionInfoTable[this.eTransitionType][this.eTransitionSubType] === undefined )
{
this.bIsValid = false;
log( 'SlideTransition.parseElement: transition not valid: type: ' + sTypeAttr + ' subtype: ' + sSubTypeAttr );
}

this.bReverseDirection = false;
var sDirectionAttr = aAnimElem.getAttributeNS( NSS['smil'], 'direction' );
if( sDirectionAttr == 'reverse' )
this.bReverseDirection = true;

this.sFadeColor = null;
if( this.eTransitionType == FADE_TRANSITION &&
( this.eTransitionSubType == FADEFROMCOLOR_TRANS_SUBTYPE ||
this.eTransitionSubType == FADEOVERCOLOR_TRANS_SUBTYPE ||
this.eTransitionSubType == FADETOCOLOR_TRANS_SUBTYPE ) )
{
var sColorAttr = aAnimElem.getAttributeNS( NSS['smil'], 'fadeColor' );
if( sColorAttr )
this.sFadeColor = sColorAttr;
else
this.sFadeColor='#000000';
}


this.aDuration = null;
var sDurAttr = aAnimElem.getAttributeNS( NSS['smil'], 'dur' );
this.aDuration = new Duration( sDurAttr );
if( !this.aDuration.isSet() )
{
this.aDuration = new Duration( null ); // duration == 0.0
}

this.nMinFrameCount = ( this.getDuration().isValue() )
? ( this.getDuration().getValue() * MINIMUM_FRAMES_PER_SECONDS )
: MINIMUM_FRAMES_PER_SECONDS;
if( this.nMinFrameCount < 1.0 )
this.nMinFrameCount = 1;
else if( this.nMinFrameCount > MINIMUM_FRAMES_PER_SECONDS )
this.nMinFrameCount = MINIMUM_FRAMES_PER_SECONDS;

};

SlideTransition.prototype.isValid = function()
{
return this.bIsValid;
};

SlideTransition.prototype.getTransitionType = function()
{
return this.eTransitionType;
};

SlideTransition.prototype.getTransitionSubType = function()
{
return this.eTransitionSubType;
};

SlideTransition.prototype.getTransitionMode = function()
{
return this.eTransitionMode;
};

SlideTransition.prototype.getFadeColor = function()
{
return this.sFadeColor;
};

SlideTransition.prototype.isDirectionForward = function()
{
return !this.bReverseDirection;
};

SlideTransition.prototype.getDuration = function()
{
return this.aDuration;
};

SlideTransition.prototype.getMinFrameCount = function()
{
return this.nMinFrameCount;
};

SlideTransition.prototype.info = function()
{

var sInfo ='slide transition <' + this.sSlideId + '>: ';
sInfo += ';  type: ' + aTransitionTypeOutMap[ String( this.getTransitionType() ) ];

sInfo += ';  subtype: ' + aTransitionSubtypeOutMap[ this.getTransitionSubType() ];

if( !this.isDirectionForward() )
sInfo += ';  direction: reverse';

sInfo += '; mode: ' + aTransitionModeOutMap[ this.getTransitionMode() ];

if( this.getDuration() )
sInfo += '; duration: ' + this.getDuration().info();

return sInfo;
};


function SlideAnimations( aSlideShowContext )
{
this.aContext = new NodeContext( aSlideShowContext );
this.aAnimationNodeMap = {};
this.aAnimatedElementMap = {};
this.aSourceEventElementMap = {};
this.aNextEffectEventArray = new NextEffectEventArray();
this.aInteractiveAnimationSequenceMap = {};
this.aEventMultiplexer = new EventMultiplexer( aSlideShowContext.aTimerEventQueue );
this.aRootNode = null;
this.bElementsParsed = false;

this.aContext.aAnimationNodeMap = this.aAnimationNodeMap;
this.aContext.aAnimatedElementMap = this.aAnimatedElementMap;
this.aContext.aSourceEventElementMap = this.aSourceEventElementMap;

this.aEventMultiplexer.registerMouseClickHandler( document, 100 );
}


SlideAnimations.prototype.importAnimations = function( aAnimationRootElement )
{
if( !aAnimationRootElement )
return false;

this.aRootNode = createAnimationTree( aAnimationRootElement, this.aContext );

return ( this.aRootNode ? true : false );
};

SlideAnimations.prototype.parseElements = function()
{
if( !this.aRootNode )
return false;

if( !this.aRootNode.parseElement() )
return false;
else
this.bElementsParsed = true;
};

SlideAnimations.prototype.elementsParsed = function()
{
return this.bElementsParsed;
};

SlideAnimations.prototype.isFirstRun = function()
{
return this.aContext.bFirstRun;
};

SlideAnimations.prototype.isAnimated = function()
{
if( !this.bElementsParsed )
return false;

return this.aRootNode.hasPendingAnimation();
};

SlideAnimations.prototype.start = function()
{
if( !this.bElementsParsed )
return false;

this.chargeSourceEvents();
this.chargeInterAnimEvents();

aSlideShow.setSlideEvents( this.aNextEffectEventArray,
this.aInteractiveAnimationSequenceMap,
this.aEventMultiplexer );

if( this.aContext.bFirstRun == undefined )
this.aContext.bFirstRun = true;
else if( this.aContext.bFirstRun )
this.aContext.bFirstRun = false;

if( !this.aRootNode.init() )
return false;

return this.aRootNode.resolve();
};

SlideAnimations.prototype.end = function( bLeftEffectsSkipped )
{
if( !this.bElementsParsed )
return; // no animations there

this.aRootNode.deactivate();
this.aRootNode.end();

if( bLeftEffectsSkipped && this.isFirstRun() )
{
this.aContext.bFirstRun = undefined;
}
else if( this.isFirstRun() )
{
this.aContext.bFirstRun = false;
}

};

SlideAnimations.prototype.dispose = function()
{
if( this.aRootNode )
{
this.aRootNode.dispose();
}
};

SlideAnimations.prototype.clearNextEffectEvents = function()
{
ANIMDBG.print( 'SlideAnimations.clearNextEffectEvents: current slide: ' + nCurSlide );
this.aNextEffectEventArray.clear();
this.aContext.bFirstRun = undefined;
};

SlideAnimations.prototype.chargeSourceEvents = function()
{
for( var id in this.aSourceEventElementMap )
{
this.aSourceEventElementMap[id].charge();
}
};

SlideAnimations.prototype.chargeInterAnimEvents = function()
{
for( var id in this.aInteractiveAnimationSequenceMap )
{
this.aInteractiveAnimationSequenceMap[id].chargeEvents();
}
};


function Event()
{
this.nId = Event.getUniqueId();
}


Event.CURR_UNIQUE_ID = 0;

Event.getUniqueId = function()
{
++Event.CURR_UNIQUE_ID;
return Event.CURR_UNIQUE_ID;
};

Event.prototype.getId = function()
{
return this.nId;
};


function DelayEvent( aFunctor, nTimeout )
{
DelayEvent.superclass.constructor.call( this );

this.aFunctor = aFunctor;
this.nTimeout = nTimeout;
this.bWasFired = false;
}
extend( DelayEvent, Event );


DelayEvent.prototype.fire = function()
{
assert( this.isCharged(), 'DelayEvent.fire: assertion isCharged failed' );

this.bWasFired = true;
this.aFunctor();
return true;
};

DelayEvent.prototype.isCharged = function()
{
return !this.bWasFired;
};

DelayEvent.prototype.getActivationTime = function( nCurrentTime )
{
return ( this.nTimeout + nCurrentTime );
};

DelayEvent.prototype.dispose = function()
{
if( this.isCharged() )
this.bWasFired = true;
};

DelayEvent.prototype.charge = function()
{
if( !this.isCharged() )
this.bWasFired = false;
};


function makeEvent( aFunctor )
{
return new DelayEvent( aFunctor, 0.0 );
}


function makeDelay( aFunctor, nTimeout )
{
return new DelayEvent( aFunctor, nTimeout );
}


function registerEvent( nNodeId, aTiming, aEvent, aNodeContext )
{
var aSlideShowContext = aNodeContext.aContext;
var eTimingType = aTiming.getType();

registerEvent.DBG( aTiming );

if( eTimingType == OFFSET_TIMING )
{
aSlideShowContext.aTimerEventQueue.addEvent( aEvent );
}
else if ( aNodeContext.bFirstRun )
{
var aEventMultiplexer = aSlideShowContext.aEventMultiplexer;
if( !aEventMultiplexer )
{
log( 'registerEvent: event multiplexer not initialized' );
return;
}
var aNextEffectEventArray = aSlideShowContext.aNextEffectEventArray;
if( !aNextEffectEventArray )
{
log( 'registerEvent: next effect event array not initialized' );
return;
}
var aInteractiveAnimationSequenceMap =
aSlideShowContext.aInteractiveAnimationSequenceMap;
if( !aInteractiveAnimationSequenceMap )
{
log( 'registerEvent: interactive animation sequence map not initialized' );
return;
}

switch( eTimingType )
{
case EVENT_TIMING:
var eEventType = aTiming.getEventType();
var sEventBaseElemId = aTiming.getEventBaseElementId();
if( sEventBaseElemId )
{
var aEventBaseElem = document.getElementById( sEventBaseElemId );
if( !aEventBaseElem )
{
log( 'generateEvent: EVENT_TIMING: event base element not found: ' + sEventBaseElemId );
return;
}
var aSourceEventElement = aNodeContext.makeSourceEventElement( sEventBaseElemId, aEventBaseElem );

if( !aInteractiveAnimationSequenceMap[ nNodeId ] )
{
aInteractiveAnimationSequenceMap[ nNodeId ] = new InteractiveAnimationSequence(nNodeId);
}

var bEventRegistered = false;
switch( eEventType )
{
case EVENT_TRIGGER_ON_CLICK:
aEventMultiplexer.registerEvent( eEventType, aSourceEventElement.getId(), aEvent );
aEventMultiplexer.registerRewindedEffectHandler( aSourceEventElement.getId(),
bind2( aSourceEventElement.charge, aSourceEventElement ) );
bEventRegistered = true;
break;
default:
log( 'generateEvent: not handled event type: ' + eEventType );
}
if( bEventRegistered )
{
var aStartEvent = aInteractiveAnimationSequenceMap[ nNodeId ].getStartEvent();
var aEndEvent = aInteractiveAnimationSequenceMap[ nNodeId ].getEndEvent();
aEventMultiplexer.registerEvent( eEventType, aSourceEventElement.getId(), aStartEvent );
aEventMultiplexer.registerEvent( EVENT_TRIGGER_END_EVENT, nNodeId, aEndEvent );
aEventMultiplexer.registerRewindedEffectHandler(
nNodeId,
bind2( InteractiveAnimationSequence.prototype.chargeEvents,
aInteractiveAnimationSequenceMap[ nNodeId ] )
);
}
}
else  // no base event element present
{
switch( eEventType )
{
case EVENT_TRIGGER_ON_NEXT_EFFECT:
aNextEffectEventArray.appendEvent( aEvent );
break;
default:
log( 'generateEvent: not handled event type: ' + eEventType );
}
}
break;
case SYNCBASE_TIMING:
eEventType = aTiming.getEventType();
sEventBaseElemId = aTiming.getEventBaseElementId();
if( sEventBaseElemId )
{
var aAnimationNode = aNodeContext.aAnimationNodeMap[ sEventBaseElemId ];
if( !aAnimationNode )
{
log( 'generateEvent: SYNCBASE_TIMING: event base element not found: ' + sEventBaseElemId );
return;
}
aEventMultiplexer.registerEvent( eEventType, aAnimationNode.getId(), aEvent );
}
else
{
log( 'generateEvent: SYNCBASE_TIMING: event base element not specified' );
}
break;
default:
log( 'generateEvent: not handled timing type: ' + eTimingType );
}
}
}

registerEvent.DEBUG = aRegisterEventDebugPrinter.isEnabled();

registerEvent.DBG = function( aTiming, nTime )
{
if( registerEvent.DEBUG )
{
aRegisterEventDebugPrinter.print( 'registerEvent( timing: ' + aTiming.info() + ' )', nTime );
}
};


function SourceEventElement( sId, aElement, aEventMultiplexer )
{
this.sId = sId;
this.aElement = aElement;
this.aEventMultiplexer = aEventMultiplexer;

this.aEventMultiplexer.registerMouseClickHandler( this, 1000 );

this.bClickHandled = false;
this.bIsPointerOver = false;
this.aElement.addEventListener( 'mouseover', bind2( SourceEventElement.prototype.onMouseEnter, this), false );
this.aElement.addEventListener( 'mouseout', bind2( SourceEventElement.prototype.onMouseLeave, this), false );
}

SourceEventElement.prototype.getId = function()
{
return this.sId;
};

SourceEventElement.prototype.onMouseEnter = function()
{
this.bIsPointerOver = true;
this.setPointerCursor();
};

SourceEventElement.prototype.onMouseLeave = function()
{
this.bIsPointerOver = false;
this.setDefaultCursor();
};

SourceEventElement.prototype.charge = function()
{
this.bClickHandled = false;
this.setPointerCursor();
};

SourceEventElement.prototype.handleClick = function( aMouseEvent )
{
if( !this.bIsPointerOver ) return false;

if( this.bClickHandled )
return false;

this.aEventMultiplexer.notifyEvent( EVENT_TRIGGER_ON_CLICK, this.getId() );
aSlideShow.update();
this.bClickHandled = true;
this.setDefaultCursor();
return true;
};

SourceEventElement.prototype.setPointerCursor = function()
{
if( this.bClickHandled )
return;

this.aElement.setAttribute( 'style', 'cursor: pointer' );
};

SourceEventElement.prototype.setDefaultCursor = function()
{
this.aElement.setAttribute( 'style', 'cursor: default' );
};


function HyperlinkElement( sId, aEventMultiplexer )
{
var aElement = document.getElementById( sId );
if( !aElement )
{
log( 'error: HyperlinkElement: no element with id: <' + sId + '> found' );
return;
}
if( !aEventMultiplexer )
{
log( 'AnimatedElement constructor: event multiplexer is not valid' );
}

this.sId = sId;
this.aElement = aElement;
this.aEventMultiplexer = aEventMultiplexer;
this.nTargetSlideIndex = undefined;

this.sURL = getNSAttribute( 'xlink', this.aElement, 'href' );
if( this.sURL )
{
if( this.sURL[0] === '#' )
{
if( this.sURL.substr(1, 5) === 'Slide' )
{
var sSlideIndex = this.sURL.split( ' ' )[1];
this.nTargetSlideIndex = parseInt( sSlideIndex ) - 1;
}
}

this.aEventMultiplexer.registerElementChangedHandler( this.sId, bind2( HyperlinkElement.prototype.onElementChanged, this) );
this.aEventMultiplexer.registerMouseClickHandler( this, 1100 );

this.bIsPointerOver = false;
this.mouseEnterHandler = bind2( HyperlinkElement.prototype.onMouseEnter, this);
this.mouseLeaveHandler = bind2( HyperlinkElement.prototype.onMouseLeave, this);
this.aElement.addEventListener( 'mouseover', this.mouseEnterHandler, false );
this.aElement.addEventListener( 'mouseout', this.mouseLeaveHandler, false );
}
else
{
log( 'warning: HyperlinkElement(' + this.sId + '): url is empty' );
}
}

HyperlinkElement.prototype.onElementChanged = function( aElement )
{
if( !aElement )
{
log( 'error: HyperlinkElement: passed element is not valid' );
return;
}

if( this.sURL )
{
this.aElement.removeEventListener( 'mouseover', this.mouseEnterHandler, false );
this.aElement.removeEventListener( 'mouseout', this.mouseLeaveHandler, false );
this.aElement = aElement;
this.aElement.addEventListener( 'mouseover', this.mouseEnterHandler, false );
this.aElement.addEventListener( 'mouseout', this.mouseLeaveHandler, false );
}
};

HyperlinkElement.prototype.onMouseEnter = function()
{
this.bIsPointerOver = true;
this.setPointerCursor();
};

HyperlinkElement.prototype.onMouseLeave = function()
{
this.bIsPointerOver = false;
this.setDefaultCursor();
};

HyperlinkElement.prototype.handleClick = function( aMouseEvent )
{
if( !this.bIsPointerOver ) return false;


if( this.nTargetSlideIndex !== undefined )
{
aSlideShow.displaySlide( this.nTargetSlideIndex, true );
}
else
{
var aWindowObject = document.defaultView;
if( aWindowObject )
{
aWindowObject.open( this.sURL, this.sId );
}
else
{
log( 'error: HyperlinkElement.handleClick: invalid window object.' );
}
}

return true;
};

HyperlinkElement.prototype.setPointerCursor = function()
{
if( this.bClickHandled )
return;

this.aElement.setAttribute( 'style', 'cursor: pointer' );
};

HyperlinkElement.prototype.setDefaultCursor = function()
{
this.aElement.setAttribute( 'style', 'cursor: default' );
};


function InteractiveAnimationSequence( nId )
{
this.nId = nId;
this.bIsRunning = false;
this.aStartEvent = null;
this.aEndEvent = null;
}

InteractiveAnimationSequence.prototype.getId = function()
{
return this.nId;
};

InteractiveAnimationSequence.prototype.getStartEvent = function()
{
if( !this.aStartEvent )
{
this.aStartEvent =
makeEvent( bind2( InteractiveAnimationSequence.prototype.start, this ) );
}
return this.aStartEvent;
};

InteractiveAnimationSequence.prototype.getEndEvent = function()
{
if( !this.aEndEvent )
{
this.aEndEvent =
makeEvent( bind2( InteractiveAnimationSequence.prototype.end, this ) );
}
return this.aEndEvent;
};

InteractiveAnimationSequence.prototype.chargeEvents = function()
{
if( this.aStartEvent )      this.aStartEvent.charge();
if( this.aEndEvent )        this.aEndEvent.charge();
};

InteractiveAnimationSequence.prototype.isRunning = function()
{
return this.bIsRunning;
};

InteractiveAnimationSequence.prototype.start = function()
{
aSlideShow.notifyInteractiveAnimationSequenceStart( this.getId() );
this.bIsRunning = true;
};

InteractiveAnimationSequence.prototype.end = function()
{
aSlideShow.notifyInteractiveAnimationSequenceEnd( this.getId() );
this.bIsRunning = false;
};


function PriorityEntry( aValue, nPriority )
{
this.aValue = aValue;
this.nPriority = nPriority;
}

PriorityEntry.compare = function( aLhsEntry, aRhsEntry )
{
if ( aLhsEntry.nPriority < aRhsEntry.nPriority )
{
return -1;
}
else if (aLhsEntry.nPriority > aRhsEntry.nPriority)
{
return 1;
}
else
{
return 0;
}
};


function EventMultiplexer( aTimerEventQueue )
{
this.nId = EventMultiplexer.getUniqueId();
this.aTimerEventQueue = aTimerEventQueue;
this.aEventMap = {};
this.aSkipEffectEndHandlerSet = [];
this.aMouseClickHandlerSet = new PriorityQueue( PriorityEntry.compare );
this.aSkipEffectEvent = null;
this.aRewindCurrentEffectEvent = null;
this.aRewindLastEffectEvent = null;
this.aSkipInteractiveEffectEventSet = {};
this.aRewindRunningInteractiveEffectEventSet = {};
this.aRewindEndedInteractiveEffectEventSet = {};
this.aRewindedEffectHandlerSet = {};
this.aElementChangedHandlerSet = {};
}

EventMultiplexer.CURR_UNIQUE_ID = 0;

EventMultiplexer.getUniqueId = function()
{
++EventMultiplexer.CURR_UNIQUE_ID;
return EventMultiplexer.CURR_UNIQUE_ID;
};

EventMultiplexer.prototype.getId = function()
{
return this.nId;
};

EventMultiplexer.prototype.hasRegisteredMouseClickHandlers = function()
{
return !this.aMouseClickHandlerSet.isEmpty();
};

EventMultiplexer.prototype.registerMouseClickHandler = function( aHandler, nPriority )
{
var aHandlerEntry = new PriorityEntry( aHandler, nPriority );
this.aMouseClickHandlerSet.push( aHandlerEntry );
};

EventMultiplexer.prototype.notifyMouseClick = function( aMouseEvent )
{
var aMouseClickHandlerSet = this.aMouseClickHandlerSet.clone();
while( !aMouseClickHandlerSet.isEmpty() )
{
var aHandlerEntry = aMouseClickHandlerSet.top();
aMouseClickHandlerSet.pop();
if( aHandlerEntry.aValue.handleClick( aMouseEvent ) )
break;
}
};

EventMultiplexer.prototype.registerEvent = function( eEventType, aNotifierId, aEvent )
{
this.DBG( 'registerEvent', eEventType, aNotifierId );
if( !this.aEventMap[ eEventType ] )
{
this.aEventMap[ eEventType ] = {};
}
if( !this.aEventMap[ eEventType ][ aNotifierId ] )
{
this.aEventMap[ eEventType ][ aNotifierId ] = [];
}
this.aEventMap[ eEventType ][ aNotifierId ].push( aEvent );
};


EventMultiplexer.prototype.notifyEvent = function( eEventType, aNotifierId )
{
this.DBG( 'notifyEvent', eEventType, aNotifierId );
if( this.aEventMap[ eEventType ] )
{
if( this.aEventMap[ eEventType ][ aNotifierId ] )
{
var aEventArray = this.aEventMap[ eEventType ][ aNotifierId ];
var nSize = aEventArray.length;
for( var i = 0; i < nSize; ++i )
{
this.aTimerEventQueue.addEvent( aEventArray[i] );
}
}
}
};

EventMultiplexer.prototype.registerNextEffectEndHandler = function( aHandler )
{
this.aSkipEffectEndHandlerSet.push( aHandler );
};

EventMultiplexer.prototype.notifyNextEffectEndEvent = function()
{
var nSize = this.aSkipEffectEndHandlerSet.length;
for( var i = 0; i < nSize; ++i )
{
(this.aSkipEffectEndHandlerSet[i])();
}
this.aSkipEffectEndHandlerSet = [];
};

EventMultiplexer.prototype.registerSkipEffectEvent = function( aEvent )
{
this.aSkipEffectEvent = aEvent;
};

EventMultiplexer.prototype.notifySkipEffectEvent = function()
{
if( this.aSkipEffectEvent )
{
this.aTimerEventQueue.addEvent( this.aSkipEffectEvent );
this.aSkipEffectEvent = null;
}
};

EventMultiplexer.prototype.registerRewindCurrentEffectEvent = function( aEvent )
{
this.aRewindCurrentEffectEvent = aEvent;
};

EventMultiplexer.prototype.notifyRewindCurrentEffectEvent = function()
{
if( this.aRewindCurrentEffectEvent )
{
this.aTimerEventQueue.addEvent( this.aRewindCurrentEffectEvent );
this.aRewindCurrentEffectEvent = null;
}
};

EventMultiplexer.prototype.registerRewindLastEffectEvent = function( aEvent )
{
this.aRewindLastEffectEvent = aEvent;
};

EventMultiplexer.prototype.notifyRewindLastEffectEvent = function()
{
if( this.aRewindLastEffectEvent )
{
this.aTimerEventQueue.addEvent( this.aRewindLastEffectEvent );
this.aRewindLastEffectEvent = null;
}
};

EventMultiplexer.prototype.registerSkipInteractiveEffectEvent = function( nNotifierId, aEvent )
{
this.aSkipInteractiveEffectEventSet[ nNotifierId ] = aEvent;
};

EventMultiplexer.prototype.notifySkipInteractiveEffectEvent = function( nNotifierId )
{
if( this.aSkipInteractiveEffectEventSet[ nNotifierId ] )
{
this.aTimerEventQueue.addEvent( this.aSkipInteractiveEffectEventSet[ nNotifierId ] );
}
};

EventMultiplexer.prototype.registerRewindRunningInteractiveEffectEvent = function( nNotifierId, aEvent )
{
this.aRewindRunningInteractiveEffectEventSet[ nNotifierId ] = aEvent;
};

EventMultiplexer.prototype.notifyRewindRunningInteractiveEffectEvent = function( nNotifierId )
{
if( this.aRewindRunningInteractiveEffectEventSet[ nNotifierId ] )
{
this.aTimerEventQueue.addEvent( this.aRewindRunningInteractiveEffectEventSet[ nNotifierId ] );
}
};

EventMultiplexer.prototype.registerRewindEndedInteractiveEffectEvent = function( nNotifierId, aEvent )
{
this.aRewindEndedInteractiveEffectEventSet[ nNotifierId ] = aEvent;
};

EventMultiplexer.prototype.notifyRewindEndedInteractiveEffectEvent = function( nNotifierId )
{
if( this.aRewindEndedInteractiveEffectEventSet[ nNotifierId ] )
{
this.aTimerEventQueue.addEvent( this.aRewindEndedInteractiveEffectEventSet[ nNotifierId ] );
}
};

EventMultiplexer.prototype.registerRewindedEffectHandler = function( aNotifierId, aHandler )
{
this.aRewindedEffectHandlerSet[ aNotifierId ] = aHandler;
};

EventMultiplexer.prototype.notifyRewindedEffectEvent = function( aNotifierId )
{
if( this.aRewindedEffectHandlerSet[ aNotifierId ] )
{
(this.aRewindedEffectHandlerSet[ aNotifierId ])();
}
};

EventMultiplexer.prototype.registerElementChangedHandler = function( aNotifierId, aHandler )
{
this.aElementChangedHandlerSet[ aNotifierId ] = aHandler;
};

EventMultiplexer.prototype.notifyElementChangedEvent = function( aNotifierId, aElement )
{
if( this.aElementChangedHandlerSet[ aNotifierId ] )
{
(this.aElementChangedHandlerSet[ aNotifierId ])( aElement );
}
};

EventMultiplexer.DEBUG = aEventMultiplexerDebugPrinter.isEnabled();

EventMultiplexer.prototype.DBG = function( sMethodName, eEventType, aNotifierId, nTime )
{
if( EventMultiplexer.DEBUG )
{
var sInfo = 'EventMultiplexer.' + sMethodName;
sInfo += '( type: ' + aEventTriggerOutMap[ eEventType ];
sInfo += ', notifier: ' + aNotifierId + ' )';
aEventMultiplexerDebugPrinter.print( sInfo, nTime );
}
};


var aInterpolatorHandler = {};

aInterpolatorHandler.getInterpolator = function( eCalcMode, eValueType, eValueSubtype )
{
var bHasSubtype = ( typeof( eValueSubtype ) === typeof( 0 ) );

if( !bHasSubtype && aInterpolatorHandler.aLerpFunctorMap[ eCalcMode ][ eValueType ] )
{
return aInterpolatorHandler.aLerpFunctorMap[ eCalcMode ][ eValueType ];
}
else if( bHasSubtype && aInterpolatorHandler.aLerpFunctorMap[ eCalcMode ][ eValueType ][ eValueSubtype ] )
{
return aInterpolatorHandler.aLerpFunctorMap[ eCalcMode ][ eValueType ][ eValueSubtype ];
}
else
{
log( 'aInterpolatorHandler.getInterpolator: not found any valid interpolator for calc mode '
+ aCalcModeOutMap[eCalcMode]  + 'and value type ' + aValueTypeOutMap[eValueType]  );
return null;
}
};

aInterpolatorHandler.aLerpFunctorMap = [];
aInterpolatorHandler.aLerpFunctorMap[ CALC_MODE_DISCRETE ] = [];
aInterpolatorHandler.aLerpFunctorMap[ CALC_MODE_LINEAR ] = [];


aInterpolatorHandler.aLerpFunctorMap[ CALC_MODE_LINEAR ][ NUMBER_PROPERTY ] =
function ( nFrom, nTo, nT )
{
return ( ( 1.0 - nT )* nFrom + nT * nTo );
};

aInterpolatorHandler.aLerpFunctorMap[ CALC_MODE_LINEAR ][ COLOR_PROPERTY ] = [];

aInterpolatorHandler.aLerpFunctorMap[ CALC_MODE_LINEAR ][ COLOR_PROPERTY ][ COLOR_SPACE_RGB ] =
function ( nFrom, nTo, nT )
{
return RGBColor.interpolate( nFrom, nTo, nT );
};

aInterpolatorHandler.aLerpFunctorMap[ CALC_MODE_LINEAR ][ COLOR_PROPERTY ][ COLOR_SPACE_HSL ] =
function ( bCCW  )
{
return  function ( nFrom, nTo, nT )
{
return HSLColor.interpolate( nFrom, nTo, nT, bCCW );
};
};


function KeyStopLerp( aValueList )
{
KeyStopLerp.validateInput( aValueList );

this.aKeyStopList = [];
this.nLastIndex = 0;
this.nKeyStopDistance = aValueList[1] - aValueList[0];
if( this.nKeyStopDistance <= 0 )
this.nKeyStopDistance = 0.001;

for( var i = 0; i < aValueList.length; ++i )
this.aKeyStopList.push( aValueList[i] );

this.nUpperBoundIndex = this.aKeyStopList.length - 2;
}


KeyStopLerp.validateInput = function( aValueList )
{
var nSize = aValueList.length;
assert( nSize > 1, 'KeyStopLerp.validateInput: key stop vector must have two entries or more' );

for( var i = 1; i < nSize; ++i )
{
if( aValueList[i-1] > aValueList[i] )
log( 'KeyStopLerp.validateInput: time vector is not sorted in ascending order!' );
}
};

KeyStopLerp.prototype.reset = function()
{
KeyStopLerp.validateInput( this.aKeyStopList );
this.nLastIndex = 0;
this.nKeyStopDistance = this.aKeyStopList[1] - this.aKeyStopList[0];
if( this.nKeyStopDistance <= 0 )
this.nKeyStopDistance = 0.001;

};

KeyStopLerp.prototype.lerp = function( nAlpha )
{
if( nAlpha > this.aKeyStopList[ this.nLastIndex + 1 ] )
{
do
{
var nIndex = this.nLastIndex + 1;
this.nLastIndex = clamp( nIndex, 0, this.nUpperBoundIndex );
this.nKeyStopDistance = this.aKeyStopList[ this.nLastIndex + 1 ] - this.aKeyStopList[ this.nLastIndex ];
}
while( ( this.nKeyStopDistance <= 0 ) && ( this.nLastIndex < this.nUpperBoundIndex ) );
}

var nRawLerp = ( nAlpha - this.aKeyStopList[ this.nLastIndex ] ) / this.nKeyStopDistance;

nRawLerp = clamp( nRawLerp, 0.0, 1.0 );

var aResult = {};
aResult.nIndex = this.nLastIndex;
aResult.nLerp = nRawLerp;

return aResult;
};

KeyStopLerp.prototype.lerp_ported = function( nAlpha )
{
if( ( this.aKeyStopList[ this.nLastIndex ] < nAlpha ) ||
( this.aKeyStopList[ this.nLastIndex + 1 ] >= nAlpha ) )
{
var i = 0;
for( ; i < this.aKeyStopList.length; ++i )
{
if( this.aKeyStopList[i] >= nAlpha )
break;
}
if( this.aKeyStopList[i] > nAlpha )
--i;
var nIndex = i - 1;
this.nLastIndex = clamp( nIndex, 0, this.aKeyStopList.length - 2 );
}

var nRawLerp = ( nAlpha - this.aKeyStopList[ this.nLastIndex ] ) /
( this.aKeyStopList[ this.nLastIndex+1 ] - this.aKeyStopList[ this.nLastIndex ] );

nRawLerp = clamp( nRawLerp, 0.0, 1.0 );

var aResult = {};
aResult.nIndex = this.nLastIndex;
aResult.nLerp = nRawLerp;

return aResult;
};


var aOperatorSetMap = [];

aOperatorSetMap[ NUMBER_PROPERTY ] = {};

aOperatorSetMap[ NUMBER_PROPERTY ].equal = function( a, b )
{
return ( a === b );
};

aOperatorSetMap[ NUMBER_PROPERTY ].add = function( a, b )
{
return ( a + b );
};

aOperatorSetMap[ NUMBER_PROPERTY ].scale = function( k, v )
{
return ( k * v );
};

aOperatorSetMap[ COLOR_PROPERTY ] = {};

aOperatorSetMap[ COLOR_PROPERTY ].equal = function( a, b )
{
return a.equal( b );
};

aOperatorSetMap[ COLOR_PROPERTY ].add = function( a, b )
{
var c = a.clone();
c.add( b );
return c;
};

aOperatorSetMap[ COLOR_PROPERTY ].scale = function( k, v )
{
var r = v.clone();
r.scale( k );
return r;
};


function ActivityParamSet()
{
this.aEndEvent = null;
this.aTimerEventQueue = null;
this.aActivityQueue = null;
this.nMinDuration = undefined;
this.nMinNumberOfFrames = MINIMUM_FRAMES_PER_SECONDS;
this.bAutoReverse = false;
this.nRepeatCount = 1.0;
this.nAccelerationFraction = 0.0;
this.nDecelerationFraction = 0.0;
this.nSlideWidth = undefined;
this.nSlideHeight = undefined;
this.aFormula = null;
this.aDiscreteTimes = [];
}


function AnimationActivity()
{
this.nId = AnimationActivity.getUniqueId();
}


AnimationActivity.CURR_UNIQUE_ID = 0;

AnimationActivity.getUniqueId = function()
{
++AnimationActivity.CURR_UNIQUE_ID;
return AnimationActivity.CURR_UNIQUE_ID;
};

AnimationActivity.prototype.getId = function()
{
return this.nId;
};


function SetActivity( aCommonParamSet, aAnimation, aToAttr  )
{
SetActivity.superclass.constructor.call( this );

this.aAnimation = aAnimation;
this.aTargetElement = null;
this.aEndEvent = aCommonParamSet.aEndEvent;
this.aTimerEventQueue = aCommonParamSet.aTimerEventQueue;
this.aToAttr = aToAttr;
this.bIsActive = true;
}
extend( SetActivity, AnimationActivity );


SetActivity.prototype.activate = function( aEndEvent )
{
this.aEndEvent = aEndEvent;
this.bIsActive = true;
};

SetActivity.prototype.dispose = function()
{
this.bIsActive = false;
if( this.aEndEvent && this.aEndEvent.isCharged() )
this.aEndEvent.dispose();
};

SetActivity.prototype.calcTimeLag = function()
{
return 0.0;
};

SetActivity.prototype.perform = function()
{
if( !this.isActive() )
return false;

this.bIsActive = false;

if( this.aAnimation && this.aTargetElement )
{
this.aAnimation.start( this.aTargetElement );
this.aAnimation.perform( this.aToAttr );
this.aAnimation.end();
}

if( this.aEndEvent )
this.aTimerEventQueue.addEvent( this.aEndEvent );

};

SetActivity.prototype.isActive = function()
{
return this.bIsActive;
};

SetActivity.prototype.dequeued = function()
{
};

SetActivity.prototype.end = function()
{
this.perform();
};

SetActivity.prototype.setTargets = function( aTargetElement )
{
assert( aTargetElement, 'SetActivity.setTargets: target element is not valid' );
this.aTargetElement = aTargetElement;
};


function ActivityBase( aCommonParamSet )
{
ActivityBase.superclass.constructor.call( this );

this.aTargetElement = null;
this.aEndEvent = aCommonParamSet.aEndEvent;
this.aTimerEventQueue = aCommonParamSet.aTimerEventQueue;
this.nRepeats = aCommonParamSet.nRepeatCount;
this.nAccelerationFraction = aCommonParamSet.nAccelerationFraction;
this.nDecelerationFraction = aCommonParamSet.nDecelerationFraction;
this.bAutoReverse = aCommonParamSet.bAutoReverse;

this.bFirstPerformCall = true;
this.bIsActive = true;

}
extend( ActivityBase, AnimationActivity );


ActivityBase.prototype.activate = function( aEndEvent )
{
this.aEndEvent = aEndEvent;
this.bFirstPerformCall = true;
this.bIsActive = true;
};

ActivityBase.prototype.dispose = function()
{
this.bIsActive = false;

if( this.aEndEvent )
this.aEndEvent.dispose();

this.aEndEvent = null;
};

ActivityBase.prototype.perform = function()
{
if( !this.isActive() )
return false; // no, early exit.

assert( !this.bFirstPerformCall, 'ActivityBase.perform: assertion (!this.FirstPerformCall) failed' );

return true;
};

ActivityBase.prototype.calcTimeLag = function()
{
if( this.isActive() && this.bFirstPerformCall )
{
this.bFirstPerformCall = false;

this.startAnimation();
}
return 0.0;
};

ActivityBase.prototype.isActive = function()
{
return this.bIsActive;
};

ActivityBase.prototype.isDisposed = function()
{
return ( !this.bIsActive && !this.aEndEvent );
};

ActivityBase.prototype.dequeued = function()
{
if( !this.isActive() )
this.endAnimation();
};

ActivityBase.prototype.setTargets = function( aTargetElement )
{
assert( aTargetElement, 'ActivityBase.setTargets: target element is not valid' );

this.aTargetElement = aTargetElement;
};

ActivityBase.prototype.startAnimation = function()
{
throw ( 'ActivityBase.startAnimation: abstract method invoked' );
};

ActivityBase.prototype.endAnimation = function()
{
throw ( 'ActivityBase.endAnimation: abstract method invoked' );
};

ActivityBase.prototype.endActivity = function()
{
this.bIsActive = false;

if( this.aEndEvent )
this.aTimerEventQueue.addEvent( this.aEndEvent );

this.aEndEvent = null;

};

ActivityBase.prototype.calcAcceleratedTime = function( nT )
{


nT = clamp( nT, 0.0, 1.0 );

if( ( this.nAccelerationFraction > 0.0 || this.nDecelerationFraction > 0.0 ) &&
( this.nAccelerationFraction + this.nDecelerationFraction <= 1.0 ) )
{
var nC = 1.0 - 0.5*this.nAccelerationFraction - 0.5*this.nDecelerationFraction;

var nTPrime = 0.0;

if( nT < this.nAccelerationFraction )
{
nTPrime += 0.5 * nT * nT / this.nAccelerationFraction; // partial first interval
}
else
{
nTPrime += 0.5 * this.nAccelerationFraction; // full first interval

if( nT <= ( 1.0 - this.nDecelerationFraction ) )
{
nTPrime += nT - this.nAccelerationFraction; // partial second interval
}
else
{
nTPrime += 1.0 - this.nAccelerationFraction - this.nDecelerationFraction; // full second interval

var nTRelative = nT - 1.0 + this.nDecelerationFraction;

nTPrime += nTRelative - 0.5*nTRelative*nTRelative / this.nDecelerationFraction;
}
}

nT = nTPrime / nC;

}
return nT;
};

ActivityBase.prototype.getEventQueue = function()
{
return this.aTimerEventQueue;
};

ActivityBase.prototype.getTargetElement = function()
{
return this.aTargetElement;
};

ActivityBase.prototype.isRepeatCountValid = function()
{
return !!this.nRepeats; // first ! convert to bool
};

ActivityBase.prototype.getRepeatCount = function()
{
return this.nRepeats;
};

ActivityBase.prototype.isAutoReverse = function()
{
return this.bAutoReverse;
};

ActivityBase.prototype.end = function()
{
if( !this.isActive() || this.isDisposed() )
return;

if( this.bFirstPerformCall )
{
this.bFirstPerformCall = false;
this.startAnimation();
}

this.performEnd();
this.endAnimation();
this.endActivity();
};

ActivityBase.prototype.performEnd = function()
{
throw ( 'ActivityBase.performEnd: abstract method invoked' );
};


function SimpleContinuousActivityBase( aCommonParamSet )
{
SimpleContinuousActivityBase.superclass.constructor.call( this, aCommonParamSet );

this.aTimer = new ElapsedTime( aCommonParamSet.aActivityQueue.getTimer() );
this.nMinSimpleDuration = aCommonParamSet.nMinDuration;
this.nMinNumberOfFrames = aCommonParamSet.nMinNumberOfFrames;
this.nCurrPerformCalls = 0;

}
extend( SimpleContinuousActivityBase, ActivityBase );


SimpleContinuousActivityBase.prototype.startAnimation = function()
{
this.aTimer.reset();
};

SimpleContinuousActivityBase.prototype.calcTimeLag = function()
{
SimpleContinuousActivityBase.superclass.calcTimeLag.call( this );

if( !this.isActive() )
return 0.0;

var nCurrElapsedTime = this.aTimer.getElapsedTime();


var nFractionElapsedTime = nCurrElapsedTime / this.nMinSimpleDuration;

var nFractionRequiredCalls = this.nCurrPerformCalls / this.nMinNumberOfFrames;


if( nFractionElapsedTime < nFractionRequiredCalls )
{
return 0.0;
}
else
{
return ( ( nFractionElapsedTime - nFractionRequiredCalls ) * this.nMinSimpleDuration );
}
};

SimpleContinuousActivityBase.prototype.perform = function()
{
if( !SimpleContinuousActivityBase.superclass.perform.call( this ) )
return false; // done, we're ended

var nCurrElapsedTime = this.aTimer.getElapsedTime();
var nT = nCurrElapsedTime / this.nMinSimpleDuration;


var bActivityEnding = false;

if( this.isRepeatCountValid() )
{

var nRepeatCount = this.getRepeatCount();
var nEffectiveRepeat = this.isAutoReverse() ? 2.0 * nRepeatCount : nRepeatCount;

if( nEffectiveRepeat <= nT )
{
bActivityEnding = true;

nT = nEffectiveRepeat;
}
}


var nRepeats;
var nRelativeSimpleTime;
if( this.isAutoReverse() )
{
nRepeats = Math.floor( nT );
var nFractionalActiveDuration =  nT - nRepeats;

if( nRepeats % 2 )
{
nRelativeSimpleTime = 1.0 - nFractionalActiveDuration;
}
else
{
nRelativeSimpleTime = nFractionalActiveDuration;
}

nRepeats /= 2;
}
else
{

nRepeats = Math.floor( nT );
nRelativeSimpleTime = nT - nRepeats;

if( this.isRepeatCountValid() && ( nRepeats >= this.getRepeatCount() ) )
{

nRelativeSimpleTime = 1.0;
nRepeats -= 1.0;
}
}


this.simplePerform( nRelativeSimpleTime, nRepeats );

if( bActivityEnding )
this.endActivity();

++this.nCurrPerformCalls;

return this.isActive();
};

SimpleContinuousActivityBase.prototype.simplePerform = function( nSimpleTime, nRepeatCount )
{
throw ( 'SimpleContinuousActivityBase.simplePerform: abstract method invoked' );
};


function ContinuousKeyTimeActivityBase( aCommonParamSet )
{
var nSize = aCommonParamSet.aDiscreteTimes.length;
assert( nSize > 1,
'ContinuousKeyTimeActivityBase constructor: assertion (aDiscreteTimes.length > 1) failed' );

assert( aCommonParamSet.aDiscreteTimes[0] == 0.0,
'ContinuousKeyTimeActivityBase constructor: assertion (aDiscreteTimes.front() == 0.0) failed' );

assert( aCommonParamSet.aDiscreteTimes[ nSize - 1 ] <= 1.0,
'ContinuousKeyTimeActivityBase constructor: assertion (aDiscreteTimes.back() <= 1.0) failed' );

ContinuousKeyTimeActivityBase.superclass.constructor.call( this, aCommonParamSet );

this.aLerper = new KeyStopLerp( aCommonParamSet.aDiscreteTimes );
}
extend( ContinuousKeyTimeActivityBase, SimpleContinuousActivityBase );


ContinuousKeyTimeActivityBase.prototype.activate = function( aEndElement )
{
ContinuousKeyTimeActivityBase.superclass.activate.call( this, aEndElement );

this.aLerper.reset();
};

ContinuousKeyTimeActivityBase.prototype.performHook = function( nIndex, nFractionalIndex, nRepeatCount )
{
throw ( 'ContinuousKeyTimeActivityBase.performHook: abstract method invoked' );
};

ContinuousKeyTimeActivityBase.prototype.simplePerform = function( nSimpleTime, nRepeatCount )
{
var nAlpha = this.calcAcceleratedTime( nSimpleTime );

var aLerpResult = this.aLerper.lerp( nAlpha );

this.performHook( aLerpResult.nIndex, aLerpResult.nLerp, nRepeatCount );
};


function ContinuousActivityBase( aCommonParamSet )
{
ContinuousActivityBase.superclass.constructor.call( this, aCommonParamSet );

}
extend( ContinuousActivityBase, SimpleContinuousActivityBase );


ContinuousActivityBase.prototype.performHook = function( nModifiedTime, nRepeatCount )
{
throw ( 'ContinuousActivityBase.performHook: abstract method invoked' );
};

ContinuousActivityBase.prototype.simplePerform = function( nSimpleTime, nRepeatCount )
{
this.performHook( this.calcAcceleratedTime( nSimpleTime ), nRepeatCount );
};


function SimpleActivity( aCommonParamSet, aNumberAnimation, eDirection )
{
assert( ( eDirection == BACKWARD ) || ( eDirection == FORWARD ),
'SimpleActivity constructor: animation direction is not valid' );

assert( aNumberAnimation, 'SimpleActivity constructor: animation object is not valid' );

SimpleActivity.superclass.constructor.call( this, aCommonParamSet );

this.aAnimation = aNumberAnimation;
this.nDirection = ( eDirection == FORWARD ) ? 1.0 : 0.0;
}
extend( SimpleActivity, ContinuousActivityBase );


SimpleActivity.prototype.startAnimation = function()
{
if( this.isDisposed() || !this.aAnimation )
return;

ANIMDBG.print( 'SimpleActivity.startAnimation invoked' );
SimpleActivity.superclass.startAnimation.call( this );

this.aAnimation.start( this.getTargetElement() );
};

SimpleActivity.prototype.endAnimation = function()
{
if( this.aAnimation )
this.aAnimation.end();

};

SimpleActivity.prototype.performHook = function( nModifiedTime, nRepeatCount )
{

if( this.isDisposed() || !this.aAnimation )
return;

var nT = 1.0 - this.nDirection + nModifiedTime * ( 2.0*this.nDirection - 1.0 );
this.aAnimation.perform( nT );
};

SimpleActivity.prototype.performEnd = function()
{
if( this.aAnimation )
this.aAnimation.perform( this.nDirection );
};


function FromToByActivityTemplate( BaseType ) // template parameter
{

function FromToByActivity( aFromValue, aToValue, aByValue,
aActivityParamSet, aAnimation,
aInterpolator, aOperatorSet, bAccumulate )
{
assert( aAnimation, 'FromToByActivity constructor: invalid animation object' );
assert( ( aToValue != undefined ) || ( aByValue != undefined ),
'FromToByActivity constructor: one of aToValue or aByValue must be valid' );

FromToByActivity.superclass.constructor.call( this, aActivityParamSet );

this.aFrom = aFromValue;
this.aTo = aToValue;
this.aBy = aByValue;
this.aStartValue = null;
this.aEndValue = null;
this.aPreviousValue = null;
this.aStartInterpolationValue = null;
this.aAnimation = aAnimation;
this.aInterpolator = aInterpolator;
this.equal = aOperatorSet.equal;
this.add = aOperatorSet.add;
this.scale = aOperatorSet.scale;
this.bDynamicStartValue = false;
this.nIteration = 0;
this.bCumulative = bAccumulate;
this.aFormula = aActivityParamSet.aFormula;


}
extend( FromToByActivity, BaseType );

FromToByActivity.prototype.initAnimatedElement = function()
{
if( this.aAnimation && this.aFrom )
{
var aValue = this.aFormula ? this.aFormula( this.aFrom ) : this.aFrom;
this.aAnimation.perform(aValue);
}
};

FromToByActivity.prototype.startAnimation = function()
{
if( this.isDisposed() || !this.aAnimation  )
{
log( 'FromToByActivity.startAnimation: activity disposed or not valid animation' );
return;
}

FromToByActivity.superclass.startAnimation.call( this );

this.aAnimation.start( this.getTargetElement() );


var aAnimationStartValue = this.aAnimation.getUnderlyingValue();

if( this.aFrom )
{
if( this.aTo )
{
this.aStartValue = this.aFrom;
this.aEndValue = this.aTo;
}
else if( this.aBy )
{
this.aStartValue = this.aFrom;

this.aEndValue = this.add( this.aStartValue, this.aBy );
}
}
else
{
this.aStartValue = aAnimationStartValue;
this.aStartInterpolationValue = this.aStartValue;

if( this.aTo )
{

this.bDynamicStartValue = true;
this.aPreviousValue = this.aStartValue;
this.aEndValue = this.aTo;
}
else if( this.aBy )
{
this.aStartValue = aAnimationStartValue;

this.aEndValue = this.add( this.aStartValue, this.aBy );
}
}

ANIMDBG.print( 'FromToByActivity.startAnimation: aStartValue = ' + this.aStartValue + ', aEndValue = ' + this.aEndValue );
};

FromToByActivity.prototype.endAnimation = function()
{
if( this.aAnimation )
this.aAnimation.end();
};

FromToByActivity.prototype.performHook = function( nModifiedTime, nRepeatCount )
{
if( this.isDisposed() || !this.aAnimation  )
{
log( 'FromToByActivity.performHook: activity disposed or not valid animation' );
return;
}


if( this.bDynamicStartValue )
{
if( this.nIteration != nRepeatCount )
{
this.nIteration = nRepeatCount;
this.aStartInterpolationValue =  this.aStartValue;
}
else
{
var aActualValue = this.aAnimation.getUnderlyingValue();
if( !this.equal( aActualValue, this.aPreviousValue ) )
this.aStartInterpolationValue = aActualValue;
}
}

var aValue = this.aInterpolator( this.aStartInterpolationValue,
this.aEndValue, nModifiedTime );

if( this.bCumulative && !this.bDynamicStartValue )
{
aValue = this.add( this.scale( nRepeatCount, this.aEndValue ), aValue );
}

aValue = this.aFormula ? this.aFormula( aValue ) : aValue;
this.aAnimation.perform( aValue );

if( this.bDynamicStartValue )
{
this.aPreviousValue = this.aAnimation.getUnderlyingValue();
}

};

FromToByActivity.prototype.performEnd = function()
{
if( this.aAnimation )
{
var aValue = this.isAutoReverse() ? this.aStartValue : this.aEndValue;
aValue = this.aFormula ? this.aFormula( aValue ) : aValue;
this.aAnimation.perform( aValue );
}
};

FromToByActivity.prototype.dispose = function()
{
FromToByActivity.superclass.dispose.call( this );
};


return FromToByActivity;
}


var LinearFromToByActivity = instantiate( FromToByActivityTemplate, ContinuousActivityBase );


function  ValueListActivityTemplate( BaseType ) // template parameter
{

function ValueListActivity( aValueList, aActivityParamSet,
aAnimation, aInterpolator,
aOperatorSet, bAccumulate )
{
assert( aAnimation, 'ValueListActivity constructor: invalid animation object' );
assert( aValueList.length != 0, 'ValueListActivity: value list is empty' );

ValueListActivity.superclass.constructor.call( this, aActivityParamSet );

this.aValueList = aValueList;
this.aAnimation = aAnimation;
this.aInterpolator = aInterpolator;
this.add = aOperatorSet.add;
this.scale = aOperatorSet.scale;
this.bCumulative = bAccumulate;
this.aLastValue = this.aValueList[ this.aValueList.length - 1 ];
this.aFormula = aActivityParamSet.aFormula;

}
extend( ValueListActivity, BaseType );

ValueListActivity.prototype.activate = function( aEndEvent )
{
ValueListActivity.superclass.activate.call( this, aEndEvent );
for( var i = 0; i < this.aValueList.length; ++i )
{
ANIMDBG.print( 'createValueListActivity: value[' + i + '] = ' + this.aValueList[i] );
}

};

ValueListActivity.prototype.initAnimatedElement = function()
{
if( this.aAnimation )
{
var aValue = this.aValueList[0];
aValue = this.aFormula ? this.aFormula( aValue ) : aValue;
this.aAnimation.perform(aValue);
}
};

ValueListActivity.prototype.startAnimation = function()
{
if( this.isDisposed() || !this.aAnimation  )
{
log( 'ValueListActivity.startAnimation: activity disposed or not valid animation' );
return;
}

ValueListActivity.superclass.startAnimation.call( this );

this.aAnimation.start( this.getTargetElement() );
};

ValueListActivity.prototype.endAnimation = function()
{
if( this.aAnimation )
this.aAnimation.end();
};

ValueListActivity.prototype.performHook = function( nIndex, nFractionalIndex, nRepeatCount )
{
if( this.isDisposed() || !this.aAnimation  )
{
log( 'ValueListActivity.performHook: activity disposed or not valid animation' );
return;
}

assert( ( nIndex + 1 ) < this.aValueList.length,
'ValueListActivity.performHook: assertion (nIndex + 1 < this.aValueList.length) failed' );


var aValue = this.aInterpolator( this.aValueList[ nIndex ],
this.aValueList[ nIndex+1 ],
nFractionalIndex );

if( this.bCumulative )
{
aValue = this.add( aValue, this.scale( nRepeatCount, this.aLastValue ) );
}

aValue = this.aFormula ? this.aFormula( aValue ) : aValue;
this.aAnimation.perform( aValue );
};

ValueListActivity.prototype.performEnd = function()
{
if( this.aAnimation )
{
var aValue = this.aFormula ? this.aFormula( this.aLastValue ) : this.aLastValue;
this.aAnimation.perform( aValue );
}
};

ValueListActivity.prototype.dispose = function()
{
ValueListActivity.superclass.dispose.call( this );
};


return ValueListActivity;
}


var LinearValueListActivity = instantiate( ValueListActivityTemplate, ContinuousKeyTimeActivityBase );


function createActivity( aActivityParamSet, aAnimationNode, aAnimation, aInterpolator )
{
var eCalcMode = aAnimationNode.getCalcMode();

var sAttributeName = aAnimationNode.getAttributeName();
var aAttributeProp = aAttributeMap[ sAttributeName ];

var eValueType = aAttributeProp[ 'type' ];
var eValueSubtype = aAttributeProp[ 'subtype' ];

if( ! aInterpolator )
{
aInterpolator = aInterpolatorHandler.getInterpolator( eCalcMode,
eValueType,
eValueSubtype );
}

var bAccumulate = ( aAnimationNode.getAccumulate() === ACCUMULATE_MODE_SUM )
&& !( eValueType === BOOL_PROPERTY ||
eValueType === STRING_PROPERTY ||
eValueType === ENUM_PROPERTY );

if( aAnimationNode.getFormula() )
{
var sFormula =  aAnimationNode.getFormula();
var reMath = /abs|sqrt|asin|acos|atan|sin|cos|tan|exp|log|min|max/g;
sFormula = sFormula.replace(reMath, 'Math.$&');
sFormula = sFormula.replace(/pi(?!\w)/g, 'Math.PI');
sFormula = sFormula.replace(/e(?!\w)/g, 'Math.E');
sFormula = sFormula.replace(/\$/g, '__PARAM0__');

var aAnimatedElement = aAnimationNode.getAnimatedElement();
var aBBox = aAnimatedElement.getBaseBBox();
var width = aBBox.width / aActivityParamSet.nSlideWidth;
var height = aBBox.height / aActivityParamSet.nSlideHeight;
var x = ( aBBox.x + aBBox.width / 2 ) / aActivityParamSet.nSlideWidth;
var y = ( aBBox.y + aBBox.height / 2 ) / aActivityParamSet.nSlideHeight;

aActivityParamSet.aFormula = function( __PARAM0__ ) {

return eval(sFormula);
};
}

aActivityParamSet.aDiscreteTimes = aAnimationNode.getKeyTimes();

var aValueSet = aAnimationNode.getValues();
var nValueSetSize = aValueSet.length;

if( nValueSetSize != 0 )
{

if( aActivityParamSet.aDiscreteTimes.length == 0 )
{
for( var i = 0; i < nValueSetSize; ++i )
aActivityParamSet.aDiscreteTimes[i].push( i / nValueSetSize );
}

switch( eCalcMode )
{
case CALC_MODE_DISCRETE:
log( 'createActivity: discrete calculation case not yet implemented' );
break;

default:
log( 'createActivity: unexpected calculation mode: ' + eCalcMode );
case CALC_MODE_PACED :
case CALC_MODE_SPLINE :
case CALC_MODE_LINEAR:
return createValueListActivity( aActivityParamSet,
aAnimationNode,
aAnimation,
aInterpolator,
LinearValueListActivity,
bAccumulate,
eValueType );
}
}
else
{
switch( eCalcMode )
{
case CALC_MODE_DISCRETE:
log( 'createActivity: discrete calculation case not yet implemented' );
break;

default:
log( 'createActivity: unexpected calculation mode: ' + eCalcMode );
case CALC_MODE_PACED :
case CALC_MODE_SPLINE :
case CALC_MODE_LINEAR:
return createFromToByActivity(  aActivityParamSet,
aAnimationNode,
aAnimation,
aInterpolator,
LinearFromToByActivity,
bAccumulate,
eValueType );
}
}
}


function createValueListActivity( aActivityParamSet, aAnimationNode, aAnimation,
aInterpolator, ClassTemplateInstance, bAccumulate, eValueType )
{
var aAnimatedElement = aAnimationNode.getAnimatedElement();
var aOperatorSet = aOperatorSetMap[ eValueType ];
assert( aOperatorSet, 'createFromToByActivity: no operator set found' );

var aValueSet = aAnimationNode.getValues();

var aValueList = [];

extractAttributeValues( eValueType,
aValueList,
aValueSet,
aAnimatedElement.getBaseBBox(),
aActivityParamSet.nSlideWidth,
aActivityParamSet.nSlideHeight );

for( var i = 0; i < aValueList.length; ++i )
{
ANIMDBG.print( 'createValueListActivity: value[' + i + '] = ' + aValueList[i] );
}

return new ClassTemplateInstance( aValueList, aActivityParamSet, aAnimation,
aInterpolator, aOperatorSet, bAccumulate );
}


function createFromToByActivity( aActivityParamSet, aAnimationNode, aAnimation,
aInterpolator, ClassTemplateInstance, bAccumulate, eValueType )
{

var aAnimatedElement = aAnimationNode.getAnimatedElement();
var aOperatorSet = aOperatorSetMap[ eValueType ];
assert( aOperatorSet, 'createFromToByActivity: no operator set found' );

var aValueSet = [];
aValueSet[0] = aAnimationNode.getFromValue();
aValueSet[1] = aAnimationNode.getToValue();
aValueSet[2] = aAnimationNode.getByValue();

ANIMDBG.print( 'createFromToByActivity: value type: ' + aValueTypeOutMap[eValueType] +
', aFrom = ' + aValueSet[0] +
', aTo = ' + aValueSet[1] +
', aBy = ' + aValueSet[2] );

var aValueList = [];

extractAttributeValues( eValueType,
aValueList,
aValueSet,
aAnimatedElement.getBaseBBox(),
aActivityParamSet.nSlideWidth,
aActivityParamSet.nSlideHeight );

ANIMDBG.print( 'createFromToByActivity: ' +
', aFrom = ' + aValueList[0] +
', aTo = ' + aValueList[1] +
', aBy = ' + aValueList[2] );

return new ClassTemplateInstance( aValueList[0], aValueList[1], aValueList[2],
aActivityParamSet, aAnimation,
aInterpolator, aOperatorSet, bAccumulate );
}


function extractAttributeValues( eValueType, aValueList, aValueSet, aBBox, nSlideWidth, nSlideHeight )
{
var i;
switch( eValueType )
{
case NUMBER_PROPERTY :
evalValuesAttribute( aValueList, aValueSet, aBBox, nSlideWidth, nSlideHeight );
break;
case BOOL_PROPERTY :
for( i = 0; i < aValueSet.length; ++i )
{
var aValue = booleanParser( aValueSet[i] );
aValueList.push( aValue );
}
break;
case STRING_PROPERTY :
for( i = 0; i < aValueSet.length; ++i )
{
aValueList.push( aValueSet[i] );
}
break;
case ENUM_PROPERTY :
for( i = 0; i < aValueSet.length; ++i )
{
aValueList.push( aValueSet[i] );
}
break;
case COLOR_PROPERTY :
for( i = 0; i < aValueSet.length; ++i )
{
aValue = colorParser( aValueSet[i] );
aValueList.push( aValue );
}
break;
default:
log( 'createValueListActivity: unexpected value type: ' + eValueType );
}

}


function evalValuesAttribute( aValueList, aValueSet, aBBox, nSlideWidth, nSlideHeight )
{
var width = aBBox.width / nSlideWidth;
var height = aBBox.height / nSlideHeight;
var x = ( aBBox.x + aBBox.width / 2 ) / nSlideWidth;
var y = ( aBBox.y + aBBox.height / 2 ) / nSlideHeight;

var reMath = /abs|sqrt|asin|acos|atan|sin|cos|tan|exp|log|min|max/g;

for( var i = 0; i < aValueSet.length; ++i )
{
var sValue = aValueSet[i];
sValue = sValue.replace(reMath, 'Math.$&');
sValue = sValue.replace(/pi(?!\w)/g, 'Math.PI');
sValue = sValue.replace(/e(?!\w)/g, 'Math.E');
var aValue =  eval( sValue );
aValueList.push( aValue );
}
}


var BACKWARD    = 0;
var FORWARD     = 1;

var MAXIMUM_FRAME_COUNT                 = 60;
var MINIMUM_TIMEOUT                     = 1.0 / MAXIMUM_FRAME_COUNT;
var MAXIMUM_TIMEOUT                     = 4.0;
var MINIMUM_FRAMES_PER_SECONDS          = 10;
var PREFERRED_FRAMES_PER_SECONDS        = 50;
var PREFERRED_FRAME_RATE                = 1.0 / PREFERRED_FRAMES_PER_SECONDS;


function Effect( nId )
{
this.nId = ( typeof( nId ) === typeof( 1 ) ) ? nId : -1;
this.eState = Effect.NOT_STARTED;
}
Effect.NOT_STARTED = 0;
Effect.PLAYING = 1;
Effect.ENDED = 2;

Effect.prototype.getId = function()
{
return this.nId;
};

Effect.prototype.isMainEffect = function()
{
return ( this.nId === -1 );
};

Effect.prototype.isPlaying = function()
{
return ( this.eState === Effect.PLAYING );
};

Effect.prototype.isEnded = function()
{
return ( this.eState === Effect.ENDED );
};

Effect.prototype.start = function()
{
assert( this.eState === Effect.NOT_STARTED, 'Effect.start: wrong state.' );
this.eState = Effect.PLAYING;
};

Effect.prototype.end = function()
{
assert( this.eState === Effect.PLAYING, 'Effect.end: wrong state.' );
this.eState = Effect.ENDED;
};


function SlideShow()
{
this.aTimer = new ElapsedTime();
this.aFrameSynchronization = new FrameSynchronization( PREFERRED_FRAME_RATE );
this.aTimerEventQueue = new TimerEventQueue( this.aTimer );
this.aActivityQueue = new ActivityQueue( this.aTimer );
this.aNextEffectEventArray = null;
this.aInteractiveAnimationSequenceMap = null;
this.aEventMultiplexer = null;

this.aContext = new SlideShowContext( this.aTimerEventQueue,
this.aEventMultiplexer,
this.aNextEffectEventArray,
this.aInteractiveAnimationSequenceMap,
this.aActivityQueue );
this.bIsIdle = true;
this.bIsEnabled = true;
this.bNoSlideTransition = false;
this.bIsTransitionRunning = false;

this.nCurrentEffect = 0;
this.bIsNextEffectRunning = false;
this.bIsRewinding = false;
this.bIsSkipping = false;
this.bIsSkippingAll = false;
this.nTotalInteractivePlayingEffects = 0;
this.aStartedEffectList = [];
this.aStartedEffectIndexMap = {};
this.aStartedEffectIndexMap[ -1 ] = undefined;
}

SlideShow.prototype.setSlideEvents = function( aNextEffectEventArray,
aInteractiveAnimationSequenceMap,
aEventMultiplexer )
{
if( !aNextEffectEventArray )
log( 'SlideShow.setSlideEvents: aNextEffectEventArray is not valid' );

if( !aInteractiveAnimationSequenceMap )
log( 'SlideShow.setSlideEvents:aInteractiveAnimationSequenceMap  is not valid' );

if( !aEventMultiplexer )
log( 'SlideShow.setSlideEvents: aEventMultiplexer is not valid' );

this.aContext.aNextEffectEventArray = aNextEffectEventArray;
this.aNextEffectEventArray = aNextEffectEventArray;
this.aContext.aInteractiveAnimationSequenceMap = aInteractiveAnimationSequenceMap;
this.aInteractiveAnimationSequenceMap = aInteractiveAnimationSequenceMap;
this.aContext.aEventMultiplexer = aEventMultiplexer;
this.aEventMultiplexer = aEventMultiplexer;
this.nCurrentEffect = 0;
};

SlideShow.prototype.createSlideTransition = function( aSlideTransitionHandler, aLeavingSlide, aEnteringSlide, aTransitionEndEvent )
{
if( !aEnteringSlide )
{
log( 'SlideShow.createSlideTransition: entering slide element is not valid.' );
return null;
}

if( this.bNoSlideTransition ) return null;

var aAnimatedLeavingSlide = null;
if( aLeavingSlide )
aAnimatedLeavingSlide = new AnimatedSlide( aLeavingSlide );
var aAnimatedEnteringSlide = new AnimatedSlide( aEnteringSlide );

var aSlideTransition = aSlideTransitionHandler.createSlideTransition( aAnimatedLeavingSlide, aAnimatedEnteringSlide );
if( !aSlideTransition ) return null;

var nDuration = 0.001;
if( aSlideTransitionHandler.getDuration().isValue() )
{
nDuration = aSlideTransitionHandler.getDuration().getValue();
}
else
{
log( 'SlideShow.createSlideTransition: duration is not a number' );
}

var aCommonParameterSet = new ActivityParamSet();
aCommonParameterSet.aEndEvent = aTransitionEndEvent;
aCommonParameterSet.aTimerEventQueue = this.aTimerEventQueue;
aCommonParameterSet.aActivityQueue = this.aActivityQueue;
aCommonParameterSet.nMinDuration = nDuration;
aCommonParameterSet.nMinNumberOfFrames = aSlideTransitionHandler.getMinFrameCount();
aCommonParameterSet.nSlideWidth = WIDTH;
aCommonParameterSet.nSlideHeight = HEIGHT;

return new SimpleActivity( aCommonParameterSet, aSlideTransition, FORWARD );

};

SlideShow.prototype.isEnabled = function()
{
return this.bIsEnabled;
};

SlideShow.prototype.isRunning = function()
{
return !this.bIsIdle;
};

SlideShow.prototype.isTransitionPlaying = function()
{
return this.bIsTransitionRunning;
};

SlideShow.prototype.isMainEffectPlaying = function()
{
return this.bIsNextEffectRunning;
};

SlideShow.prototype.isInteractiveEffectPlaying = function()
{
return ( this.nTotalInteractivePlayingEffects > 0 );
};

SlideShow.prototype.isAnyEffectPlaying = function()
{
return ( this.isMainEffectPlaying() || this.isInteractiveEffectPlaying() );
};

SlideShow.prototype.hasAnyEffectStarted = function()
{
return ( this.aStartedEffectList.length > 0 );
};

SlideShow.prototype.notifyNextEffectStart = function()
{
assert( !this.bIsNextEffectRunning,
'SlideShow.notifyNextEffectStart: an effect is already started.' );
this.bIsNextEffectRunning = true;
this.aEventMultiplexer.registerNextEffectEndHandler( bind2( SlideShow.prototype.notifyNextEffectEnd, this ) );
var aEffect = new Effect();
aEffect.start();
this.aStartedEffectIndexMap[ -1 ] = this.aStartedEffectList.length;
this.aStartedEffectList.push( aEffect );


var aAnimatedElementMap = theMetaDoc.aMetaSlideSet[nCurSlide].aSlideAnimationsHandler.aAnimatedElementMap;
for( var sId in aAnimatedElementMap )
aAnimatedElementMap[ sId ].notifyNextEffectStart( this.nCurrentEffect );
};

SlideShow.prototype.notifyNextEffectEnd = function()
{
assert( this.bIsNextEffectRunning,
'SlideShow.notifyNextEffectEnd: effect already ended.' );
this.bIsNextEffectRunning = false;

this.aStartedEffectList[ this.aStartedEffectIndexMap[ -1 ] ].end();
};

SlideShow.prototype.notifySlideStart = function( nNewSlideIndex, nOldSlideIndex )
{
this.nCurrentEffect = 0;
this.bIsRewinding = false;
this.bIsSkipping = false;
this.bIsSkippingAll = false;
this.nTotalInteractivePlayingEffects = 0;
this.aStartedEffectList = [];
this.aStartedEffectIndexMap = {};
this.aStartedEffectIndexMap[ -1 ] = undefined;

var aAnimatedElementMap;
var sId;
if( nOldSlideIndex !== undefined )
{
aAnimatedElementMap = theMetaDoc.aMetaSlideSet[nOldSlideIndex].aSlideAnimationsHandler.aAnimatedElementMap;
for( sId in aAnimatedElementMap )
aAnimatedElementMap[ sId ].notifySlideEnd();
}

aAnimatedElementMap = theMetaDoc.aMetaSlideSet[nNewSlideIndex].aSlideAnimationsHandler.aAnimatedElementMap;
for( sId in aAnimatedElementMap )
aAnimatedElementMap[ sId ].notifySlideStart( this.aContext );
};

SlideShow.prototype.notifyTransitionEnd = function( nSlideIndex )
{
if( theMetaDoc.getCurrentSlide() )
{
var sRef = 'url(#' + aPresentationClipPathId + ')';
theMetaDoc.getCurrentSlide().slideElement.setAttribute('clip-path', sRef);
}

this.bIsTransitionRunning = false;
if( this.bIsRewinding )
{
theMetaDoc.aMetaSlideSet[nSlideIndex].hide();
var nIndex = nCurSlide !== undefined ? nCurSlide : -1;
this.displaySlide( nIndex, true );
this.skipAllEffects();
this.bIsRewinding = false;
return;
}

theMetaDoc.setCurrentSlide(nSlideIndex);

if( this.aSlideViewElement )
{
theMetaDoc.getCurrentSlide().aVisibilityStatusElement.parentNode.removeChild( this.aSlideViewElement );
this.aSlideViewElement = null;
}
if( this.isEnabled() )
{
this.dispose();

theMetaDoc.getCurrentSlide().aSlideAnimationsHandler.start();
this.update();
}
};

SlideShow.prototype.notifyInteractiveAnimationSequenceStart = function( nNodeId )
{
++this.nTotalInteractivePlayingEffects;
var aEffect = new Effect( nNodeId );
aEffect.start();
this.aStartedEffectIndexMap[ nNodeId ] = this.aStartedEffectList.length;
this.aStartedEffectList.push( aEffect );
};

SlideShow.prototype.notifyInteractiveAnimationSequenceEnd = function( nNodeId )
{
assert( this.isInteractiveEffectPlaying(),
'SlideShow.notifyInteractiveAnimationSequenceEnd: no interactive effect playing.' );

this.aStartedEffectList[ this.aStartedEffectIndexMap[ nNodeId ] ].end();
--this.nTotalInteractivePlayingEffects;
};

SlideShow.prototype.nextEffect = function()
{
if( !this.isEnabled() )
return false;

if( this.isTransitionPlaying() )
{
this.skipTransition();
return true;
}

if( this.isAnyEffectPlaying() )
{
this.skipAllPlayingEffects();
return true;
}

if( !this.aNextEffectEventArray )
return false;

if( this.nCurrentEffect >= this.aNextEffectEventArray.size() )
return false;

this.notifyNextEffectStart();

this.aNextEffectEventArray.at( this.nCurrentEffect ).fire();
++this.nCurrentEffect;
this.update();
return true;
};

SlideShow.prototype.skipTransition  = function()
{
if( this.bIsSkipping || this.bIsRewinding )
return;

this.bIsSkipping = true;

this.aActivityQueue.endAll();
this.aTimerEventQueue.forceEmpty();
this.aActivityQueue.endAll();
this.update();
this.bIsSkipping = false;
};

SlideShow.prototype.skipAllPlayingEffects  = function()
{
if( this.bIsSkipping || this.bIsRewinding )
return true;

this.bIsSkipping = true;
for( var i = 0; i < this.aStartedEffectList.length; ++i )
{
var aEffect = this.aStartedEffectList[i];
if( aEffect.isPlaying() )
{
if( aEffect.isMainEffect() )
this.aEventMultiplexer.notifySkipEffectEvent();
else
this.aEventMultiplexer.notifySkipInteractiveEffectEvent( aEffect.getId() );
}
}
this.update();
this.bIsSkipping = false;
return true;
};

SlideShow.prototype.skipNextEffect = function()
{
if( this.bIsSkipping || this.bIsRewinding )
return true;

assert( !this.isAnyEffectPlaying(),
'SlideShow.skipNextEffect' );

if( !this.aNextEffectEventArray )
return false;

if( this.nCurrentEffect >= this.aNextEffectEventArray.size() )
return false;

this.notifyNextEffectStart();

this.bIsSkipping = true;
this.aNextEffectEventArray.at( this.nCurrentEffect ).fire();
this.aEventMultiplexer.notifySkipEffectEvent();
++this.nCurrentEffect;
this.update();
this.bIsSkipping = false;
return true;
};

SlideShow.prototype.skipPlayingOrNextEffect = function()
{
if( this.isTransitionPlaying() )
{
this.skipTransition();
return true;
}

if( this.isAnyEffectPlaying() )
return this.skipAllPlayingEffects();
else
return this.skipNextEffect();
};


SlideShow.prototype.skipAllEffects = function()
{
if( this.bIsSkippingAll )
return true;

this.bIsSkippingAll = true;

if( this.isTransitionPlaying() )
{
this.skipTransition();
}

if( this.isAnyEffectPlaying() )
{
this.skipAllPlayingEffects();
}
else if( !this.aNextEffectEventArray
|| ( this.nCurrentEffect >= this.aNextEffectEventArray.size() ) )
{
this.bIsSkippingAll = false;
return false;
}

while( this.nCurrentEffect < this.aNextEffectEventArray.size() )
{
this.skipNextEffect();
}
this.bIsSkippingAll = false;
return true;
};

SlideShow.prototype.rewindTransition = function()
{
if( this.bIsSkipping || this.bIsRewinding )
return;

this.bIsRewinding = true;
this.aActivityQueue.endAll();
this.update();
this.bIsRewinding = false;
};

SlideShow.prototype.rewindEffect = function()
{
if( this.bIsSkipping || this.bIsRewinding )
return;

if( !this.hasAnyEffectStarted() )
{
this.rewindToPreviousSlide();
return;
}

this.bIsRewinding = true;

var nFirstPlayingEffectIndex = undefined;

var i = 0;
for( ; i < this.aStartedEffectList.length; ++i )
{
var aEffect = this.aStartedEffectList[i];
if( aEffect.isPlaying() )
{
nFirstPlayingEffectIndex = i;
break;
}
}

if( nFirstPlayingEffectIndex !== undefined )
{
i = this.aStartedEffectList.length - 1;
for( ; i >= nFirstPlayingEffectIndex; --i )
{
aEffect = this.aStartedEffectList[i];
if( aEffect.isPlaying() )
{
if( aEffect.isMainEffect() )
{
this.aEventMultiplexer.notifyRewindCurrentEffectEvent();
if( this.nCurrentEffect > 0 )
--this.nCurrentEffect;
}
else
{
this.aEventMultiplexer.notifyRewindRunningInteractiveEffectEvent( aEffect.getId() );
}
}
else if( aEffect.isEnded() )
{
if( aEffect.isMainEffect() )
{
this.aEventMultiplexer.notifyRewindLastEffectEvent();
if( this.nCurrentEffect > 0 )
--this.nCurrentEffect;
}
else
{
this.aEventMultiplexer.notifyRewindEndedInteractiveEffectEvent( aEffect.getId() );
}
}
}
this.update();

i = this.aStartedEffectList.length - 1;
for( ; i >= nFirstPlayingEffectIndex; --i )
{
aEffect = this.aStartedEffectList.pop();
if( !aEffect.isMainEffect() )
delete this.aStartedEffectIndexMap[ aEffect.getId() ];
}
}
else  // there is no playing effect
{
aEffect = this.aStartedEffectList.pop();
if( !aEffect.isMainEffect() )
delete this.aStartedEffectIndexMap[ aEffect.getId() ];
if( aEffect.isEnded() )  // Well that is almost an assertion.
{
if( aEffect.isMainEffect() )
{
this.aEventMultiplexer.notifyRewindLastEffectEvent();
if( this.nCurrentEffect > 0 )
--this.nCurrentEffect;
}
else
{
this.aEventMultiplexer.notifyRewindEndedInteractiveEffectEvent( aEffect.getId() );
}
}
this.update();
}

this.bIsRewinding = false;
};

SlideShow.prototype.rewindToPreviousSlide = function()
{
if( this.isTransitionPlaying() )
{
this.rewindTransition();
return;
}
if( this.isAnyEffectPlaying() )
return;
var nNewSlide = nCurSlide - 1;
this.displaySlide( nNewSlide, true );
this.skipAllEffects();
};

SlideShow.prototype.rewindAllEffects = function()
{
if( !this.hasAnyEffectStarted() )
{
this.rewindToPreviousSlide();
return;
}

while( this.hasAnyEffectStarted() )
{
this.rewindEffect();
}
};

SlideShow.prototype.displaySlide = function( nNewSlide, bSkipSlideTransition )
{
var aMetaDoc = theMetaDoc;
var nSlides = aMetaDoc.nNumberOfSlides;
if( nNewSlide < 0 && nSlides > 0 )
nNewSlide = nSlides - 1;
else if( nNewSlide >= nSlides )
nNewSlide = 0;

if( ( currentMode === INDEX_MODE ) && ( nNewSlide === nCurSlide ) )
{
aMetaDoc.getCurrentSlide().show();
return;
}

if( this.isTransitionPlaying() )
{
this.skipTransition();
}

var nOldSlide = nCurSlide;
if( nOldSlide !== undefined )
{
var oldMetaSlide = aMetaDoc.aMetaSlideSet[nOldSlide];
if( this.isEnabled() )
{
if( oldMetaSlide.aSlideAnimationsHandler.isAnimated() )
{
oldMetaSlide.aSlideAnimationsHandler.end( bSkipSlideTransition );

this.dispose();
}
}
}

this.notifySlideStart( nNewSlide, nOldSlide );

if( this.isEnabled() && !bSkipSlideTransition  )
{
if ( ( ( nOldSlide !== undefined ) &&
( ( nNewSlide > nOldSlide ) ||
( ( nNewSlide == 0) && ( nOldSlide == (aMetaDoc.nNumberOfSlides - 1) ) ) ) ) ||
(  ( nOldSlide === undefined ) &&  ( nNewSlide == 0) )  // for transition on first slide
)
{

var aOldMetaSlide = null;
if( nOldSlide === undefined ) // for transition on first slide
{
aOldMetaSlide = aMetaDoc.theMetaDummySlide;
}
else
{
aOldMetaSlide = aMetaDoc.aMetaSlideSet[nOldSlide];
}
var aNewMetaSlide = aMetaDoc.aMetaSlideSet[nNewSlide];

var aSlideTransitionHandler = aNewMetaSlide.aTransitionHandler;
if( aSlideTransitionHandler && aSlideTransitionHandler.isValid() )
{
var sRef = 'url(#' + aPresentationClipPathShrinkId + ')';
aOldMetaSlide.slideElement.setAttribute( 'clip-path', sRef );

if( nOldSlide > nNewSlide )
{
this.aSlideViewElement = document.createElementNS( NSS['svg'], 'use' );
setNSAttribute( 'xlink', this.aSlideViewElement, 'href', '#' + aOldMetaSlide.slideContainerId );
aNewMetaSlide.aVisibilityStatusElement.parentNode.insertBefore( this.aSlideViewElement, aNewMetaSlide.aVisibilityStatusElement );
aOldMetaSlide.hide();
}

var aLeavingSlide = aOldMetaSlide;
var aEnteringSlide = aNewMetaSlide;
var aTransitionEndEvent = makeEvent( bind2( this.notifyTransitionEnd, this, nNewSlide ) );

var aTransitionActivity =
this.createSlideTransition( aSlideTransitionHandler, aLeavingSlide,
aEnteringSlide, aTransitionEndEvent );

if( aTransitionActivity )
{
this.bIsTransitionRunning = true;
this.aActivityQueue.addActivity( aTransitionActivity );
this.update();
}
else
{
this.notifyTransitionEnd( nNewSlide );
}
}
else
{
this.notifyTransitionEnd( nNewSlide );
}
}
else
{
this.notifyTransitionEnd( nNewSlide );
}
}
else
{
this.notifyTransitionEnd( nNewSlide );
}

};

SlideShow.prototype.update = function()
{
this.aTimer.holdTimer();

this.aTimerEventQueue.process();
this.aActivityQueue.process();

this.aFrameSynchronization.synchronize();

this.aActivityQueue.processDequeued();

this.aTimer.releaseTimer();

var bActivitiesLeft = ( ! this.aActivityQueue.isEmpty() );
var bTimerEventsLeft = ( ! this.aTimerEventQueue.isEmpty() );
var bEventsLeft = ( bActivitiesLeft || bTimerEventsLeft );


if( bEventsLeft )
{
var nNextTimeout;
if( bActivitiesLeft )
{
nNextTimeout = MINIMUM_TIMEOUT;
this.aFrameSynchronization.activate();
}
else
{
nNextTimeout = this.aTimerEventQueue.nextTimeout();
if( nNextTimeout < MINIMUM_TIMEOUT )
nNextTimeout = MINIMUM_TIMEOUT;
else if( nNextTimeout > MAXIMUM_TIMEOUT )
nNextTimeout = MAXIMUM_TIMEOUT;
this.aFrameSynchronization.deactivate();
}

this.bIsIdle = false;
window.setTimeout( 'aSlideShow.update()', nNextTimeout * 1000 );
}
else
{
this.bIsIdle = true;
}
};

SlideShow.prototype.dispose = function()
{
this.aTimerEventQueue.clear();
this.aActivityQueue.clear();
this.aNextEffectEventArray = null;
this.aEventMultiplexer = null;
};

SlideShow.prototype.getContext = function()
{
return this.aContext;
};

var aSlideShow = null;


function SlideShowContext( aTimerEventQueue, aEventMultiplexer, aNextEffectEventArray, aInteractiveAnimationSequenceMap, aActivityQueue)
{
this.aTimerEventQueue = aTimerEventQueue;
this.aEventMultiplexer = aEventMultiplexer;
this.aNextEffectEventArray = aNextEffectEventArray;
this.aInteractiveAnimationSequenceMap = aInteractiveAnimationSequenceMap;
this.aActivityQueue = aActivityQueue;
this.bIsSkipping = false;
}


function FrameSynchronization( nFrameDuration )
{
this.nFrameDuration = nFrameDuration;
this.aTimer = new ElapsedTime();
this.nNextFrameTargetTime = 0.0;
this.bIsActive = false;

this.markCurrentFrame();
}


FrameSynchronization.prototype.markCurrentFrame = function()
{
this.nNextFrameTargetTime = this.aTimer.getElapsedTime() + this.nFrameDuration;
};

FrameSynchronization.prototype.synchronize = function()
{
if( this.bIsActive )
{
while( this.aTimer.getElapsedTime() < this.nNextFrameTargetTime )
;
}

this.markCurrentFrame();

};

FrameSynchronization.prototype.activate = function()
{
this.bIsActive = true;
};

FrameSynchronization.prototype.deactivate = function()
{
this.bIsActive = false;
};


function NextEffectEventArray()
{
this.aEventArray = [];
}


NextEffectEventArray.prototype.size = function()
{
return this.aEventArray.length;
};

NextEffectEventArray.prototype.at = function( nIndex )
{
return this.aEventArray[ nIndex ];
};

NextEffectEventArray.prototype.appendEvent = function( aEvent )
{
var nSize = this.size();
for( var i = 0; i < nSize; ++i )
{
if( this.aEventArray[i].getId() == aEvent.getId() )
{
aNextEffectEventArrayDebugPrinter.print( 'NextEffectEventArray.appendEvent: event(' + aEvent.getId() + ') already present' );
return false;
}
}
this.aEventArray.push( aEvent );
aNextEffectEventArrayDebugPrinter.print( 'NextEffectEventArray.appendEvent: event(' + aEvent.getId() + ') appended' );
return true;
};

NextEffectEventArray.prototype.clear = function( )
{
this.aEventArray = [];
};


function TimerEventQueue( aTimer )
{
this.aTimer = aTimer;
this.aEventSet = new PriorityQueue( EventEntry.compare );
}


TimerEventQueue.prototype.addEvent = function( aEvent )
{
this.DBG( 'TimerEventQueue.addEvent event(' + aEvent.getId() + ') appended.' );
if( !aEvent )
{
log( 'TimerEventQueue.addEvent: null event' );
return false;
}

var nTime = aEvent.getActivationTime( this.aTimer.getElapsedTime() );
var aEventEntry = new EventEntry( aEvent, nTime );
this.aEventSet.push( aEventEntry );

return true;
};

TimerEventQueue.prototype.forceEmpty = function()
{
this.process_(true);
};


TimerEventQueue.prototype.process = function()
{
this.process_(false);
};

TimerEventQueue.prototype.process_ = function( bFireAllEvents )
{
var nCurrentTime = this.aTimer.getElapsedTime();

while( !this.isEmpty() && ( bFireAllEvents || ( this.aEventSet.top().nActivationTime <= nCurrentTime ) ) )
{
var aEventEntry = this.aEventSet.top();
this.aEventSet.pop();

var aEvent = aEventEntry.aEvent;
if( aEvent.isCharged() )
aEvent.fire();
}
};

TimerEventQueue.prototype.isEmpty = function()
{
return this.aEventSet.isEmpty();
};

TimerEventQueue.prototype.nextTimeout = function()
{
var nTimeout = Number.MAX_VALUE;
var nCurrentTime = this.aTimer.getElapsedTime();
if( !this.isEmpty() )
nTimeout = this.aEventSet.top().nActivationTime - nCurrentTime;
return nTimeout;
};

TimerEventQueue.prototype.clear = function()
{
this.DBG( 'TimerEventQueue.clear invoked' );
this.aEventSet.clear();
};

TimerEventQueue.prototype.getTimer = function()
{
return this.aTimer;
};

TimerEventQueue.prototype.DBG = function( sMessage, nTime )
{
aTimerEventQueueDebugPrinter.print( sMessage, nTime );
};


TimerEventQueue.prototype.insert = function( aEventEntry )
{
var nHoleIndex = this.aEventSet.length;
var nParent = Math.floor( ( nHoleIndex - 1 ) / 2 );

while( ( nHoleIndex > 0 ) && this.aEventSet[ nParent ].compare( aEventEntry ) )
{
this.aEventSet[ nHoleIndex ] = this.aEventSet[ nParent ];
nHoleIndex = nParent;
nParent = Math.floor( ( nHoleIndex - 1 ) / 2 );
}
this.aEventSet[ nHoleIndex ] = aEventEntry;
};


function EventEntry( aEvent, nTime )
{
this.aEvent = aEvent;
this.nActivationTime = nTime;
}


EventEntry.compare = function( aLhsEventEntry, aRhsEventEntry )
{
if ( aLhsEventEntry.nActivationTime > aRhsEventEntry.nActivationTime )
{
return -1;
}
else if ( aLhsEventEntry.nActivationTime < aRhsEventEntry.nActivationTime )
{
return 1;
}
else
{
return 0;
}
};


function ActivityQueue( aTimer )
{
this.aTimer = aTimer;
this.aCurrentActivityWaitingSet = [];
this.aCurrentActivityReinsertSet = [];
this.aDequeuedActivitySet = [];
}


ActivityQueue.prototype.dispose = function()
{
var nSize = this.aCurrentActivityWaitingSet.length;
var i;
for( i = 0; i < nSize; ++i )
this.aCurrentActivityWaitingSet[i].dispose();

nSize = this.aCurrentActivityReinsertSet.length;
for( i = 0; i < nSize; ++i )
this.aCurrentActivityReinsertSet[i].dispose();
};

ActivityQueue.prototype.addActivity = function( aActivity )
{
if( !aActivity )
{
log( 'ActivityQueue.addActivity: activity is not valid' );
return false;
}

this.aCurrentActivityWaitingSet.push( aActivity );
aActivityQueueDebugPrinter.print( 'ActivityQueue.addActivity: activity appended' );
return true;
};

ActivityQueue.prototype.process = function()
{
var nSize = this.aCurrentActivityWaitingSet.length;
var nLag = 0.0;
for( var i = 0; i < nSize; ++i )
{
nLag = Math.max( nLag,this.aCurrentActivityWaitingSet[i].calcTimeLag()  );
}

if( nLag > 0.0 )
this.aTimer.adjustTimer( -nLag, true );


while( this.aCurrentActivityWaitingSet.length != 0 )
{
var aActivity = this.aCurrentActivityWaitingSet.shift();
var bReinsert = false;

bReinsert = aActivity.perform();

if( bReinsert )
{
this.aCurrentActivityReinsertSet.push( aActivity );
}
else
{
this.aDequeuedActivitySet.push( aActivity );
}
}

if( this.aCurrentActivityReinsertSet.length != 0 )
{
this.aCurrentActivityWaitingSet = this.aCurrentActivityReinsertSet;
this.aCurrentActivityReinsertSet = [];
}
};

ActivityQueue.prototype.processDequeued = function()
{
var nSize = this.aDequeuedActivitySet.length;
for( var i = 0; i < nSize; ++i )
this.aDequeuedActivitySet[i].dequeued();

this.aDequeuedActivitySet = [];
};

ActivityQueue.prototype.isEmpty = function()
{
return ( ( this.aCurrentActivityWaitingSet.length == 0 ) &&
( this.aCurrentActivityReinsertSet.length == 0 ) );
};

ActivityQueue.prototype.clear = function()
{
aActivityQueueDebugPrinter.print( 'ActivityQueue.clear invoked' );
var nSize = this.aCurrentActivityWaitingSet.length;
var i;
for( i = 0; i < nSize; ++i )
this.aCurrentActivityWaitingSet[i].dequeued();
this.aCurrentActivityWaitingSet = [];

nSize = this.aCurrentActivityReinsertSet.length;
for( i = 0; i < nSize; ++i )
this.aCurrentActivityReinsertSet[i].dequeued();
this.aCurrentActivityReinsertSet = [];
};

ActivityQueue.prototype.endAll = function()
{
aActivityQueueDebugPrinter.print( 'ActivityQueue.endAll invoked' );
var nSize = this.aCurrentActivityWaitingSet.length;
var i;
for( i = 0; i < nSize; ++i )
this.aCurrentActivityWaitingSet[i].end();
this.aCurrentActivityWaitingSet = [];

nSize = this.aCurrentActivityReinsertSet.length;
for( i = 0; i < nSize; ++i )
this.aCurrentActivityReinsertSet[i].end();
this.aCurrentActivityReinsertSet = [];
};

ActivityQueue.prototype.getTimer = function()
{
return this.aTimer;
};

ActivityQueue.prototype.size = function()
{
return ( this.aCurrentActivityWaitingSet.length +
this.aCurrentActivityReinsertSet.length +
this.aDequeuedActivitySet.length );
};


function ElapsedTime( aTimeBase )
{
this.aTimeBase = aTimeBase;
this.nLastQueriedTime = 0.0;
this.nStartTime = this.getSystemTime();
this.nFrozenTime = 0.0;
this.bInPauseMode = false;
this.bInHoldMode = false;
}


ElapsedTime.prototype.getTimeBase = function()
{
return this.aTimeBase;
};

ElapsedTime.prototype.reset = function()
{
this.nLastQueriedTime = 0.0;
this.nStartTime = this.getSystemTime();
this.nFrozenTime = 0.0;
this.bInPauseMode = false;
this.bInHoldMode = false;
};

ElapsedTime.prototype.getElapsedTime = function()
{
this.nLastQueriedTime = this.getElapsedTimeImpl();
return this.nLastQueriedTime;
};

ElapsedTime.prototype.pauseTimer = function()
{
this.nFrozenTime = this.getElapsedTimeImpl();
this.bInPauseMode = true;
};

ElapsedTime.prototype.continueTimer = function()
{
this.bInPauseMode = false;

var nPauseDuration = this.getElapsedTimeImpl() - this.nFrozenTime;

this.nStartTime += nPauseDuration;
};

ElapsedTime.prototype.adjustTimer = function( nOffset, bLimitToLastQueriedTime )
{
if( bLimitToLastQueriedTime == undefined )
bLimitToLastQueriedTime = true;

this.nStartTime -= nOffset;

if( this.bInHoldMode || this.bInPauseMode )
this.nFrozenTime += nOffset;
};

ElapsedTime.prototype.holdTimer = function()
{
this.nFrozenTime = this.getElapsedTimeImpl();
this.bInHoldMode = true;
};

ElapsedTime.prototype.releaseTimer = function()
{
this.bInHoldMode = false;
};

ElapsedTime.prototype.getSystemTime = function()
{
return ( getCurrentSystemTime() / 1000.0 );
};

ElapsedTime.prototype.getCurrentTime = function()
{
var nCurrentTime;
if ( !this.aTimeBase )
{
nCurrentTime = this.getSystemTime();
}
else
{
nCurrentTime = this.aTimeBase.getElapsedTimeImpl();
}

assert( ( typeof( nCurrentTime ) === typeof( 0 ) ) && isFinite( nCurrentTime ),
'ElapsedTime.getCurrentTime: assertion failed: nCurrentTime == ' + nCurrentTime );


return nCurrentTime;
};

ElapsedTime.prototype.getElapsedTimeImpl = function()
{
if( this.bInHoldMode || this.bInPauseMode )
{

return this.nFrozenTime;
}

var nCurTime = this.getCurrentTime();
return ( nCurTime - this.nStartTime );
};


/*****
* @libreofficeend
*
* Several parts of the above code are the result of the porting,
* started on August 2011, of the C++ code included in the source files
* placed under the folder '/slideshow/source' and subfolders.
* @source http://cgit.freedesktop.org/libreoffice/core/tree/slideshow/source
*
*/

]]>
 </script>
</svg>